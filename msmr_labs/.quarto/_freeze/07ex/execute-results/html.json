{
  "hash": "65ced1cec8996c656b770fc5f35fd4e4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Week 7 Exercises: PCA & EFA\"\nparams: \n    SHOW_SOLS: TRUE\n    TOGGLE: TRUE\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n\n\n\n\n:::frame\n__New packages__  \n\nWe're going to be needing some different packages this week (no more lme4!).    \nMake sure you have these packages installed:  \n\n+ psych  \n+ GPArotation  \n+ car  \n\n:::\n\n# Reducing the dimensionality of job performance  \n\n:::frame\n__Data: jobperfbonus.csv__  \n\nA company has asked line managers to fill out a questionnaire that asks them to capture 'performance indicators' for each of their employees. These 15 indicators are a mix of metrics from the companies work management software, and questions about manager's perceptions of their employees' work over the last year.  \n\nThe company’s leadership team finds the 15-indicator report a bit confusing and overwhelming. They want to create a simplified \"Performance Dashboard\" that captures only the most important directions of variance in their employees.  \n\nIt can be downloaded at [https://uoepsy.github.io/data/jobperfbonus.csv](https://uoepsy.github.io/data/jobperfbonus.csv){target=\"_blank\"}\n\n\n\n::: {#tbl-jpdict .cell layout-align=\"center\" tbl-cap='data dictionary for jobperfbonus.csv'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"quzzrftyem\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#quzzrftyem table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#quzzrftyem thead, #quzzrftyem tbody, #quzzrftyem tfoot, #quzzrftyem tr, #quzzrftyem td, #quzzrftyem th {\n  border-style: none;\n}\n\n#quzzrftyem p {\n  margin: 0;\n  padding: 0;\n}\n\n#quzzrftyem .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#quzzrftyem .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#quzzrftyem .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#quzzrftyem .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#quzzrftyem .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#quzzrftyem .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#quzzrftyem .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#quzzrftyem .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#quzzrftyem .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#quzzrftyem .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#quzzrftyem .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#quzzrftyem .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#quzzrftyem .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#quzzrftyem .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#quzzrftyem .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#quzzrftyem .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#quzzrftyem .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#quzzrftyem .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#quzzrftyem .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#quzzrftyem .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#quzzrftyem .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#quzzrftyem .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#quzzrftyem .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#quzzrftyem .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#quzzrftyem .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#quzzrftyem .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#quzzrftyem .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#quzzrftyem .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#quzzrftyem .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#quzzrftyem .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#quzzrftyem .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#quzzrftyem .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#quzzrftyem .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#quzzrftyem .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#quzzrftyem .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#quzzrftyem .gt_left {\n  text-align: left;\n}\n\n#quzzrftyem .gt_center {\n  text-align: center;\n}\n\n#quzzrftyem .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#quzzrftyem .gt_font_normal {\n  font-weight: normal;\n}\n\n#quzzrftyem .gt_font_bold {\n  font-weight: bold;\n}\n\n#quzzrftyem .gt_font_italic {\n  font-style: italic;\n}\n\n#quzzrftyem .gt_super {\n  font-size: 65%;\n}\n\n#quzzrftyem .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#quzzrftyem .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#quzzrftyem .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#quzzrftyem .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#quzzrftyem .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#quzzrftyem .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#quzzrftyem .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#quzzrftyem .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#quzzrftyem div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"question\">question</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">name</td>\n<td headers=\"question\" class=\"gt_row gt_left\">employee name</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q1</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Deadline Consistency: Average discrepancy between 'Target Date' vs. 'Actual Completion Date' for assigned tasks.</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q2</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Scheduling: Frequency of updated timelines or revised milestones sent to the team.</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q3</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Resource Allocation: How well have they allocated resources to ensure efficient project execution?</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q4</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Risk Identification: Rate their proficiency in identifying and mitigating project risks.</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q5</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Project Updating: Frequency of weekly status emails/announcements on the project. </td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q6</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Collaboration: Number of projects where they were a 'Collaborator' or 'Contributor' alongside others.</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q7</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Teamwork: Rate how well they have actively listened to and considered the ideas and opinions of others.</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q8</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Positivity: How effectively have they contributed to a positive team environment?</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q9</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Assistance: Frequency of being tagged for help on others' assigned tasks.</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q10</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Conflict: How well have they resolved conflicts and disagreements within the team?</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q11</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Technical Proficiency: The number of tasks sent back for 'Correction' versus those approved on the first pass.</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q12</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Technical Development: Number of completed internal or external training certifications. </td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q13</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Problem Resolution: The average time between a 'Help Ticket' or 'Bug' being assigned and closed.</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q14</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Technical Communication: How well have they translated complex technical information into understandable terms for non-technical stakeholders?</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">q15</td>\n<td headers=\"question\" class=\"gt_row gt_left\">Technical Initiative: How well have they leveraged technical expertise for problem-solving?</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n:::\n\n\n\n\n<div class='question-begin'>Question 1</div><div class='question-body'>\n\n\nLoad the data!  \n\nWe're going to want to reduce these 15 variables (or \"items\") down into a smaller set. Should we use PCA or EFA?  \n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-1' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-1', 'sol-start-1')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-1\" style=\"display: none;\">\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\njobperf <- read_csv(\"https://uoepsy.github.io/data/jobperfbonus.csv\")\nhead(jobperf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 16\n  name      q1    q2    q3    q4    q5    q6    q7    q8    q9   q10   q11   q12\n  <chr>  <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n1 Kang,…   -32   0.6     2     1   0.3    14     2     3  0.06     2  0.6      7\n2 Zouni…     4   1.6     3     4   1      20     3     4  0.1      4  0.52     9\n3 el-Sy…     0   1.3     3     4   0.7    19     3     4  0.07     3  0.54     3\n4 Thomp…   -18   1.2     1     3   0.4    16     2     4  0.09     2  0.81     7\n5 Wahl,…     2   1.7     2     3   0.7    14     3     4  0.06     3  0.58     9\n6 al-Ko…   -24   0.8     1     1   0      27     3     4  0.08     3  0.59     5\n# ℹ 3 more variables: q13 <dbl>, q14 <dbl>, q15 <dbl>\n```\n\n\n:::\n:::\n\n\n\nWe're probably going to want to use PCA, because it is hard to understand what an underlying latent dimension of 'performance' would be --- i.e., it makes more sense to think of any overall measure of 'performance' as just being the combination of all of those indicators.  \n\nOne way to reason about this is to task which of these makes more sense:  \n\n- A. If my 'job performance' increases, then my scores on the indicators will go up  \n- B. If my scores on the indicators go up, then my 'job performance' will increase  \n\nReally, we are just asking about the direction of the arrows. Which picture makes more sense?  \n\n![](images/perfpcaefa.png)\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 2</div><div class='question-body'>\n\n\nExplore the relationships between variables in the data.  \n\nYou're probably going to want to subset out _just_ the relevant variables (`q1` to `q15`).  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nThere are lots of variables! There are various things we can do here. Try some of them to see what they do:  \n\n- `cor(data)`\n- `heatmap(cor(data))`\n- `pairs.panels(data)` (from the **psych** package)\n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-2' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-2', 'sol-start-2')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-2\" style=\"display: none;\">\n\n\n\nLet's keep the full data with the names, but make a new object that is just the performance data:  \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nqperf <- jobperf |> select(-name)\n```\n:::\n\n\n\nIt looks like we've got some very strong groups of questions there - q1 to q5 are all highly related to one another, as are q6 to q10, and q11 to q15. Furthermore, the relations between those sets are very weak, suggesting 3 groups that are fairly distinct.  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nheatmap(cor(qperf))\n```\n\n::: {.cell-output-display}\n![](07ex_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\nYou'll probably have to zoom in when you do this yourself, as there are a lot of little plots there!  \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(psych)\npairs.panels(qperf)\n```\n\n::: {.cell-output-display}\n![](07ex_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 3</div><div class='question-body'>\n\n\nHow much variance in the set of performance indicators will be captured by 15 principal components? \n\n*Note: We can figure this out without having to do anything - it's a theoretical question!*\n\n\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-3' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-3', 'sol-start-3')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-3\" style=\"display: none;\">\n\n\n\nAll of it!  \nThe right hand entry of the \"Cumulative Var\" row is 1 - it explains everything. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprincipal(qperf, nfactors = 15, rotate = \"none\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPrincipal Components Analysis\nCall: principal(r = qperf, nfactors = 15, rotate = \"none\")\nStandardized loadings (pattern matrix) based upon correlation matrix\n      PC1  PC2   PC3   PC4   PC5   PC6   PC7   PC8   PC9  PC10  PC11  PC12\nq1   0.90 0.29 -0.15 -0.08 -0.04 -0.02 -0.03 -0.07 -0.06 -0.02  0.00 -0.01\nq2   0.87 0.22 -0.17 -0.03 -0.05 -0.06  0.04 -0.13  0.01  0.06  0.29 -0.06\nq3   0.75 0.20 -0.17  0.28  0.15  0.28  0.01  0.35  0.23 -0.07 -0.02  0.00\nq4   0.85 0.29 -0.16 -0.03  0.02 -0.13 -0.05 -0.07 -0.08  0.02 -0.24  0.13\nq5   0.89 0.28 -0.15 -0.03 -0.06 -0.04  0.02 -0.05 -0.06  0.00 -0.02 -0.06\nq6  -0.33 0.85 -0.08  0.02 -0.02  0.01  0.02  0.09 -0.10  0.06  0.06  0.35\nq7  -0.32 0.83 -0.11  0.03 -0.05  0.08  0.04  0.05  0.02  0.39 -0.06 -0.17\nq8  -0.31 0.82 -0.05  0.13 -0.07  0.03 -0.01  0.13 -0.32 -0.23  0.08 -0.14\nq9  -0.24 0.73 -0.01 -0.26  0.54  0.03 -0.07 -0.15  0.11 -0.09  0.01 -0.04\nq10 -0.29 0.77 -0.11  0.03 -0.35 -0.14  0.04 -0.14  0.35 -0.16 -0.05 -0.01\nq11  0.17 0.17  0.89 -0.04 -0.04  0.01 -0.03  0.01 -0.09 -0.05 -0.22 -0.10\nq12  0.11 0.10  0.76  0.22  0.18 -0.52  0.11  0.14  0.05  0.04  0.06  0.00\nq13  0.15 0.10  0.80  0.05  0.01  0.29  0.44 -0.19 -0.01 -0.02  0.02  0.05\nq14  0.22 0.11  0.75 -0.50 -0.16  0.05 -0.09  0.26  0.07  0.01  0.08  0.02\nq15  0.07 0.13  0.80  0.28 -0.03  0.16 -0.42 -0.20  0.03  0.05  0.08  0.04\n     PC13  PC14  PC15 h2       u2 com\nq1  -0.01 -0.11 -0.24  1  1.3e-15 1.5\nq2  -0.15  0.16  0.04  1  2.3e-15 1.7\nq3  -0.02  0.02  0.00  1  6.7e-16 2.8\nq4   0.15  0.19  0.04  1  2.8e-15 1.9\nq5   0.03 -0.25  0.16  1  2.6e-15 1.6\nq6  -0.13 -0.05  0.01  1  2.2e-16 1.8\nq7   0.04  0.01 -0.02  1  5.6e-16 2.0\nq8   0.10  0.05  0.00  1  1.1e-16 2.1\nq9   0.00 -0.01  0.01  1  1.1e-16 2.6\nq10  0.01  0.01  0.00  1  6.7e-16 2.6\nq11 -0.29  0.03  0.01  1 -2.0e-15 1.6\nq12  0.05 -0.03 -0.02  1 -1.3e-15 2.4\nq13  0.09  0.01 -0.01  1 -8.9e-16 2.2\nq14  0.11  0.01  0.01  1 -1.8e-15 2.6\nq15  0.07 -0.02  0.00  1 -1.6e-15 2.2\n\n                       PC1  PC2  PC3  PC4  PC5  PC6  PC7  PC8  PC9 PC10 PC11\nSS loadings           4.20 3.61 3.38 0.55 0.52 0.51 0.41 0.38 0.33 0.26 0.22\nProportion Var        0.28 0.24 0.23 0.04 0.03 0.03 0.03 0.03 0.02 0.02 0.01\nCumulative Var        0.28 0.52 0.75 0.78 0.82 0.85 0.88 0.90 0.93 0.94 0.96\nProportion Explained  0.28 0.24 0.23 0.04 0.03 0.03 0.03 0.03 0.02 0.02 0.01\nCumulative Proportion 0.28 0.52 0.75 0.78 0.82 0.85 0.88 0.90 0.93 0.94 0.96\n                      PC12 PC13 PC14 PC15\nSS loadings           0.21 0.19 0.14 0.09\nProportion Var        0.01 0.01 0.01 0.01\nCumulative Var        0.97 0.98 0.99 1.00\nProportion Explained  0.01 0.01 0.01 0.01\nCumulative Proportion 0.97 0.98 0.99 1.00\n\nMean item complexity =  2.1\nTest of the hypothesis that 15 components are sufficient.\n\nThe root mean square of the residuals (RMSR) is  0 \n with the empirical chi square  0  with prob <  NA \n\nFit based upon off diagonal values = 1\n```\n\n\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n\n<div class='question-begin'>Question 4</div><div class='question-body'>\n\n\nRemember, the company is wanting us to simplify things down from having 15 indicators of 'job performance' to a smaller set, that captures the most important ways in which employees vary in their performance.  \n\nWe're going to use PCA.  \nHow many components should we keep?\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nSee scree plots, parallel analysis, MAP - [Chapter 2 - PCA walkthrough](https://uoepsy.github.io/lv/02_pca.html){target=\"_blank\"}.  \n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-4' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-4', 'sol-start-4')\">  Kaiser</button></div><div class=\"solution-body\" id = \"sol-body-4\" style=\"display: none;\">\n\n\n\nAccording to Kaiser's rule, we should keep 3 components\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprincipal(qperf, nfactors = 15, rotate = \"none\")$values\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 4.20133825 3.61121794 3.37806982 0.55089392 0.51766122 0.50970760\n [7] 0.40518560 0.38424599 0.33003793 0.25868856 0.22449635 0.20892955\n[13] 0.18571607 0.14318987 0.09062133\n```\n\n\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-5' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-5', 'sol-start-5')\">  Scree</button></div><div class=\"solution-body\" id = \"sol-body-5\" style=\"display: none;\">\n\n\n\nAccording to the Scree plot, I would suggest keeping 3 components\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nscree(qperf, factors = FALSE)\n```\n\n::: {.cell-output-display}\n![](07ex_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-6' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-6', 'sol-start-6')\">  MAP</button></div><div class=\"solution-body\" id = \"sol-body-6\" style=\"display: none;\">\n\n\n\nAccording to the MAP, we should keep 3 components\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nVSS(qperf, n = ncol(qperf), \n    rotate = \"none\", fm = \"pc\", plot = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nVery Simple Structure\nCall: vss(x = x, n = n, rotate = rotate, diagonal = diagonal, fm = fm, \n    n.obs = n.obs, plot = plot, title = title, use = use, cor = cor)\nVSS complexity 1 achieves a maximimum of 0.96  with  3  factors\nVSS complexity 2 achieves a maximimum of 0.98  with  6  factors\n\nThe Velicer MAP achieves a minimum of 0.02  with  3  factors \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nBIC achieves a minimum of  Inf  with    factors\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSample Size adjusted BIC achieves a minimum of  Inf  with    factors\n\nStatistics by number of factors \n   vss1 vss2   map dof chisq prob sqresid  fit RMSEA BIC SABIC complex eChisq\n1  0.41 0.00 0.143   0    NA   NA 2.6e+01 0.41    NA  NA    NA      NA     NA\n2  0.70 0.70 0.071   0    NA   NA 1.3e+01 0.70    NA  NA    NA      NA     NA\n3  0.96 0.97 0.021   0    NA   NA 1.5e+00 0.97    NA  NA    NA      NA     NA\n4  0.96 0.97 0.031   0    NA   NA 1.2e+00 0.97    NA  NA    NA      NA     NA\n5  0.84 0.97 0.047   0    NA   NA 9.0e-01 0.98    NA  NA    NA      NA     NA\n6  0.84 0.98 0.069   0    NA   NA 6.4e-01 0.99    NA  NA    NA      NA     NA\n7  0.76 0.96 0.106   0    NA   NA 4.8e-01 0.99    NA  NA    NA      NA     NA\n8  0.75 0.91 0.125   0    NA   NA 3.3e-01 0.99    NA  NA    NA      NA     NA\n9  0.67 0.92 0.174   0    NA   NA 2.2e-01 0.99    NA  NA    NA      NA     NA\n10 0.67 0.91 0.211   0    NA   NA 1.6e-01 1.00    NA  NA    NA      NA     NA\n11 0.67 0.90 0.264   0    NA   NA 1.1e-01 1.00    NA  NA    NA      NA     NA\n12 0.61 0.90 0.406   0    NA   NA 6.3e-02 1.00    NA  NA    NA      NA     NA\n13 0.59 0.87 0.580   0    NA   NA 2.9e-02 1.00    NA  NA    NA      NA     NA\n14 0.59 0.87 1.000   0    NA   NA 8.2e-03 1.00    NA  NA    NA      NA     NA\n15 0.59 0.87    NA   0    NA   NA 1.5e-27 1.00    NA  NA    NA      NA     NA\n   SRMR eCRMS eBIC\n1    NA    NA   NA\n2    NA    NA   NA\n3    NA    NA   NA\n4    NA    NA   NA\n5    NA    NA   NA\n6    NA    NA   NA\n7    NA    NA   NA\n8    NA    NA   NA\n9    NA    NA   NA\n10   NA    NA   NA\n11   NA    NA   NA\n12   NA    NA   NA\n13   NA    NA   NA\n14   NA    NA   NA\n15   NA    NA   NA\n```\n\n\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-7' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-7', 'sol-start-7')\">  Parallel Analysis</button></div><div class=\"solution-body\" id = \"sol-body-7\" style=\"display: none;\">\n\n\n\nAccording to the parallel analysis, we should keep 3 components \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfa.parallel(qperf, fa=\"pc\", n.iter = 500)\n```\n\n::: {.cell-output-display}\n![](07ex_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=80%}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParallel analysis suggests that the number of factors =  NA  and the number of components =  3 \n```\n\n\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-8' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-8', 'sol-start-8')\">  Making a decision</button></div><div class=\"solution-body\" id = \"sol-body-8\" style=\"display: none;\">\n\n\n\nIn this case, everything agrees that we should retain 3 components:  \n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"klubeumnkr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#klubeumnkr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#klubeumnkr thead, #klubeumnkr tbody, #klubeumnkr tfoot, #klubeumnkr tr, #klubeumnkr td, #klubeumnkr th {\n  border-style: none;\n}\n\n#klubeumnkr p {\n  margin: 0;\n  padding: 0;\n}\n\n#klubeumnkr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#klubeumnkr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#klubeumnkr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#klubeumnkr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#klubeumnkr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#klubeumnkr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#klubeumnkr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#klubeumnkr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#klubeumnkr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#klubeumnkr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#klubeumnkr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#klubeumnkr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#klubeumnkr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#klubeumnkr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#klubeumnkr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#klubeumnkr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#klubeumnkr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#klubeumnkr .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#klubeumnkr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#klubeumnkr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#klubeumnkr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#klubeumnkr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#klubeumnkr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#klubeumnkr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#klubeumnkr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#klubeumnkr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#klubeumnkr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#klubeumnkr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#klubeumnkr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#klubeumnkr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#klubeumnkr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#klubeumnkr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#klubeumnkr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#klubeumnkr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#klubeumnkr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#klubeumnkr .gt_left {\n  text-align: left;\n}\n\n#klubeumnkr .gt_center {\n  text-align: center;\n}\n\n#klubeumnkr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#klubeumnkr .gt_font_normal {\n  font-weight: normal;\n}\n\n#klubeumnkr .gt_font_bold {\n  font-weight: bold;\n}\n\n#klubeumnkr .gt_font_italic {\n  font-style: italic;\n}\n\n#klubeumnkr .gt_super {\n  font-size: 65%;\n}\n\n#klubeumnkr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#klubeumnkr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#klubeumnkr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#klubeumnkr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#klubeumnkr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#klubeumnkr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#klubeumnkr .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#klubeumnkr .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#klubeumnkr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"guides\">guides</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"suggestion\">suggestion</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"guides\" class=\"gt_row gt_left\">Kaiser</td>\n<td headers=\"suggestion\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"guides\" class=\"gt_row gt_left\">Scree</td>\n<td headers=\"suggestion\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"guides\" class=\"gt_row gt_left\">MAP</td>\n<td headers=\"suggestion\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><td headers=\"guides\" class=\"gt_row gt_left\">Parallel Analysis</td>\n<td headers=\"suggestion\" class=\"gt_row gt_right\">3</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n<div class='question-begin'>Question 5</div><div class='question-body'>\n\n\nConduct a principal components analysis extracting the number of components you decided on from the previous question.  \n\nBe sure to set `rotate = \"none\"` (a conventional PCA does not use rotations - it is simply about data reduction. The line is a bit blurred here, but once we start introducing rotations, we are moving more towards a form of EFA).  \n\nExamine the loadings for the components. By thinking in relation to the questions that were asked (refer back to @tbl-jpdict), what do you think each component is capturing?  \n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-9' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-9', 'sol-start-9')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-9\" style=\"display: none;\">\n\n\n\nIt's rarely as neat as this, but we can see the patterns of higher loadings for the groups of 5 questions on each component. \n\n- PC1 has higher loadings for q1 to q5 \n- PC2 has higher loadings for q6 to q10 \n- PC3 has higher loadings for q11 to q15 \n\nLooking back at the questions in @tbl-jpdict, questions 1 to 5 were all about stuff related to 'project management'. Questions 6 to 10 were all about collaboration with team members, and questions 11 to 15 were all about technical skill. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprincipal(qperf, nfactors = 3, rotate = \"none\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPrincipal Components Analysis\nCall: principal(r = qperf, nfactors = 3, rotate = \"none\")\nStandardized loadings (pattern matrix) based upon correlation matrix\n      PC1  PC2   PC3   h2    u2 com\nq1   0.90 0.29 -0.15 0.91 0.089 1.3\nq2   0.87 0.22 -0.17 0.83 0.169 1.2\nq3   0.75 0.20 -0.17 0.64 0.361 1.3\nq4   0.85 0.29 -0.16 0.83 0.167 1.3\nq5   0.89 0.28 -0.15 0.89 0.106 1.3\nq6  -0.33 0.85 -0.08 0.83 0.167 1.3\nq7  -0.32 0.83 -0.11 0.80 0.200 1.3\nq8  -0.31 0.82 -0.05 0.77 0.233 1.3\nq9  -0.24 0.73 -0.01 0.59 0.411 1.2\nq10 -0.29 0.77 -0.11 0.69 0.315 1.3\nq11  0.17 0.17  0.89 0.84 0.155 1.1\nq12  0.11 0.10  0.76 0.60 0.398 1.1\nq13  0.15 0.10  0.80 0.67 0.327 1.1\nq14  0.22 0.11  0.75 0.62 0.378 1.2\nq15  0.07 0.13  0.80 0.67 0.334 1.1\n\n                       PC1  PC2  PC3\nSS loadings           4.20 3.61 3.38\nProportion Var        0.28 0.24 0.23\nCumulative Var        0.28 0.52 0.75\nProportion Explained  0.38 0.32 0.30\nCumulative Proportion 0.38 0.70 1.00\n\nMean item complexity =  1.2\nTest of the hypothesis that 3 components are sufficient.\n\nThe root mean square of the residuals (RMSR) is  0.04 \n with the empirical chi square  134.75  with prob <  3.9e-07 \n\nFit based upon off diagonal values = 0.99\n```\n\n\n:::\n:::\n\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n<div class='question-begin'>Question 6</div><div class='question-body'>\n\n\nExtract the scores on the principal components.  \nThe company wants to reward teamwork. Pick 10 people they should give a bonus to.  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nSee [Chapter 2#PCA-walkthrough - scores](https://uoepsy.github.io/lv/02_pca.html#scores){target=\"_blank\"} for how to extract scores (a score on each component for each row of our original dataset) using the `$scores` from the object fitted with `principal()`.  \n\nThis will contain as many sets of scores as there are components. One of these (given the previous question) might be of use here.  \n\nYou'll likely want to join them back to the column of names. So we can figure out who gets the bonus. `cbind()` or `bind_cols()` might help here.  \n\n:::\n\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-10' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-10', 'sol-start-10')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-10\" style=\"display: none;\">\n\n\n\nThe second component seems to capture a lot of 'teamwork' related questions. So if we extract scores on that second component, we could then pick the 10 people for whom they are highest on that component.  \n\nThis will extract the scores:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprincipal(qperf, nfactors = 3, rotate = \"none\")$scores\n```\n:::\n\n\n\nLet's combine them with the original data that contains the employee names, so we can figure out who to give bonuses to.  \nWe could do this with `cbind()`, or `bind_cols()`, \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# first we bind the columns of the scores, back to \n# the original data which contains the names\njobperf <- \n  bind_cols(\n    principal(qperf, nfactors = 3, rotate = \"none\")$scores,\n    jobperf\n  ) \n\n# we can then choose just the 10 people \n# who have the highest scores on PC2 (the teamwork component)\njobperf |> select(name, PC2) |>\n  arrange(desc(PC2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 400 × 2\n   name                 PC2\n   <chr>              <dbl>\n 1 Robinson, Shayla    2.88\n 2 Hunt, Maliek        2.63\n 3 Kearns, Sarah       2.40\n 4 Billings, Justin    2.39\n 5 Phillips, Nashelle  2.33\n 6 al-Masih, Sawada    2.26\n 7 Vargas, Joseph      2.16\n 8 Reider, Samuel      2.12\n 9 Dhanoa, Eunice      2.10\n10 Brown, Jameela      1.98\n# ℹ 390 more rows\n```\n\n\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n<br>\n\n# Understanding Conduct Problems  \n\n\n:::frame\n__Data: Conduct Problems__  \n\nA researcher is developing a new brief measure of Conduct Problems. She has collected data from n=450 adolescents on 10 items, which cover the following behaviours:  \n\n1. Breaking curfew\n1. Vandalism\n1. Skipping school\n1. Bullying\n1. Spreading malicious rumours\n1. Fighting\n1. Lying\n1. Using a weapon \n1. Stealing\n1. Threatening others\n\n\nOur task is to use the dimension reduction techniques we learned about in the lecture to help inform how to organise the items she has developed into subscales.  \n\nThe data can be found at [https://uoepsy.github.io/data/conduct_probs_scale.csv](https://uoepsy.github.io/data/conduct_probs_scale.csv){target=\"_blank\"} \n\n:::\n\n\n\n<div class='question-begin'>Question 7</div><div class='question-body'>\n\n\nRead in the dataset.  \nCreate a correlation matrix for *the items*, and inspect the items to check their suitability for exploratory factor analysis (see [Chapter 3#EFA-initial checks](https://uoepsy.github.io/lv/03_efa.html#initial-checks){target=\"_blank\"}).  \n\n\n</div><p class=\"question-end\"></p>\n\n \n\n\n<div class=\"solution-begin\"><button id='sol-start-11' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-11', 'sol-start-11')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-11\" style=\"display: none;\">\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncpdata <- read.csv(\"https://uoepsy.github.io/data/conduct_probs_scale.csv\")\n# discard the first column\ncpdata <- cpdata[,-1]\n```\n:::\n\n\n\nHere's a correlation matrix. There's no obvious blocks of items here, but we can see that there are some fairly high correlations, as well as some weaker ones. All are positive.  \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nheatmap(cor(cpdata))\n```\n\n::: {.cell-output-display}\n![](07ex_files/figure-html/unnamed-chunk-16-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\nThe Bartlett's test comes out with a p-value of 0 (which isn't possible, but it's been rounded for some reason). This suggests that we reject the null of this test (that our correlation matrix is proportional to the identity matrix). This is good. It basically means \"we have some non-zero correlations\"!  \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncortest.bartlett(cor(cpdata), n=450)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$chisq\n[1] 2237.533\n\n$p.value\n[1] 0\n\n$df\n[1] 45\n```\n\n\n:::\n:::\n\n\n\nThe overall sampling adequacy is 0.87, which is pretty good! (or rather, which is 'meritorious'!).  MSA for all items is >.8\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nKMO(cpdata)  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nKaiser-Meyer-Olkin factor adequacy\nCall: KMO(r = cpdata)\nOverall MSA =  0.87\nMSA for each item = \n   breaking_curfew          vandalism    skipping_school           bullying \n              0.84               0.88               0.92               0.82 \n spreading_rumours           fighting              lying       using_weapon \n              0.81               0.94               0.88               0.95 \n          stealing threatening_others \n              0.90               0.94 \n```\n\n\n:::\n:::\n\n\n\nFinally, all the relationships here look fairly linear:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npairs.panels(cpdata)\n```\n\n::: {.cell-output-display}\n![](07ex_files/figure-html/unnamed-chunk-19-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n<div class='question-begin'>Question 8</div><div class='question-body'>\n\n\nHow many dimensions should be retained?  \n\nThis question can be answered in the same way as we did above for PCA - use a scree plot, parallel analysis, and MAP test to guide you.   \n\nYou can use `fa.parallel(data, fa = \"both\")` to conduct both parallel analysis and view the scree plot!   \n\n\n</div><p class=\"question-end\"></p>\n\n \n\n\n\n<div class=\"solution-begin\"><button id='sol-start-12' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-12', 'sol-start-12')\">  Scree</button></div><div class=\"solution-body\" id = \"sol-body-12\" style=\"display: none;\">\n\n\n\nThe scree plot shows a kink at 3, which suggests retaining 2 components. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nscree(cpdata)\n```\n\n::: {.cell-output-display}\n![](07ex_files/figure-html/unnamed-chunk-20-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-13' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-13', 'sol-start-13')\">  MAP</button></div><div class=\"solution-body\" id = \"sol-body-13\" style=\"display: none;\">\n\n\n\nThe MAP suggests retaining 2 factors. I'm just extracting the actuall `map` values here to save having to show all the other output. We can see that the 2nd entry is the smallest: \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nVSS(cpdata, plot = FALSE, n = ncol(cpdata))$map\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 0.10575332 0.03377130 0.05762202 0.10352974 0.14935664 0.25195168\n [7] 0.39743503 0.45518643 1.00000000         NA\n```\n\n\n:::\n:::\n\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-14' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-14', 'sol-start-14')\">  Parallel Analysis</button></div><div class=\"solution-body\" id = \"sol-body-14\" style=\"display: none;\">\n\n\n\nParallel analysis suggests 2 factors as well:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfa.parallel(cpdata, fa = \"both\")\n```\n\n::: {.cell-output-display}\n![](07ex_files/figure-html/unnamed-chunk-22-1.png){fig-align='center' width=80%}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nParallel analysis suggests that the number of factors =  2  and the number of components =  2 \n```\n\n\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-15' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-15', 'sol-start-15')\">  Making a decision</button></div><div class=\"solution-body\" id = \"sol-body-15\" style=\"display: none;\">\n\n\n\nAgain, a quite clear picture that 2 factors is preferred:  \n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"pbbydhoeal\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#pbbydhoeal table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#pbbydhoeal thead, #pbbydhoeal tbody, #pbbydhoeal tfoot, #pbbydhoeal tr, #pbbydhoeal td, #pbbydhoeal th {\n  border-style: none;\n}\n\n#pbbydhoeal p {\n  margin: 0;\n  padding: 0;\n}\n\n#pbbydhoeal .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#pbbydhoeal .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#pbbydhoeal .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#pbbydhoeal .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#pbbydhoeal .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pbbydhoeal .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pbbydhoeal .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pbbydhoeal .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#pbbydhoeal .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#pbbydhoeal .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#pbbydhoeal .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#pbbydhoeal .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#pbbydhoeal .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#pbbydhoeal .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#pbbydhoeal .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#pbbydhoeal .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#pbbydhoeal .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#pbbydhoeal .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#pbbydhoeal .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbbydhoeal .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#pbbydhoeal .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#pbbydhoeal .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#pbbydhoeal .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbbydhoeal .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#pbbydhoeal .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#pbbydhoeal .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pbbydhoeal .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbbydhoeal .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#pbbydhoeal .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pbbydhoeal .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#pbbydhoeal .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pbbydhoeal .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pbbydhoeal .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbbydhoeal .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pbbydhoeal .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pbbydhoeal .gt_left {\n  text-align: left;\n}\n\n#pbbydhoeal .gt_center {\n  text-align: center;\n}\n\n#pbbydhoeal .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#pbbydhoeal .gt_font_normal {\n  font-weight: normal;\n}\n\n#pbbydhoeal .gt_font_bold {\n  font-weight: bold;\n}\n\n#pbbydhoeal .gt_font_italic {\n  font-style: italic;\n}\n\n#pbbydhoeal .gt_super {\n  font-size: 65%;\n}\n\n#pbbydhoeal .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#pbbydhoeal .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#pbbydhoeal .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#pbbydhoeal .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#pbbydhoeal .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#pbbydhoeal .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#pbbydhoeal .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#pbbydhoeal .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#pbbydhoeal div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"guides\">guides</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"suggestion\">suggestion</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"guides\" class=\"gt_row gt_left\">Scree</td>\n<td headers=\"suggestion\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"guides\" class=\"gt_row gt_left\">MAP</td>\n<td headers=\"suggestion\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"guides\" class=\"gt_row gt_left\">Parallel Analysis</td>\n<td headers=\"suggestion\" class=\"gt_row gt_right\">2</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 9</div><div class='question-body'>\n\n\nUse the function `fa()` from the **psych** package to conduct and EFA to extract 2 factors (this is what *we* suggest based on the various tests above, but *you* might feel differently - the ideal number of factors is subjective!). Use a suitable rotation (`rotate = ?`) and extraction method (`fm = ?`).  \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmyfa <- fa(data, nfactors = ?, rotate = ?, fm = ?)\n```\n:::\n\n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nWould you expect factors to be correlated? If so, you'll want an oblique rotation.  \n\nIf there are two+ underlying factors of 'conduct problems', if someone is higher on one of them, would we expect them to therefore be high/low on the other? If so, then we the two factors are correlated!   \n:::\n\n\n\n\n</div><p class=\"question-end\"></p>\n\n \n\n\n<div class=\"solution-begin\"><button id='sol-start-16' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-16', 'sol-start-16')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-16\" style=\"display: none;\">\n\n\nFor example, you could choose an oblimin rotation to allow factors to correlate and use ml as the extraction method.  \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nconduct_efa <- fa(cpdata, nfactors=2, rotate='oblimin', fm=\"ml\")\n```\n:::\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 10</div><div class='question-body'>\n\n\nInspect your solution. Make sure to look at and think about the loadings, the variance accounted for, and the factor correlations (if estimated).  \n\nWhat we're doing here is essentially evaluating whether our solution looks theoretically coherent. A big part of this is a subjective decision about the groupings of items, but we would also like the numerical parts of our model to meet certain criteria (see [Chapter 3: EFA#what-makes-a-good-factor-solution](https://uoepsy.github.io/lv/03_efa.html#what-makes-a-good-factor-solution){target=\"_blank\"}).  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nJust printing an `fa` object:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmyfa <- fa(data, ..... )\nmyfa\n```\n:::\n\n\nWill give you lots and lots of information.  \nYou can extract individual parts using:  \n\n- `myfa$loadings` for the loadings\n- `myfa$Vaccounted` for the variance accounted for by each factor\n- `myfa$Phi` for the factor correlation matrix\n\nYou can find a quick guide to reading the `fa` output here: [efa_output.pdf](https://uoepsy.github.io/msmr/2425/misc/efa_output.pdf){target=\"_blank\"}.  \n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-17' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-17', 'sol-start-17')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-17\" style=\"display: none;\">\n\n\n\nThings look pretty good here. Each item has a clear primary loading on to one of the factors, and the complexity for all items is 1 (meaning they're clearly link to just one of the factors). The `h2` column is showing that the 2 factor solution is explaining 38%+ of the variance in each item.  Both factors are well determined, having at least 3 salient loadings.  \n\nThe 2 factors together explain 57% of the variance in the data - both factors explain a similar amount (29% for factor 1, 28% for factor 2). \n\nWe can also see that there is a moderate correlation between the two factors. Use of an oblique rotation was appropriate - if the correlation had been very weak, then it might not have differed much from if we used an orthogonal rotation.  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nconduct_efa\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n\n```\nFactor Analysis using method =  ml\nCall: fa(r = cpdata, nfactors = 2, rotate = \"oblimin\", fm = \"ml\")\nStandardized loadings (pattern matrix) based upon correlation matrix\n                     ML1   ML2   h2   u2 com\nbreaking_curfew    -0.05  0.88 0.74 0.26   1\nvandalism           0.05  0.69 0.51 0.49   1\nskipping_school    -0.01  0.67 0.44 0.56   1\nbullying            0.90  0.00 0.81 0.19   1\nspreading_rumours   0.93 -0.02 0.85 0.15   1\nfighting            0.65 -0.02 0.42 0.58   1\nlying               0.02  0.77 0.60 0.40   1\nusing_weapon        0.63  0.09 0.45 0.55   1\nstealing            0.04  0.70 0.51 0.49   1\nthreatening_others  0.62 -0.01 0.38 0.62   1\n\n                       ML1  ML2\nSS loadings           2.91 2.80\nProportion Var        0.29 0.28\nCumulative Var        0.29 0.57\nProportion Explained  0.51 0.49\nCumulative Proportion 0.51 1.00\n\n With factor correlations of \n     ML1  ML2\nML1 1.00 0.43\nML2 0.43 1.00\n\nMean item complexity =  1\n```\n\n\n:::\n:::\n\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n\n<div class='question-begin'>Question 11</div><div class='question-body'>\n\n\nLook back to the description of the items, and suggest a name for your factors based on the patterns of loadings.  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nTo sort the loadings, you can use\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprint(myfa$loadings, sort = TRUE)\n```\n:::\n\n\n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n \n\n\n<div class=\"solution-begin\"><button id='sol-start-18' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-18', 'sol-start-18')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-18\" style=\"display: none;\">\n\n\nYou can inspect the loadings using:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprint(conduct_efa$loadings, sort=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nLoadings:\n                   ML1    ML2   \nbullying            0.899       \nspreading_rumours   0.931       \nfighting            0.653       \nusing_weapon        0.629       \nthreatening_others  0.621       \nbreaking_curfew            0.878\nvandalism                  0.694\nskipping_school            0.671\nlying                      0.767\nstealing                   0.696\n\n                 ML1   ML2\nSS loadings    2.890 2.782\nProportion Var 0.289 0.278\nCumulative Var 0.289 0.567\n```\n\n\n:::\n:::\n\n\nWe can see that, ordered like this, we have five items that have high loadings for one factor and another five items that have high loadings for the other.  \n  \nThe five items for factor 1 all have in common that they are non-aggressive forms of conduct problems. The five items for factor 2 are all more aggressive behaviours. We could, therefore, label our factors: ‘non-aggressive’ and ‘aggressive’ conduct problems.\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 12</div><div class='question-body'>\n\n\nCompare your three different solutions: \n\n1) your current solution from the previous questions\n2) one where you fit 1 more factor\n3) one where you fit 1 fewer factors   \n\nWhich one looks best?  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nWe're looking here to assess:  \n\n- how much variance is accounted for by each solution\n- do all factors load on 3+ items at a salient level?  \n- do all items have at least one loading at a salient level?\n- are there any \"Heywood cases\" (communalities or standardised loadings that are >1)?\n- should we perhaps remove some of the more complex items?\n- is the factor structure (items that load on to each factor) coherent, and does it make theoretical sense?\n\n:::\n\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-19' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-19', 'sol-start-19')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-19\" style=\"display: none;\">\n\n\n\nThe 1-factor model explains 37% of the variance (as opposed to the 57% explained by the 2 factor solution), and all items load fairly high on the factor. The downside here is that we're not discerning between different types of conduct problems that we did in the 2 factor solution.  \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nconduct_1 <- fa(cpdata, nfactors=1, fm=\"ml\")\nconduct_1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFactor Analysis using method =  ml\nCall: fa(r = cpdata, nfactors = 1, fm = \"ml\")\nStandardized loadings (pattern matrix) based upon correlation matrix\n                    ML1   h2   u2 com\nbreaking_curfew    0.42 0.18 0.82   1\nvandalism          0.42 0.18 0.82   1\nskipping_school    0.35 0.13 0.87   1\nbullying           0.89 0.79 0.21   1\nspreading_rumours  0.90 0.81 0.19   1\nfighting           0.64 0.41 0.59   1\nlying              0.43 0.18 0.82   1\nusing_weapon       0.68 0.46 0.54   1\nstealing           0.42 0.17 0.83   1\nthreatening_others 0.61 0.38 0.62   1\n\n                ML1\nSS loadings    3.69\nProportion Var 0.37\n\nMean item complexity =  1\nTest of the hypothesis that 1 factor is sufficient.\n\ndf null model =  45  with the objective function =  5.03 with Chi Square =  2237.53\ndf of  the model are 35  and the objective function was  1.78 \n\nThe root mean square of the residuals (RMSR) is  0.19 \nThe df corrected root mean square of the residuals is  0.22 \n\nThe harmonic n.obs is  450 with the empirical chi square  1464.73  with prob <  1.9e-285 \nThe total n.obs was  450  with Likelihood Chi Square =  789.3  with prob <  3.4e-143 \n\nTucker Lewis Index of factoring reliability =  0.557\nRMSEA index =  0.219  and the 90 % confidence intervals are  0.206 0.232\nBIC =  575.48\nFit based upon off diagonal values = 0.8\nMeasures of factor score adequacy             \n                                                   ML1\nCorrelation of (regression) scores with factors   0.96\nMultiple R square of scores with factors          0.92\nMinimum correlation of possible factor scores     0.84\n```\n\n\n:::\n:::\n\n\n\nThe 3-factor model explains 60% of the variance (only 3% more than the 2-factor model). Notably, the third factor is not very clearly defined - it only has 1 salient loading (possibly 2 if we consider the 0.31 to be salient, but that item is primarily loaded on the 2nd factor). \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nconduct_3 <- fa(cpdata, nfactors=3, rotate='oblimin', fm=\"ml\")\nconduct_3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFactor Analysis using method =  ml\nCall: fa(r = cpdata, nfactors = 3, rotate = \"oblimin\", fm = \"ml\")\nStandardized loadings (pattern matrix) based upon correlation matrix\n                     ML1   ML2   ML3   h2   u2 com\nbreaking_curfew    -0.02  0.61  0.31 0.71 0.29 1.5\nvandalism           0.06  0.12  0.74 0.72 0.28 1.1\nskipping_school     0.00  0.56  0.14 0.44 0.56 1.1\nbullying            0.90  0.09 -0.10 0.82 0.18 1.0\nspreading_rumours   0.92 -0.02  0.03 0.85 0.15 1.0\nfighting            0.65 -0.13  0.14 0.43 0.57 1.2\nlying               0.02  0.85 -0.06 0.67 0.33 1.0\nusing_weapon        0.63  0.08  0.02 0.45 0.55 1.0\nstealing            0.06  0.69  0.02 0.53 0.47 1.0\nthreatening_others  0.62 -0.08  0.09 0.39 0.61 1.1\n\n                       ML1  ML2  ML3\nSS loadings           2.93 2.14 0.94\nProportion Var        0.29 0.21 0.09\nCumulative Var        0.29 0.51 0.60\nProportion Explained  0.49 0.36 0.16\nCumulative Proportion 0.49 0.84 1.00\n\n With factor correlations of \n     ML1  ML2  ML3\nML1 1.00 0.39 0.32\nML2 0.39 1.00 0.68\nML3 0.32 0.68 1.00\n\nMean item complexity =  1.1\nTest of the hypothesis that 3 factors are sufficient.\n\ndf null model =  45  with the objective function =  5.03 with Chi Square =  2237.53\ndf of  the model are 18  and the objective function was  0.02 \n\nThe root mean square of the residuals (RMSR) is  0.01 \nThe df corrected root mean square of the residuals is  0.02 \n\nThe harmonic n.obs is  450 with the empirical chi square  3.98  with prob <  1 \nThe total n.obs was  450  with Likelihood Chi Square =  10.51  with prob <  0.91 \n\nTucker Lewis Index of factoring reliability =  1.009\nRMSEA index =  0  and the 90 % confidence intervals are  0 0.016\nBIC =  -99.46\nFit based upon off diagonal values = 1\nMeasures of factor score adequacy             \n                                                   ML1  ML2  ML3\nCorrelation of (regression) scores with factors   0.96 0.93 0.88\nMultiple R square of scores with factors          0.93 0.86 0.77\nMinimum correlation of possible factor scores     0.85 0.72 0.53\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n<div class='question-begin'>Question 13</div><div class='question-body'>\n\n\nDrawing on your previous answers and conducting any additional analyses you believe would be necessary to identify an optimal factor structure for the 10 conduct problems, write some bullet points to summarise your methods and the results of your chosen optimal model.  \n\nRemember, the main principles governing the reporting of statistical methods are transparency and reproducibility (i.e., someone should be able to reproduce your analysis based on your description).\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-20' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-20', 'sol-start-20')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-20\" style=\"display: none;\">\n\n\n\nAn example summary would be:\n\n:::int \n\nFirst, the data were checked for their suitability for factor analysis. Normality was checked using visual inspection of histograms, linearity was checked through the inspection of the linear and lowess lines for the pairwise relations of the variables, and factorability was confirmed using a KMO test, which yielded an overall KMO of $.87$ with no variable KMOs $<.50$. \nAn exploratory factor analysis was conducted to inform the structure of a new conduct problems test. Inspection of a scree plot alongside parallel analysis (using principal components analysis; PA-PCA) and the MAP test were used to guide the number of factors to retain. All three methods suggested retaining two factors; however, a one-factor and three-factor solution were inspected to confirm that the two-factor solution was optimal from a substantive and practical perspective, e.g., that it neither blurred important factor distinctions nor included a minor factor that would be better combined with the other in a one-factor solution. These factor analyses were conducted using maximum likelihood estimation and (for the two- and three-factor solutions) an oblimin rotation, because it was expected that the factors would correlate. Inspection of the factor loadings and correlations reinforced that the two-factor solution was optimal: both factors were well-determined, including 5 loadings $>|0.3|$ and the one-factor model blurred the distinction between different forms of conduct problems. \nThe factor loadings are provided in @tbl-loadingtab^[You should provide the table of factor loadings. It is conventional to omit factor loadings $<|0.3|$; however, be sure to ensure that you mention this in a table note.]. Based on the pattern of factor loadings, the two factors were labelled 'aggressive conduct problems' and 'non-aggressive conduct problems'. These factors had a  correlation of $r=.43$. Overall, they accounted for 57% of the variance in the items, suggesting that a two-factor solution effectively summarised the over half of the variation in the items.\n\n\n\n\n::: {#tbl-loadingtab .cell layout-align=\"center\" tbl-cap='Factor Loadings'}\n::: {.cell-output .cell-output-stdout}\n\n```\n                     ML1   ML2\nspreading_rumours  0.931    NA\nbullying           0.899    NA\nfighting           0.653    NA\nusing_weapon       0.629    NA\nthreatening_others 0.621    NA\nvandalism             NA 0.694\nstealing              NA 0.696\nlying                 NA 0.767\nskipping_school       NA 0.671\nbreaking_curfew       NA 0.878\n```\n\n\n:::\n\n::: {.cell-output-display}\n\n\n|                   |  ML1|  ML2|\n|:------------------|----:|----:|\n|spreading_rumours  | 0.93|     |\n|bullying           | 0.90|     |\n|fighting           | 0.65|     |\n|using_weapon       | 0.63|     |\n|threatening_others | 0.62|     |\n|vandalism          |     | 0.69|\n|stealing           |     | 0.70|\n|lying              |     | 0.77|\n|skipping_school    |     | 0.67|\n|breaking_curfew    |     | 0.88|\n\n\n:::\n:::\n\n\n\n:::\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n",
    "supporting": [
      "07ex_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/panelset-0.3.0/panelset.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/panelset-0.3.0/panelset.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}