{
  "hash": "32151031df56b756d02aa78f8b4c5ddc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Extra Exercises: Regression Refresher\"\nparams: \n    SHOW_SOLS: TRUE\n    TOGGLE: TRUE\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\n\n\n# Workplace Pride\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n\n:::frame\n__Data: lmm_jsup.csv__\n\nA questionnaire was sent to all UK civil service departments, and the lmm_jsup.csv dataset contains all responses that were received. Some of these departments work as hybrid or 'virtual' departments, with a mix of remote and office-based employees. Others are fully office-based. \n\nThe questionnaire included items asking about how much the respondent believe in the department and how it engages with the community, what it produces, how it operates and how treats its people. A composite measure of 'workplace-pride' was constructed for each employee. Employees in the civil service are categorised into 3 different roles: A, B and C. The roles tend to increase in responsibility, with role C being more managerial, and role A having less responsibility. We also have data on the length of time each employee has been in the department (sometimes new employees come straight in at role C, but many of them start in role A and work up over time). \n\nWe're interested in whether the different roles are associated with differences in workplace-pride.  \n\n**Dataset: [https://uoepsy.github.io/data/lmm_jsup.csv](https://uoepsy.github.io/data/lmm_jsup.csv){target=\"_blank\"}.** \n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"mjxgrztigk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mjxgrztigk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mjxgrztigk thead, #mjxgrztigk tbody, #mjxgrztigk tfoot, #mjxgrztigk tr, #mjxgrztigk td, #mjxgrztigk th {\n  border-style: none;\n}\n\n#mjxgrztigk p {\n  margin: 0;\n  padding: 0;\n}\n\n#mjxgrztigk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mjxgrztigk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mjxgrztigk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mjxgrztigk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mjxgrztigk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mjxgrztigk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mjxgrztigk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mjxgrztigk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mjxgrztigk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mjxgrztigk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mjxgrztigk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mjxgrztigk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mjxgrztigk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mjxgrztigk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mjxgrztigk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mjxgrztigk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mjxgrztigk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mjxgrztigk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mjxgrztigk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mjxgrztigk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mjxgrztigk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mjxgrztigk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mjxgrztigk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mjxgrztigk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mjxgrztigk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mjxgrztigk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mjxgrztigk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mjxgrztigk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mjxgrztigk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mjxgrztigk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mjxgrztigk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mjxgrztigk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mjxgrztigk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mjxgrztigk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mjxgrztigk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mjxgrztigk .gt_left {\n  text-align: left;\n}\n\n#mjxgrztigk .gt_center {\n  text-align: center;\n}\n\n#mjxgrztigk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mjxgrztigk .gt_font_normal {\n  font-weight: normal;\n}\n\n#mjxgrztigk .gt_font_bold {\n  font-weight: bold;\n}\n\n#mjxgrztigk .gt_font_italic {\n  font-style: italic;\n}\n\n#mjxgrztigk .gt_super {\n  font-size: 65%;\n}\n\n#mjxgrztigk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mjxgrztigk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mjxgrztigk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mjxgrztigk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mjxgrztigk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mjxgrztigk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mjxgrztigk .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#mjxgrztigk .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#mjxgrztigk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"description\">description</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">department_name</td>\n<td headers=\"description\" class=\"gt_row gt_left\">Name of government department</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">dept</td>\n<td headers=\"description\" class=\"gt_row gt_left\">Department Acronym</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">virtual</td>\n<td headers=\"description\" class=\"gt_row gt_left\">Whether the department functions as hybrid department with various employees working remotely (1), or as a fully in-person office (0)</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">role</td>\n<td headers=\"description\" class=\"gt_row gt_left\">Employee role (A, B or C)</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">seniority</td>\n<td headers=\"description\" class=\"gt_row gt_left\">Employees seniority point. These map to roles, such that role A is 0-4, role B is 5-9, role C is 10-14. Higher numbers indicate more seniority</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">employment_length</td>\n<td headers=\"description\" class=\"gt_row gt_left\">Length of employment in the department (years)</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">wp</td>\n<td headers=\"description\" class=\"gt_row gt_left\">Composite Measure of 'Workplace Pride'</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\n\n:::\n\n\n\n\n\n<div class='question-begin'>Question 1</div><div class='question-body'>\n\n\nRead in the data and provide some descriptive statistics.  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nDon't remember how to do descriptives? Think back to previous courses - it's time for some means, standard deviations, mins and maxes. For categorical variables we can do counts or proportions. \n\nWe've seen various functions such as `summary()`, and also `describe()` from the **psych** package.  \n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-1' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-1', 'sol-start-1')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-1\" style=\"display: none;\">\n\n\n\nHere's the dataset:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse) # for data wrangling\nlibrary(psych) \n\njsup <- read_csv(\"https://uoepsy.github.io/data/lmm_jsup.csv\")\n```\n:::\n\n\n\n\nLet's take just the numeric variables and get some descriptives:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\njsup |> \n  select(employment_length, wp) |> \n  describe()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  vars   n  mean   sd median trimmed  mad  min   max range\nemployment_length    1 295 12.62 4.28  13.00   12.60 4.45 0.00 30.00 30.00\nwp                   2 295 25.49 5.27  25.44   25.46 5.93 6.34 38.46 32.12\n                   skew kurtosis   se\nemployment_length  0.08     0.38 0.25\nwp                -0.05    -0.14 0.31\n```\n\n\n:::\n:::\n\n\n\n\nAnd make frequency tables for the categorical ones: \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntable(jsup$role)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  A   B   C \n109  95  91 \n```\n\n\n:::\n:::\n\n\n\n\nI'm going to use `dept` rather than `department_name` as the output will be easier to see:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntable(jsup$dept)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n   ACE    CMA    CPS    FSA    GLD   HMRC    NCA   NS&I  OFGEM OFQUAL OFSTED \n    17     21     13     25     17     16     20     20     15      5     17 \n OFWAT    ORR    SFO   UKSA   UKSC \n    16     17     18     45     13 \n```\n\n\n:::\n\n```{.r .cell-code}\ntable(jsup$virtual)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  0   1 \n175 120 \n```\n\n\n:::\n:::\n\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 2</div><div class='question-body'>\n\n\nAre there differences in 'workplace-pride' between people in different roles?   \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\ndoes y [continuous variable] differ by x [three groups]? `lm(y ~ x)`?  \n\n:::\n\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-2' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-2', 'sol-start-2')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-2\" style=\"display: none;\">\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmod1 <- lm(wp ~ role, data = jsup)\n```\n:::\n\n\n\n\nRather than doing `summary(model)` - I'm just going to use the **broom** package to pull out some of the stats in nice tidy dataframes.  \n\nThe `glance()` function will give us things like the $R^2$ values and $F$-statistic (basically all the stuff that is at the bottom of the `summary()`):  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(broom)\nglance(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 12\n  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC\n      <dbl>         <dbl> <dbl>     <dbl>    <dbl> <dbl>  <dbl> <dbl> <dbl>\n1     0.216         0.211  4.68      40.3 3.44e-16     2  -872. 1753. 1768.\n# ℹ 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>\n```\n\n\n:::\n:::\n\n\n\n\nThe `tidy()` function will give us the coefficients, standard errors, t-statistics and p-values. It's the same information, just neater!  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntidy(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 5\n  term        estimate std.error statistic   p.value\n  <chr>          <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)    28.1      0.448     62.6  3.66e-171\n2 roleB          -2.24     0.657     -3.41 7.33e-  4\n3 roleC          -5.95     0.665     -8.95 4.38e- 17\n```\n\n\n:::\n:::\n\n\n\nAlternatively, we can get some quick confidence intervals for our coefficients: \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nconfint(mod1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                2.5 %     97.5 %\n(Intercept) 27.167804 28.9329302\nroleB       -3.536088 -0.9494885\nroleC       -7.255030 -4.6382319\n```\n\n\n:::\n:::\n\n\n\n\n\n\nIt looks like roles _do_ differ in their workplace pride. Specifically, compared to people in role A, people who are in roles B and C on average report _less_ pride in the workplace.  \n\n<!-- It looks like roles _do_ differ in their workplace pride ($F(2,292)=40.3218055, p< 0.001$). Compared to people in role A, people who are in roles B and C report a lot _less_ pride in the workplace ($b = -2.24, 95\\%\\,\\textrm{CI }[-3.54, -0.95]$ and $b = -5.95 [-7.26, -4.64]$ respectively).   -->\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 3</div><div class='question-body'>\n\n\nIs it something about the roles that make people report differences in workplace-pride, or is it possibly just that people who are newer to the company tend to feel more pride than those who have been there for a while (they're all jaded), and the people in role A tend to be much newer to the company (making it _look_ like the role A results in taking more pride). In other words, if we were to compare people in role A vs role B vs role C but hold constant their `employment_length`, we might see something different?  \n\nFit another model to find out.  \n\nTo help with interpreting the model, make a plot that shows all of the relevant variables that are in the model in one way or another. \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nSo we want to _adjust_ for how long people have been part of the company..  \nRemember - if we want to estimate the effect of `x` on `y` while adjusting for `z`, we can do `lm(y ~ z + x)`.  \n\nFor the plot - put something on the x, something on the y, and colour it by the other variable.  \n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-3' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-3', 'sol-start-3')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-3\" style=\"display: none;\">\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmod2 <- lm(wp ~ employment_length + role, data = jsup)\n\ntidy(mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 5\n  term              estimate std.error statistic   p.value\n  <chr>                <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)         36.1      0.709     50.9   6.90e-147\n2 employment_length   -0.834    0.0637   -13.1   4.32e- 31\n3 roleB                0.510    0.563      0.906 3.65e-  1\n4 roleC               -0.704    0.663     -1.06  2.89e-  1\n```\n\n\n:::\n:::\n\n\n\n\nNote that, after adjusting for employment length, there are no significant differences in `wp` between roles B or C compared to A.  \n\nIf we plot the data to show all these variables together, we can kind of see why! Given the pattern of `wp` against `employment_length`, the `wp` for different roles are pretty much where we would expect them to be if role doesn't make any difference (i.e., if role doesn't shift your `wp` up or down). \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(jsup, aes(x=employment_length,y=wp,col=role))+\n  geom_point(size=3,alpha=.3)\n```\n\n::: {.cell-output-display}\n![](00ex_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 4</div><div class='question-body'>\n\n\nDo roles differ in their workplace-pride, when adjusting for time in the company?  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nThis may feel like a repeat of the previous question, but note that this is not a question about _specific_ group differences. It is about whether, overall, the `role` groups differ.  So it's wanting to test the _joint_ effect of the two additional parameters we've just added to our model. (hint hint model comparison!)\n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-4' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-4', 'sol-start-4')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-4\" style=\"display: none;\">\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmod2a <- lm(wp ~ employment_length, data = jsup)\nmod2 <- lm(wp ~ employment_length + role, data = jsup)\n\nanova(mod2a, mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nModel 1: wp ~ employment_length\nModel 2: wp ~ employment_length + role\n  Res.Df    RSS Df Sum of Sq      F Pr(>F)\n1    293 4090.8                           \n2    291 4028.9  2    61.864 2.2342 0.1089\n```\n\n\n:::\n:::\n\n\n\n\nThis is no surprise given the previous question, we just now have a single test to report if we wanted to - after accounting for employment length, role does not explain a significant amount of variance in workplace pride.\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n<div class='question-begin'>Question 5</div><div class='question-body'>\n\n\nLet's take a step back and remember what data we actually have. We've got 295 people in our dataset, from 16 departments.  \n\nDepartments may well differ in the general amount of workplace-pride people report. People love to say that they work in the \"National Crime Agency\", but other departments might not elicit such pride (\\*cough\\* HM Revenue & Customs \\*cough\\*). \nWe need to be careful not to mistake department differences as something else (like differences due to the job role). \n\nMake a couple of plots to look at:\n\n1. how many of each role we have from each department\n2. how departments differ in their employees' pride in their workplace\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-5' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-5', 'sol-start-5')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-5\" style=\"display: none;\">\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(jsup, aes(x = role)) + \n  geom_bar()+\n  facet_wrap(~dept)\n```\n\n::: {.cell-output-display}\n![](00ex_files/figure-html/unnamed-chunk-16-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\nIn this case, it looks like most of the departments have similar numbers of each role, apart from the UKSA (\"UK Statistics Authority\"), where we've got _loads_ more of role A, and very few role C..  \n\nNote also that in the plot below, the UKSA is, on average, full of employees who take a lot of pride in their work. Is this due to the high proportion of people in role A? or is the effect of role we're seeing more due to differences in departments? \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(jsup, aes(x = dept, y = wp)) +\n  geom_boxplot() +\n  scale_x_discrete(labels = label_wrap_gen(35)) + \n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](00ex_files/figure-html/unnamed-chunk-17-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\nEven if we had perfectly equal numbers of roles in each department, we're also adjusting for other things such as `employment_length`, and the extent to which this differs by department can have trickle-on effects on our coefficient of interest (the `role` coefficients).  \n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n<div class='question-begin'>Question 6</div><div class='question-body'>\n\n\nAdjusting for both length of employment _and_ department, are there differences in 'workplace-pride' between the different roles?   \n\nCan you make a plot of all four of the variables involved in our model?  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nMaking the plot might take some thinking. We've now added `dept` into the mix, so a nice way might be to use `facet_wrap()` to make the same plot as the one we did previously, but for each department.    \n\n:::\n\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-6' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-6', 'sol-start-6')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-6\" style=\"display: none;\">\n\n\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmod3 <- lm(wp ~ employment_length + dept + role, data = jsup)\ntidy(mod3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 19 × 5\n   term              estimate std.error statistic   p.value\n   <chr>                <dbl>     <dbl>     <dbl>     <dbl>\n 1 (Intercept)        36.4       0.631    57.6    7.17e-156\n 2 employment_length  -0.882     0.0344  -25.7    4.71e- 75\n 3 deptCMA            -3.80      0.649    -5.85   1.39e-  8\n 4 deptCPS            -0.217     0.730    -0.298  7.66e-  1\n 5 deptFSA             4.74      0.625     7.60   4.71e- 13\n 6 deptGLD             0.0582    0.682     0.0853 9.32e-  1\n 7 deptHMRC           -3.79      0.692    -5.47   1.02e-  7\n 8 deptNCA            -3.85      0.655    -5.88   1.18e-  8\n 9 deptNS&I           -0.574     0.654    -0.878  3.81e-  1\n10 deptOFGEM          -0.648     0.705    -0.919  3.59e-  1\n11 deptOFQUAL         -4.94      1.01     -4.89   1.71e-  6\n12 deptOFSTED         -5.88      0.683    -8.61   5.52e- 16\n13 deptOFWAT          -1.21      0.692    -1.75   8.17e-  2\n14 deptORR            -2.85      0.681    -4.18   3.98e-  5\n15 deptSFO            -1.36      0.672    -2.02   4.47e-  2\n16 deptUKSA            4.28      0.576     7.43   1.32e- 12\n17 deptUKSC           -2.31      0.732    -3.16   1.77e-  3\n18 roleB               1.42      0.303     4.68   4.47e-  6\n19 roleC               1.31      0.366     3.59   3.92e-  4\n```\n\n\n:::\n:::\n\n\n\n\nIn a way, adding predictors to our model is kind of like splitting up our plots by that predictor to see the patterns. This becomes more and more difficult (/impossible) as we get more variables, but right now we can split the data into all the constituent parts. \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(jsup, aes(x = employment_length, y = wp, col = role)) +\n  geom_point(size=3,alpha=.4)+\n  facet_wrap(~dept)\n```\n\n::: {.cell-output-display}\n![](00ex_files/figure-html/unnamed-chunk-19-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\nThe association between `wp` and `employment_length` is clear in all these little sub-plots - there's a downward trend. The department differences can be seen too: UKSA is generally a bit higher, HMRC and UKSC a bit lower, and so on. By default, the model captures these coefficients as 'differences from the reference group', so all these coefficients are in relation to the \"ACE\" department.  \n\nSeeing the role differences is a bit harder in this plot, but think about what you would expect to see if there were no differences in roles (i.e. imagine if they were all in role A). Take for instance the FSA department, where this is easiest to see - for the people who are in role C, for people of their employment length we would expect their `wp` to be lower if they were in role A. Likewise for those in role B. Across all these departments, the people in role B and C (green and blue dots respectively) are a bit higher than we would expect. This is what the model coefficients tell us!  \n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n<div class='question-begin'>Question 7</div><div class='question-body'>\n\n\nNow we're starting to acknowledge the grouped structure of our data - these people in our dataset are related to one another in that some belong to dept 1, some dept 2, and so on..  \n\nLet's try to describe our sample in a bit more detail. \n\n- how many participants do we have, and from how many departments?\n- how many participants are there, on average, from each department? what is the minimum and maximum?\n- what is the average employment length for our participants?\n- how many departments are 'virtual departments' vs office-based?  \n- what is the overall average reported workplace-pride? \n- how much variation in workplace-pride is due to differences between departments?  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nThe first lot of these questions can be answered using things like `count()`, `summary()`, `table()`, `mean()`, `min()` etc. See [1: Clustered Data #determining-sample-sizes](https://uoepsy.github.io/lmm/01_clustered.html#determining-sample-sizes){target=\"_blank\"}\n\nFor the last one, we can use the ICC! See [1: Clustered Data #icc](https://uoepsy.github.io/lmm/01_clustered.html#icc---quantifying-clustering-in-an-outcome-variable){target=\"_blank\"}\n\n:::\n\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-7' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-7', 'sol-start-7')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-7\" style=\"display: none;\">\n\n\n\nHow many respondents do we have, and from how many departments?\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnrow(jsup)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 295\n```\n\n\n:::\n\n```{.r .cell-code}\nlength(table(jsup$dept))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 16\n```\n\n\n:::\n:::\n\n\n\n\n\nHow many respondents are there, on average, from each dept? What is the minimum and maximum number of people in any one department?\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\njsup |>\n  count(dept) |> \n  summarise(min=min(n),\n            max=max(n),\n            median=median(n)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n    min   max median\n  <int> <int>  <dbl>\n1     5    45     17\n```\n\n\n:::\n:::\n\n\n\n\nWhat is the average employment length of respondents?\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmean(jsup$employment_length)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 12.61695\n```\n\n\n:::\n:::\n\n\n\n\nHow many departments are virtual vs office based?\nThis requires a bit more than just `table(jsup$virtual)`, because we are describing a variable at the _department_ level.  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\njsup |> \n  group_by(virtual) |>\n  summarise(\n    ndept = n_distinct(dept)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n  virtual ndept\n    <dbl> <int>\n1       0    11\n2       1     5\n```\n\n\n:::\n:::\n\n\n\n\nWhat is the overall average 'workplace-pride'? What is the standard deviation?\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmean(jsup$wp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 25.49373\n```\n\n\n:::\n\n```{.r .cell-code}\nsd(jsup$wp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 5.270847\n```\n\n\n:::\n:::\n\n\n\n\nFinally, how much variation in workplace-pride is attributable to department-level differences?  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nICC::ICCbare(x = dept, y = wp, data = jsup)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4394114\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 8</div><div class='question-body'>\n\n\nWhat if we would like to know whether, when adjusting for differences due to employment length and roles, workplace-pride differs between people working in virtual-departments compared to office-based ones?  \n\nCan you add this to the model? What happens?  \n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-8' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-8', 'sol-start-8')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-8\" style=\"display: none;\">\n\n\n\nLet's add the `virtual` predictor to our model. Note that we don't actually get a coefficient here - it is giving us an `NA`!  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmod4 <- lm(wp ~ employment_length + dept + role + virtual, data = jsup)\n\nsummary(mod4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = wp ~ employment_length + dept + role + virtual, \n    data = jsup)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.6901 -1.4040 -0.0269  1.1782  5.0542 \n\nCoefficients: (1 not defined because of singularities)\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       36.35219    0.63098  57.612  < 2e-16 ***\nemployment_length -0.88169    0.03436 -25.658  < 2e-16 ***\ndeptCMA           -3.79695    0.64901  -5.850 1.39e-08 ***\ndeptCPS           -0.21732    0.73037  -0.298 0.766271    \ndeptFSA            4.74482    0.62453   7.597 4.71e-13 ***\ndeptGLD            0.05816    0.68221   0.085 0.932117    \ndeptHMRC          -3.78587    0.69236  -5.468 1.02e-07 ***\ndeptNCA           -3.85033    0.65486  -5.880 1.18e-08 ***\ndeptNS&I          -0.57367    0.65372  -0.878 0.380951    \ndeptOFGEM         -0.64794    0.70497  -0.919 0.358850    \ndeptOFQUAL        -4.94134    1.01041  -4.890 1.71e-06 ***\ndeptOFSTED        -5.88455    0.68314  -8.614 5.52e-16 ***\ndeptOFWAT         -1.20866    0.69172  -1.747 0.081692 .  \ndeptORR           -2.84522    0.68127  -4.176 3.98e-05 ***\ndeptSFO           -1.35503    0.67189  -2.017 0.044689 *  \ndeptUKSA           4.28197    0.57593   7.435 1.32e-12 ***\ndeptUKSC          -2.31312    0.73248  -3.158 0.001765 ** \nroleB              1.41790    0.30286   4.682 4.47e-06 ***\nroleC              1.31478    0.36632   3.589 0.000392 ***\nvirtual                 NA         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.982 on 276 degrees of freedom\nMultiple R-squared:  0.8673,\tAdjusted R-squared:  0.8587 \nF-statistic: 100.2 on 18 and 276 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\nSo what is happening? If we think about it, if we separate out \"differences due to departments\" then there is nothing left to compare between departments that are virtual vs office based.\nAdding the between-department predictor of `virtual` doesn't explain anything more - the residual sums of squares doesn't decrease at all:  \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nanova(\n  lm(wp ~ employment_length + dept + role, data = jsup),\n  lm(wp ~ employment_length + dept + role + virtual, data = jsup)\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nModel 1: wp ~ employment_length + dept + role\nModel 2: wp ~ employment_length + dept + role + virtual\n  Res.Df    RSS Df Sum of Sq F Pr(>F)\n1    276 1083.8                      \n2    276 1083.8  0         0         \n```\n\n\n:::\n:::\n\n\n\n\nAnother way of thinking about this: knowing the average workplace-pride for the department that someone is in tells me what to expect about that person's workplace pride. But once I know their department's average workplace-pride, knowing whether it is 'virtual' or 'office-based' doesn't tell me anything new, for the very fact that the virtual/office-based distinction comes from *comparing different departments*.  \n\nBut we're not really interested in these departments specifically! What would be nice would be if we can look at the relevant effects of interest (things like `role` and `virtual`), but then just think of the department differences as just some sort of random variation. So we want to think of departments in a similar way to how we think of our individual *employees* - they vary randomly around what we expect - only they're at a different _level_ of observation. Such an approach is what we will learn about this semester - \"multilevel models\"!    \n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n",
    "supporting": [
      "00ex_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/panelset-0.3.0/panelset.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/panelset-0.3.0/panelset.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}