{"title":"Week 5 Exercises: Assumptions, Diagnostics, Writing up","markdown":{"yaml":{"title":"Week 5 Exercises: Assumptions, Diagnostics, Writing up","params":{"SHOW_SOLS":false,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"headingText":"Video game aggression and the dark triad","containsRefs":false,"markdown":"\n\n```{r}\n#| label: setup\n#| include: false\nsource('assets/setup.R')\nlibrary(xaringanExtra)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(ggdist)\nxaringanExtra::use_panelset()\nqcounter <- function(){\n  if(!exists(\"qcounter_i\")){\n    qcounter_i <<- 1\n  }else{\n    qcounter_i <<- qcounter_i + 1\n  }\n  qcounter_i\n}\nlibrary(lme4)\n```\n\n\n:::frame\n__Dataset: NGV.csv__  \n\nThese data are from an experiment designed to investigate how the realism of video games is associated with more/less unnecessarily aggressive gameplay, and whether this differs depending upon a) the playing mode (playing on a screen vs VR headset), and b) individual differences in the 'dark triad' personality traits.  \n\nThe experiment involved playing 10 levels of a game in which the objective was to escape a maze. Various obstacles and other characters were present throughout the maze, and players could interact with these by side-stepping or jumping over them, or by pushing or shooting at them. All of these actions took the same amount of effort to complete (pressing a button), and each one achieved the same end (moving beyond the obstacle and being able to continue through the maze).  \n\nEach participant completed all 10 levels twice, once in which all characters were presented as cartoons, and once in which all characters were presented as realistic humans and animals. The layout of the level was identical in both, the only difference being the depiction of objects and characters. For each participant, these 20 levels ($2 \\times 10$ mazes) were presented in a random order. Half of the participants played via a screen, and the other half played via a VR headset. For each level played, we have a record of \"needless game violence\" (NGV) which was calculated via the number of aggressive (pushing/shooting) actions taken (+0.5 for every action that missed an object, +1 for every action aimed at an inanimate object, and +2 for every action aimed at an animate character).  \nPrior to the experiment, each participant completed the Short Dark Triad 3 (SD-3), which measures the three traits of machiavellianism, narcissism, and psychopathy.  \n\n**Dataset:** [https://uoepsy.github.io/data/NGV.csv](https://uoepsy.github.io/data/NGV.csv){target=\"_blank\"}\n\n```{r}\n#| echo: false\nngv <- read_csv(\"../../data/NGV.csv\")\ntibble(\n  variable=names(ngv),\n  description=c(\n    \"Participant number\",\n    \"Participant age (years)\",\n    \"Maze level (1 to 10)\",\n    \"Whether the objects and characters in the level were presented as 'cartoon' or as 'realistic'\",\n    \"Whether the participant played via a screen or with a VR headset\",\n    \"Psycopathy Trait from SD-3 (score 1-5)\",\n    \"Narcissism Trait from SD-3 (score 1-5)\",\n    \"Machiavellianism Trait from SD-3 (score 1-5)\",\n    \"Needless Game Violence metric\"\n  )\n) |> gt::gt()\n```\n\n\n\n:::\n\n`r qbegin(qcounter())`\nConduct an analysis to address the research aims!  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\n- There's a lot to unpack in the research aim: _\"how the realism of video games is associated with more/less unnecessarily aggressive gameplay, and whether this differs depending upon a) the playing mode (playing on a screen vs VR headset), and b) individual differences in the 'dark triad' personality traits.\"_    \n\n\n:::\n\n`r qend()`\n`r solbegin(label=\"1 - some quick checks\", slabel=F, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n\n```{r}\nngv <- read_csv(\"https://uoepsy.github.io/data/NGV.csv\")\n```\n\nLet's make things factors and see where we stand: \n```{r}\nngv <- ngv |> \n  mutate(\n    PID = factor(PID),\n    level = factor(level),\n    character = factor(character),\n    mode = factor(mode)\n  )\n\nsummary(ngv)\n```\n\neverything looks good to me! All ranges looks fine.  \n\nHow many people do we have? \n```{r}\ndim(table(ngv$PID, ngv$character))\n```\n76!  \nDoes everyone have 10 datapoints for cartoon and 10 for realistic?  \n```{r}\nany(table(ngv$PID, ngv$character)!=10)\n```\nyes, they do!  \n\n\n`r solend()`\n`r solbegin(label=\"2 - some exploratory plots\", slabel=F, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nOkay. Let's plot.. \nThe question asks about _\"how the realism of video games is associated with more/less unnecessarily aggressive gameplay\"_.  \n\nSo we'll put the `character` on the x-axis and our outcome `NGV` on the y:  \nI like jitters, but you could put boxplots or violin plots too!  \n```{r}\nggplot(ngv, aes(x = character, y = NGV)) +\n  geom_jitter(height=0, width=.2, alpha=.2)\n```\n\nWe're also interested in whether this differs depending on the mode of gameplay (screen vs VR headset). So we could facet_wrap perhaps? or colour?  \nLet's also plot the means - i'll put those to the side of all the jittered points with a \"nudge\".. \n```{r}\nggplot(ngv, aes(x = character, y = NGV, col = mode)) +\n  geom_jitter(height=0, width=.2, alpha=.2) +\n  stat_summary(geom=\"pointrange\", position = position_nudge(x=.25))\n```\n\nAs well as looking at whether the `NGV~character` relationship differs between modes, we're also interested in the differences in this relationship due to individual differences in the dark triad personality traits. We have these measured for each person, so we can just use a similar idea:  \n```{r}\nggplot(ngv, aes(x = character, y = NGV, col = factor(P))) +\n  geom_jitter(height=0, width=.2, alpha=.2) +\n  stat_summary(geom=\"pointrange\", position = position_nudge(x=.25))\n\nggplot(ngv, aes(x = character, y = NGV, col = factor(M))) +\n  geom_jitter(height=0, width=.2, alpha=.2) +\n  stat_summary(geom=\"pointrange\", position = position_nudge(x=.25))\n\nggplot(ngv, aes(x = character, y = NGV, col = factor(N))) +\n  geom_jitter(height=0, width=.2, alpha=.2) +\n  stat_summary(geom=\"pointrange\", position = position_nudge(x=.25))\n```\n\nWhat do we get from all these plots? Well, it looks like mode _might_ be changing the relationship between character and violence. \nIt also looks like there's a considerable effect of the dark triad on the amount of violence people use! Of course, in these individual plots, it's hard to ascertain the extent to which plots showing differences between levels of Narcissism are due to Narcissism or due to differences in Psychopathy (all the dark triad traits are fairly correlated)\n```{r}\nngv |> select(P,N,M) |>\n  cor() |> round(2)\n```\n\nSo we need to do some modelling! \n\n\n`r solend()`\n`r solbegin(label=\"3 - fitting a model\", slabel=F, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n__NOTE:__ This is how I might approach this question. There are lots of other things that we could quite sensibly do!  \n\n\n- We know that we're interested in `NGV ~ character`.  \n- We also have the additional question of whether this is different between modes - `NGV ~ character * mode`.  \n- And whether the `NGV ~ character` association is modulated by Psychopathy `NGV ~ character * P`, and by Narcissism `NGV ~ character * N`, and by Machiavellianism `NGV ~ character * M`.  \n\nWe could fit these all in one:  \n`NGV ~ character * (mode + P + M + N)`  \n\nWe have multiple observations per participant `PID`, and we also have multiple observations for each level `level`. All participants see every level, and every level is seen by all participants. It's not the case that a level is unique to a single participant, so these are _crossed_.  \n`( ?? | PID) + ( ?? | level)`  \n\nParticipants plays both the cartoon and the realistic versions, so we could have variation between participants in how realism affects violence - `(1 + character | PID)`. Beyond this, all variables are measured at the participant level, so we can't have anything else.  \n\nFor the levels, each level is played by some participants in VR headsets and some participants on a screen, so we could have some levels for which VR feels very different (and makes you play more violently?) - `(mode | level)`.  We could also have some levels for which the realism has a bigger effect - `(character | level)`, and also have some levels for which people high on the dark triad play differently - i.e. the dark triad could result in lots of violence in level 2, but not in level 3 - `(P + M + N | level)`.  \n\n_(you could also try to fit the interactions in the random effects here but i'm not going to even try!)_  \n```{r}\nm0 = lmer(NGV ~ character * (mode + P + M + N) + \n            (1 + character | PID) + \n            (1 + character + mode + P + M + N | level), data = ngv)\n```\n\nafter some simplification, I end up at the model below. You might end up at a slightly different random effect structure, and that is completely okay! The important thing is to be transparent in your decisions.  \n```{r}\nm1 = lmer(NGV ~ character * (mode + P + M + N) + \n            (1 + character | PID) + \n            (1 + mode | level), data = ngv)\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nCheck the assumptions of your model\n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nWe have a multilevel model, so we have assumptions at multiple levels! See [Chapter 9 #mlm-assumptions-diagnostics](https://uoepsy.github.io/lmm/09_assump.html#mlm-assumptions-diagnostics){target=\"_blank\"}.  \n\nBe careful - QQplots with few datapoints can make things look weirder than they are - try a histogram too \n\n\n:::\n\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nHere are some assumption plots: \n```{r}\nplot(m1)\nplot(m1,\n     form = sqrt(abs(resid(.))) ~ fitted(.),\n     type = c(\"p\",\"smooth\"))\n```\n\nThere's something weird going on in the left hand side with a bunch of points looking funny! My guess is that this may well come out when examining influence. \n\nIn the QQplots of the random effects below we can see a couple of participants are a bit off - this may well be what we are seeing above.  \n```{r echo=c(2,3,4,5)}\npar(mfrow=c(2,2))\nqqnorm(ranef(m1)$PID[,1],main=\"1|PID\");qqline(ranef(m1)$PID[,1])\nqqnorm(ranef(m1)$PID[,2],main=\"character|PID\");qqline(ranef(m1)$PID[,2])\nqqnorm(ranef(m1)$level[,1],main=\"1|level\");qqline(ranef(m1)$level[,1])\nqqnorm(ranef(m1)$level[,2],main=\"mode|level\");qqline(ranef(m1)$level[,2])\npar(mfrow=c(1,1))\n```\n\nThe QQplots for the level random effects are hard to evaluate in part because there aren't many levels (only 10). Let's do some histograms too. They don't look _terrible_.. \n\n```{r echo=c(2,3,4,5)}\npar(mfrow=c(2,2))\nhist(ranef(m1)$PID[,1],main=\"1|PID\")\nhist(ranef(m1)$PID[,2],main=\"character|PID\")\nhist(ranef(m1)$level[,1],main=\"1|level\")\nhist(ranef(m1)$level[,2],main=\"mode|level\")\npar(mfrow=c(1,1))\n```\n\nOur model predictions don't look great either. Something is happening at values of 0?  \n\n```{r}\nlibrary(performance)\ncheck_predictions(m1)\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nCheck the extent to which your results may be sensitive to certain influential observations, or participants, or levels!  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nSee [Chapter 9 #influence](https://uoepsy.github.io/lmm/09_assump.html#influence){target=\"_blank\"} for two packages that can assess influence. \n\n:::\n\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nlet's check for influential participants first:  \n```{r}\nlibrary(HLMdiag)\ninf2 <- hlm_influence(m1,level=\"PID\")\ndotplot_diag(inf2$cooksd, index=inf2$PID, cutoff=\"internal\")\n```\n\nand let's re-fit without those two weird people.. \n```{r}\nm1a <- lmer(NGV ~ character * (mode + P + M + N) + \n            (1 + character | PID) + \n            (1 + mode | level), \n            data = ngv |> filter(!(PID %in% c(\"ppt_59\",\"ppt_53\"))))\n```\n\nOur conclusions change!  \nThe significance of `P` (which is the association between psychopathy and needless violence in the cartoon condition) depends upon exclusion of these two participants. \nI'm showing the table with Satterthwaite p-values as it's a bit quicker, but given that we have only 10 groups for the `level` random effect, it might be worth switching to KR\n```{r}\nlibrary(sjPlot)\ntab_model(m1,m1a, df.method=\"satterthwaite\")\n```\n\nNote that our model predictions look much better\n```{r}\ncheck_predictions(m1a)\n```\n\nIf we look at those two people - they just didn't do much (or any) \"needless game violence\".  \n```{r}\nngv |> filter(PID %in% c(\"ppt_59\",\"ppt_53\")) |>\n  ggplot(aes(x=character, y=NGV)) +\n  geom_jitter(height=0, width=.2) + \n  facet_wrap(~PID)\n```\n\nLet's check for influential levels now:  \n```{r}\ninf3 <- hlm_influence(m1a,level=\"level\")\ndotplot_diag(inf3$cooksd)\n```\n\nand for influential observations\n```{r}\ninf1 <- hlm_influence(m1a,level=1)\ndotplot_diag(inf1$cooksd)\n```\n\n`r solend()`\n\n<br>\n<div class=\"divider div-transparent div-dot\"></div>\n\n\n\n# All the datasets!  \n\nThe link below will take you to a page with all the datasets that we have seen across the readings and exercises, as well as a few extra ones that should be new! For each one, there is a quick explanation of the study design which also details the research aims of the project.  \n\n- [DATASETS PAGE](https://uoepsy.github.io/lmm/00_datasets.html){target=\"_blank\"}\n  \nPick one of the datasets and: \n\n1. explore the data, and do any required cleaning (most of them are clean already)\n2. conduct an analysis to address the research aims\n3. write a short description of the sample data [(see Chapter 11 #the-sample-data)](https://uoepsy.github.io/lmm/11_writing.html#the-sample-data){target=\"_blank\"}\n4. write a short explanation of your methods [(see Chapter 11 #the-methods)](https://uoepsy.github.io/lmm/11_writing.html#the-methods){target=\"_blank\"}\n5. write a short summary of your results, along with suitable visualisations and tables [(see Chapter 11 #the-results)](https://uoepsy.github.io/lmm/11_writing.html#the-results){target=\"_blank\"}\n6. Post some of your writing on Piazza and we can collectively discuss it!  \n\nIf you like, work on this as a group - set up a google doc to collaboratively write together (it's much more fun that way!)\n\n\n\n\n","srcMarkdownNoYaml":"\n\n```{r}\n#| label: setup\n#| include: false\nsource('assets/setup.R')\nlibrary(xaringanExtra)\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(ggdist)\nxaringanExtra::use_panelset()\nqcounter <- function(){\n  if(!exists(\"qcounter_i\")){\n    qcounter_i <<- 1\n  }else{\n    qcounter_i <<- qcounter_i + 1\n  }\n  qcounter_i\n}\nlibrary(lme4)\n```\n\n# Video game aggression and the dark triad \n\n:::frame\n__Dataset: NGV.csv__  \n\nThese data are from an experiment designed to investigate how the realism of video games is associated with more/less unnecessarily aggressive gameplay, and whether this differs depending upon a) the playing mode (playing on a screen vs VR headset), and b) individual differences in the 'dark triad' personality traits.  \n\nThe experiment involved playing 10 levels of a game in which the objective was to escape a maze. Various obstacles and other characters were present throughout the maze, and players could interact with these by side-stepping or jumping over them, or by pushing or shooting at them. All of these actions took the same amount of effort to complete (pressing a button), and each one achieved the same end (moving beyond the obstacle and being able to continue through the maze).  \n\nEach participant completed all 10 levels twice, once in which all characters were presented as cartoons, and once in which all characters were presented as realistic humans and animals. The layout of the level was identical in both, the only difference being the depiction of objects and characters. For each participant, these 20 levels ($2 \\times 10$ mazes) were presented in a random order. Half of the participants played via a screen, and the other half played via a VR headset. For each level played, we have a record of \"needless game violence\" (NGV) which was calculated via the number of aggressive (pushing/shooting) actions taken (+0.5 for every action that missed an object, +1 for every action aimed at an inanimate object, and +2 for every action aimed at an animate character).  \nPrior to the experiment, each participant completed the Short Dark Triad 3 (SD-3), which measures the three traits of machiavellianism, narcissism, and psychopathy.  \n\n**Dataset:** [https://uoepsy.github.io/data/NGV.csv](https://uoepsy.github.io/data/NGV.csv){target=\"_blank\"}\n\n```{r}\n#| echo: false\nngv <- read_csv(\"../../data/NGV.csv\")\ntibble(\n  variable=names(ngv),\n  description=c(\n    \"Participant number\",\n    \"Participant age (years)\",\n    \"Maze level (1 to 10)\",\n    \"Whether the objects and characters in the level were presented as 'cartoon' or as 'realistic'\",\n    \"Whether the participant played via a screen or with a VR headset\",\n    \"Psycopathy Trait from SD-3 (score 1-5)\",\n    \"Narcissism Trait from SD-3 (score 1-5)\",\n    \"Machiavellianism Trait from SD-3 (score 1-5)\",\n    \"Needless Game Violence metric\"\n  )\n) |> gt::gt()\n```\n\n\n\n:::\n\n`r qbegin(qcounter())`\nConduct an analysis to address the research aims!  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\n- There's a lot to unpack in the research aim: _\"how the realism of video games is associated with more/less unnecessarily aggressive gameplay, and whether this differs depending upon a) the playing mode (playing on a screen vs VR headset), and b) individual differences in the 'dark triad' personality traits.\"_    \n\n\n:::\n\n`r qend()`\n`r solbegin(label=\"1 - some quick checks\", slabel=F, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n\n```{r}\nngv <- read_csv(\"https://uoepsy.github.io/data/NGV.csv\")\n```\n\nLet's make things factors and see where we stand: \n```{r}\nngv <- ngv |> \n  mutate(\n    PID = factor(PID),\n    level = factor(level),\n    character = factor(character),\n    mode = factor(mode)\n  )\n\nsummary(ngv)\n```\n\neverything looks good to me! All ranges looks fine.  \n\nHow many people do we have? \n```{r}\ndim(table(ngv$PID, ngv$character))\n```\n76!  \nDoes everyone have 10 datapoints for cartoon and 10 for realistic?  \n```{r}\nany(table(ngv$PID, ngv$character)!=10)\n```\nyes, they do!  \n\n\n`r solend()`\n`r solbegin(label=\"2 - some exploratory plots\", slabel=F, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nOkay. Let's plot.. \nThe question asks about _\"how the realism of video games is associated with more/less unnecessarily aggressive gameplay\"_.  \n\nSo we'll put the `character` on the x-axis and our outcome `NGV` on the y:  \nI like jitters, but you could put boxplots or violin plots too!  \n```{r}\nggplot(ngv, aes(x = character, y = NGV)) +\n  geom_jitter(height=0, width=.2, alpha=.2)\n```\n\nWe're also interested in whether this differs depending on the mode of gameplay (screen vs VR headset). So we could facet_wrap perhaps? or colour?  \nLet's also plot the means - i'll put those to the side of all the jittered points with a \"nudge\".. \n```{r}\nggplot(ngv, aes(x = character, y = NGV, col = mode)) +\n  geom_jitter(height=0, width=.2, alpha=.2) +\n  stat_summary(geom=\"pointrange\", position = position_nudge(x=.25))\n```\n\nAs well as looking at whether the `NGV~character` relationship differs between modes, we're also interested in the differences in this relationship due to individual differences in the dark triad personality traits. We have these measured for each person, so we can just use a similar idea:  \n```{r}\nggplot(ngv, aes(x = character, y = NGV, col = factor(P))) +\n  geom_jitter(height=0, width=.2, alpha=.2) +\n  stat_summary(geom=\"pointrange\", position = position_nudge(x=.25))\n\nggplot(ngv, aes(x = character, y = NGV, col = factor(M))) +\n  geom_jitter(height=0, width=.2, alpha=.2) +\n  stat_summary(geom=\"pointrange\", position = position_nudge(x=.25))\n\nggplot(ngv, aes(x = character, y = NGV, col = factor(N))) +\n  geom_jitter(height=0, width=.2, alpha=.2) +\n  stat_summary(geom=\"pointrange\", position = position_nudge(x=.25))\n```\n\nWhat do we get from all these plots? Well, it looks like mode _might_ be changing the relationship between character and violence. \nIt also looks like there's a considerable effect of the dark triad on the amount of violence people use! Of course, in these individual plots, it's hard to ascertain the extent to which plots showing differences between levels of Narcissism are due to Narcissism or due to differences in Psychopathy (all the dark triad traits are fairly correlated)\n```{r}\nngv |> select(P,N,M) |>\n  cor() |> round(2)\n```\n\nSo we need to do some modelling! \n\n\n`r solend()`\n`r solbegin(label=\"3 - fitting a model\", slabel=F, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n__NOTE:__ This is how I might approach this question. There are lots of other things that we could quite sensibly do!  \n\n\n- We know that we're interested in `NGV ~ character`.  \n- We also have the additional question of whether this is different between modes - `NGV ~ character * mode`.  \n- And whether the `NGV ~ character` association is modulated by Psychopathy `NGV ~ character * P`, and by Narcissism `NGV ~ character * N`, and by Machiavellianism `NGV ~ character * M`.  \n\nWe could fit these all in one:  \n`NGV ~ character * (mode + P + M + N)`  \n\nWe have multiple observations per participant `PID`, and we also have multiple observations for each level `level`. All participants see every level, and every level is seen by all participants. It's not the case that a level is unique to a single participant, so these are _crossed_.  \n`( ?? | PID) + ( ?? | level)`  \n\nParticipants plays both the cartoon and the realistic versions, so we could have variation between participants in how realism affects violence - `(1 + character | PID)`. Beyond this, all variables are measured at the participant level, so we can't have anything else.  \n\nFor the levels, each level is played by some participants in VR headsets and some participants on a screen, so we could have some levels for which VR feels very different (and makes you play more violently?) - `(mode | level)`.  We could also have some levels for which the realism has a bigger effect - `(character | level)`, and also have some levels for which people high on the dark triad play differently - i.e. the dark triad could result in lots of violence in level 2, but not in level 3 - `(P + M + N | level)`.  \n\n_(you could also try to fit the interactions in the random effects here but i'm not going to even try!)_  \n```{r}\nm0 = lmer(NGV ~ character * (mode + P + M + N) + \n            (1 + character | PID) + \n            (1 + character + mode + P + M + N | level), data = ngv)\n```\n\nafter some simplification, I end up at the model below. You might end up at a slightly different random effect structure, and that is completely okay! The important thing is to be transparent in your decisions.  \n```{r}\nm1 = lmer(NGV ~ character * (mode + P + M + N) + \n            (1 + character | PID) + \n            (1 + mode | level), data = ngv)\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nCheck the assumptions of your model\n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nWe have a multilevel model, so we have assumptions at multiple levels! See [Chapter 9 #mlm-assumptions-diagnostics](https://uoepsy.github.io/lmm/09_assump.html#mlm-assumptions-diagnostics){target=\"_blank\"}.  \n\nBe careful - QQplots with few datapoints can make things look weirder than they are - try a histogram too \n\n\n:::\n\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nHere are some assumption plots: \n```{r}\nplot(m1)\nplot(m1,\n     form = sqrt(abs(resid(.))) ~ fitted(.),\n     type = c(\"p\",\"smooth\"))\n```\n\nThere's something weird going on in the left hand side with a bunch of points looking funny! My guess is that this may well come out when examining influence. \n\nIn the QQplots of the random effects below we can see a couple of participants are a bit off - this may well be what we are seeing above.  \n```{r echo=c(2,3,4,5)}\npar(mfrow=c(2,2))\nqqnorm(ranef(m1)$PID[,1],main=\"1|PID\");qqline(ranef(m1)$PID[,1])\nqqnorm(ranef(m1)$PID[,2],main=\"character|PID\");qqline(ranef(m1)$PID[,2])\nqqnorm(ranef(m1)$level[,1],main=\"1|level\");qqline(ranef(m1)$level[,1])\nqqnorm(ranef(m1)$level[,2],main=\"mode|level\");qqline(ranef(m1)$level[,2])\npar(mfrow=c(1,1))\n```\n\nThe QQplots for the level random effects are hard to evaluate in part because there aren't many levels (only 10). Let's do some histograms too. They don't look _terrible_.. \n\n```{r echo=c(2,3,4,5)}\npar(mfrow=c(2,2))\nhist(ranef(m1)$PID[,1],main=\"1|PID\")\nhist(ranef(m1)$PID[,2],main=\"character|PID\")\nhist(ranef(m1)$level[,1],main=\"1|level\")\nhist(ranef(m1)$level[,2],main=\"mode|level\")\npar(mfrow=c(1,1))\n```\n\nOur model predictions don't look great either. Something is happening at values of 0?  \n\n```{r}\nlibrary(performance)\ncheck_predictions(m1)\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nCheck the extent to which your results may be sensitive to certain influential observations, or participants, or levels!  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nSee [Chapter 9 #influence](https://uoepsy.github.io/lmm/09_assump.html#influence){target=\"_blank\"} for two packages that can assess influence. \n\n:::\n\n\n`r qend()`\n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nlet's check for influential participants first:  \n```{r}\nlibrary(HLMdiag)\ninf2 <- hlm_influence(m1,level=\"PID\")\ndotplot_diag(inf2$cooksd, index=inf2$PID, cutoff=\"internal\")\n```\n\nand let's re-fit without those two weird people.. \n```{r}\nm1a <- lmer(NGV ~ character * (mode + P + M + N) + \n            (1 + character | PID) + \n            (1 + mode | level), \n            data = ngv |> filter(!(PID %in% c(\"ppt_59\",\"ppt_53\"))))\n```\n\nOur conclusions change!  \nThe significance of `P` (which is the association between psychopathy and needless violence in the cartoon condition) depends upon exclusion of these two participants. \nI'm showing the table with Satterthwaite p-values as it's a bit quicker, but given that we have only 10 groups for the `level` random effect, it might be worth switching to KR\n```{r}\nlibrary(sjPlot)\ntab_model(m1,m1a, df.method=\"satterthwaite\")\n```\n\nNote that our model predictions look much better\n```{r}\ncheck_predictions(m1a)\n```\n\nIf we look at those two people - they just didn't do much (or any) \"needless game violence\".  \n```{r}\nngv |> filter(PID %in% c(\"ppt_59\",\"ppt_53\")) |>\n  ggplot(aes(x=character, y=NGV)) +\n  geom_jitter(height=0, width=.2) + \n  facet_wrap(~PID)\n```\n\nLet's check for influential levels now:  \n```{r}\ninf3 <- hlm_influence(m1a,level=\"level\")\ndotplot_diag(inf3$cooksd)\n```\n\nand for influential observations\n```{r}\ninf1 <- hlm_influence(m1a,level=1)\ndotplot_diag(inf1$cooksd)\n```\n\n`r solend()`\n\n<br>\n<div class=\"divider div-transparent div-dot\"></div>\n\n\n\n# All the datasets!  \n\nThe link below will take you to a page with all the datasets that we have seen across the readings and exercises, as well as a few extra ones that should be new! For each one, there is a quick explanation of the study design which also details the research aims of the project.  \n\n- [DATASETS PAGE](https://uoepsy.github.io/lmm/00_datasets.html){target=\"_blank\"}\n  \nPick one of the datasets and: \n\n1. explore the data, and do any required cleaning (most of them are clean already)\n2. conduct an analysis to address the research aims\n3. write a short description of the sample data [(see Chapter 11 #the-sample-data)](https://uoepsy.github.io/lmm/11_writing.html#the-sample-data){target=\"_blank\"}\n4. write a short explanation of your methods [(see Chapter 11 #the-methods)](https://uoepsy.github.io/lmm/11_writing.html#the-methods){target=\"_blank\"}\n5. write a short summary of your results, along with suitable visualisations and tables [(see Chapter 11 #the-results)](https://uoepsy.github.io/lmm/11_writing.html#the-results){target=\"_blank\"}\n6. Post some of your writing on Piazza and we can collectively discuss it!  \n\nIf you like, work on this as a group - set up a google doc to collaboratively write together (it's much more fun that way!)\n\n\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"include-in-header":["assets/toggling.html",{"text":"<link rel=\"stylesheet\" href=\"https://uoepsy.github.io/assets/css/ccfooter.css\" />\n"}],"number-sections":false,"output-file":"05ex.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","toc_float":true,"link-citations":true,"theme":["united","assets/style-labs.scss"],"title":"Week 5 Exercises: Assumptions, Diagnostics, Writing up","params":{"SHOW_SOLS":false,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}