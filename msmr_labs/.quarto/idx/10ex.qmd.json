{"title":"Week 10 Exercises: Structural Equation Modelling (SEM)","markdown":{"yaml":{"title":"Week 10 Exercises: Structural Equation Modelling (SEM)","params":{"SHOW_SOLS":false,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"headingText":"Measurement Error and the need for SEM","containsRefs":false,"markdown":"\n\n```{r}\n#| label: setup\n#| include: false\nsource('assets/setup.R')\nlibrary(xaringanExtra)\nlibrary(tidyverse)\nlibrary(patchwork)\nxaringanExtra::use_panelset()\nqcounter <- function(){\n  if(!exists(\"qcounter_i\")){\n    qcounter_i <<- 1\n  }else{\n    qcounter_i <<- qcounter_i + 1\n  }\n  qcounter_i\n}\nlibrary(psych)\nlibrary(semPlot)\nlibrary(lavaan)\n```\n\n\n::: {.callout-note collapse=\"true\"}\n\nYou have probably heard the term \"Structural Equation Modelling (SEM)\" for a few weeks now, but we haven't been very clear on what exactly it is. Is it CFA? Is it Path Analysis? In fact it is both - it is the overarching framework of which CFA and Path Analysis are just particular cases. The beauty comes in when we put the CFA and Path Analysis approaches together.\n\nPath analysis, as we saw last week, offers a way of specifying and evaluating a *structural* model, in which variables relate to one another in various ways, via different (sometimes indirect) paths. Common models like our old friend multiple regression can be expressed in a Path Analysis framework.\n\nFactor Analysis, on the other hand, brings something absolutely crucial to the table - it allows us to mitigate some of the problems which are associated with measurement error by specifying the existence of some latent variable which is measured via some observed variables. No question can perfectly measure someone's level of \"anxiety\", but if we take a set of 10 carefully chosen questions, we can consider the shared covariance between those 10 questions to represent the construct that is common between all of them (they all ask, in different ways, about \"anxiety\"), also modeling the unique error with which each individual question fails to perfectly represent the entire construct.  \n\nCombine them and we can reap the rewards of having both a *structural model* and a *measurement model*. The measurement model is our specification between the items we directly observed, and the latent variables of which we consider these items to be manifestations. The structural model is our specified model of the relationships between the latent variables.  \n\n\n```{r}\n#| label: fig-semmdiag\n#| fig-cap: \"SEM diagram. Measurement model in orange, Structural model in purple\"\n#| echo: false\nknitr::include_graphics(\"images/semdiag2.png\")\n```\n\n:::frame\n__You can't test the structural model if the measurement model is bad__  \n\nIf you test the relationships between a set of latent factors, and they are not reliably measured by the observed items, then this error propagates up to influence the fit of the structural model.  \nTo test the measurement model, it is typical to *saturate* the structural model (i.e., allow all the latent variables to correlate with one another). This way any misfit is due to the measurement model only.  \n\nAlternatively, we can fit individual CFA models for each construct and assess their fit (making any reasonable adjustments if necessary) prior to then fitting the full SEM.\n\n:::\n\n:::\n\n# Exercising Exercises\n\n```{r}\n#| include: false\nset.seed(235)\nm = \"\natt =~ 0.689*attitude1+0.726*attitude2+0.689*attitude3+0.719*attitude4\nSN =~ 0.661*SN1+0.651*SN2+0.616*SN3+0.638*SN4\nPBC =~ 0.799*PBC1+0.772*PBC2+0.756*PBC3+0.773*PBC4\nintent =~ 0.584*int1+0.646*int2+0.625*int3+0.597*int4+0.6*int5\nbeh =~ 0.649*beh1+0.599*beh2+0.588*beh3+-0.605*beh4\n\nint2~~.4*int4\nint1~~.14*int3\nSN3~~.12*SN4\nPBC1~~.1*PBC2\nbeh2~~.1*beh3\n\nbeh ~ 0.506*intent + 0.185*PBC\nintent ~ 0.359*att + 0.196*SN + 0.49*PBC\n\natt~~0.32*SN\natt~~0.253*PBC\nSN~~0.196*PBC\n\"\ndf = simulateData(m, sample.nobs = 890)\ndf = as.data.frame(apply(df, 2, function(x) as.numeric(cut(x,7,labels=1:7))))\nTPB_data<-df\n# write.table(df, file = \"../../data/tpb2.txt\",sep = \"\\t\")\n# save(TPB_data, file=\"../../data/tpb2.Rdata\")\n```\n\n\n\n:::frame\n__Dataset: tpb2__  \n\nThe \"Theory of Planned Behaviour\" is a theory about why people engage in physical activity (i.e. why people exercise). \n\nThe theory is represented in the diagram in @fig-tpb (only the latent variables and not the measured items are shown). **Attitudes** refer to the extent to which a person has a favourable view of exercising; **subjective norms** refer to whether they believe others whose opinions they care about believe exercise to be a good thing; and **perceived behavioural control** refers to the extent to which they believe exercising is under their control. **Intentions** refer to whether a person intends to exercise and **behaviour** is a measure of the extent to which they exercised. Each construct is measured using four items. \n\n```{r}\n#| label: fig-tpb\n#| fig-cap: \"Theory of planned behaviour (latent variables only)\"\n#| echo: false\nknitr::include_graphics(\"images/TPB example.png\")\n```\n\nThe data are available either:  \n\n+ as a .RData file: [https://uoepsy.github.io/data/tpb2.Rdata](https://uoepsy.github.io/data/tpb2.Rdata){target=\"_blank\"}\n+ as a .txt file: [https://uoepsy.github.io/data/tpb2.txt](https://uoepsy.github.io/data/tpb2.txt){target=\"_blank\"} \n\n```{r}\n#| label: tbl-tpbdict\n#| tbl-cap: \"Data Dictionary for TPB data\"\n#| echo: false\nread_csv(\"data/tpbdictionary.csv\") |>\n  gt::gt()\n```\n\n\n:::\n\n`r qbegin(qcounter())`\nLoad in the various packages you will probably need (tidyverse, lavaan), and read in the data using the appropriate function.  \n\nWe've given you **.csv** files for a long time now, but it's good to be prepared to encounter all sorts of weird filetypes. Can you successfully read in from both types of data?  \n`r qend()` \n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nEither one or the other of:\n```{r read in data}\nlibrary(tidyverse)\nlibrary(lavaan)\nload(url(\"https://uoepsy.github.io/data/tpb2.Rdata\"))\n\nTPB_data <- read.table(\"https://uoepsy.github.io/data/tpb2.txt\", header = TRUE, sep = \"\\t\")\n```\n`r solend()`\n\n\n\n`r qbegin(qcounter())`\nBefore we test the theory of planned behaviour, we want to think about the measurement models for each of the constructs we are trying to capture.  \n\nTest separate one-factor models for each construct.  \nAre the measurement models satisfactory? *(check their fit measures)*. \n`r qend()` \n`r solbegin(\"Attitudes\",slabel=FALSE, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nHere we specify our one factor CFA model for attitudes:\n```{r}\natt_mod <- \"\n  att =~ attitude1 + attitude2 + attitude3 + attitude4\n  \"\n```\nAnd we estimate the model using `cfa()`\n```{r}\natt_mod.est <- cfa(att_mod, data=TPB_data, std.lv = TRUE)\n```\nLet's first inspect the fit measures:  \n```{r}\nfitmeasures(att_mod.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n```\nOur fit is good: RMSEA<.05, SRMR<.05, TLI>0.95 and CFI>.95.  \nWe should also check that all loadings are significant and $>|.30|$.  \nTo save space I am going to not show the entire summary output here, but just pull out the parameter estimates:  \n```{r}\nparameterestimates(att_mod.est)\n```\nThey all look good!  \n`r solend()`\n`r solbegin(\"Subjective Norms\",slabel=FALSE, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nFollowing the same logic as for the Attitudes, let's fit the CFA for Subjective norms. \nAgain, all fit measures are very good, and loadings are all significant at greater than 0.3.  \n\n```{r}\nsn_mod <- \"\n  SubjN =~ SN1 + SN2 + SN3 + SN4\n  \"\n\nsn_mod.est <- cfa(sn_mod, data=TPB_data, std.lv = TRUE)\n\nfitmeasures(sn_mod.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n\nparameterestimates(sn_mod.est)\n```\n\n\n`r solend()`\n`r solbegin(\"Perceived Behavioural Control\",slabel=FALSE, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nAll good with Perceived Behavioural Control!  \nAlmost _too_ good (TLI>1, and RMSEA is coming out at exactly 0!), but this is most probably because of this being fake data.  \nWhen data is simulated based on a specific model, then fitting that same model structure to the data will obviously fit extremely well!  s\n```{r}\npbc_mod <- \"\n  PBC =~ PBC1 + PBC2 + PBC3 + PBC4\n  \"\n\npbc_mod.est <- cfa(pbc_mod, data=TPB_data, std.lv = TRUE)\n\nfitmeasures(pbc_mod.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n\nparameterestimates(pbc_mod.est)\n```\n\n\n`r solend()`\n`r solbegin(\"Intentions\",slabel=FALSE, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nUh-oh, it's looking less good with Intentions.  \nThe loadings all look okay, but the fit indices aren't great\n```{r}\nint_mod <- \"\n  intent =~ int1 + int2 + int3 + int4 + int5\n  \"\n\nint_mod.est <- cfa(int_mod, data=TPB_data, std.lv = TRUE)\n\nfitmeasures(int_mod.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n\nparameterestimates(int_mod.est)\n```\n\nLet's examine the modification indices:\n```{r}\nmodindices(int_mod.est, sort = TRUE)\n```\n\nIt looks like correlating the residuals for items `int2` and `int4` would improve our model. The expected correlation is 0.757, which is fairly large (remember correlations are between -1 and 1).  \n\nNote that the items have a possible theoretical link too, beyond just \"intention to exercise\". It looks like both `int2` and `int4` are specifically about intentions in the _next three months_. It might make sense that responses to these two items are related more than just representing general 'intention'.  \n\nWhen we include this covariance, our model fit looks much better!  \n```{r}\nint_mod <- \"\n  intent =~ int1 + int2 + int3 + int4 + int5\n  int2 ~~ int4\n  \"\n\nint_mod.est <- cfa(int_mod, data=TPB_data, std.lv = TRUE)\n\nfitmeasures(int_mod.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n\nparameterestimates(int_mod.est)\n```\n\n`r solend()`\n`r solbegin(\"Behaviour\",slabel=FALSE, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nFinally, the behaviour model looks absolutely fine.  \nNote that `bey4` has a negative loading, which is perfectly okay. In fact, if you look at the items, you'll notice that this is the only item that is reversed (higher scores on the item reflect _less_ exercising)\n```{r}\nbeh_mod <- \"\n  behav =~ beh1 + beh2 + beh3 + beh4\n  \"\n\nbeh_mod.est <- cfa(beh_mod, data=TPB_data, std.lv = TRUE)\n\nfitmeasures(beh_mod.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n\nparameterestimates(beh_mod.est)\n```\n\n\n`r solend()`\n\n`r qbegin(qcounter())`\nUsing lavaan syntax, specify the full structural equation model that corresponds to the model in @fig-tpb. For each construct use the measurement models from the previous question.  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nThis involves specifying the measurement models for all the latent variables, and then also specifying the relationships between those latent variables. All in the same model!  \n:::\n\n\n`r qend()` \n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r specify TPB model}\nTPB_model<-'\n  # measurement models  \n  att =~ attitude1 + attitude2 + attitude3 + attitude4\n  SN =~ SN1 + SN2 + SN3 + SN4\n  PBC =~ PBC1 + PBC2 + PBC3 + PBC4\n  intent =~ int1 + int2 + int3 + int4 + int5\n  beh =~ beh1 + beh2 + beh3 + beh4\n  \n  # covariances between items\n  int2 ~~ int4\n\n  # regressions  \n  beh ~ intent + PBC\n  intent ~ att + SN + PBC\n\n  # covariances between attitudes, SN, and PBC\n  att ~~ SN    \n  att ~~ PBC\n  SN ~~ PBC\n'\n\n```\n`r solend()`\n\n`r qbegin(qcounter())`\nEstimate and evaluate the model  \n\n+ Does the model fit well?  \n+ Are the hypothesised paths significant?  \n\n`r qend()` \n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nWe can estimate the model using the `sem()` function.  \nAs with `cfa()`, by default the `sem()` function will scale the latent variables by fixing the loading of the first item for each latent variable to 1.  \n\n```{r estimate TPB_model}\nTPB_model.est<-sem(TPB_model, data=TPB_data, std.lv=TRUE)\n\nfitmeasures(TPB_model.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n```\n\nWe can see that the model fits well according to RMSEA, SRMR, TLI and CFI.  \nFrom the output below, all of the hypothesised paths in the theory of planned behaviour are statistically significant.  \n\n```{r}\nsummary(TPB_model.est, standardized=TRUE)\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nExamine the modification indices and expected parameter changes - are there any additional parameters you would consider including?  \n`r qend()` \n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r modindices}\nmodindices(TPB_model.est, sort = TRUE) |> head()\n```\n\nIn this case, none of the expected parameter changes are large enough that we would consider including any additional parameters\n`r solend()`\n\n`r qbegin(qcounter())`\nTest the indirect effect of attitudes, subjective norms, and perceived behavioural control on behaviour via intentions.  \n\nRemember, when you fit the model with `sem()`, use `se='bootstrap'` to get boostrapped standard errors (it may take a few minutes). When you inspect the model using `summary()`, get the 95% confidence intervals for parameters with `ci = TRUE`. \n`r qend()` \n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nFirst, let's name the paths in the structural equation model:\n\n```{r echo=FALSE, out.width=\"85%\"}\nknitr::include_graphics(\"images/msmr-w9.png\")\n```\n\nTo test these indirect effects we create new a parameter for each indirect effect:\n\n```{r indirect effects}\nTPB_model2 <- '\n  # measurement models  \n  att =~ attitude1 + attitude2 + attitude3 + attitude4\n  SN =~ SN1 + SN2 + SN3 + SN4\n  PBC =~ PBC1 + PBC2 + PBC3 + PBC4\n  intent =~ int1 + int2 + int3 + int4 + int5\n  beh =~ beh1 + beh2 + beh3 + beh4\n  \n  # covariances between items\n  int2 ~~ int4\n\n  # regressions  \n  beh ~ b*intent + PBC\n  intent ~ a1*att + a2*SN + a3*PBC\n\n  # covariances between attitudes, SN, and PBC\n  att ~~ SN    \n  att ~~ PBC\n  SN ~~ PBC\n\n  # indirect effects:  \n  ind1 := a1*b  #indirect effect of attitudes via intentions\n  ind2 := a2*b  #indirect effect of SN via intentions\n  ind3 := a3*b  #indirect effect of PBC via intentions\n'\n```\n\nWhen we estimate the model, we request bootstrapped standard errors: \n```{r}\n#| echo: false\n# TPB_model2.est<-sem(TPB_model2, std.lv=TRUE, se='bootstrap', data=TPB_data)\n# save(TPB_model2.est, file=\"data/tpb_sem.Rdata\")\nload(\"data/tpb_sem.Rdata\")\n```\n```{r estimate model 2}\n#| eval: false\nTPB_model2.est<-sem(TPB_model2, std.lv=TRUE, se='bootstrap', data=TPB_data)\n```\n\nWhen we inspect the model, we request the 95% confidence intervals for parameters: \n\n```{r summarise model 2}\nsummary(TPB_model2.est, ci=TRUE)\n```\n\nWe can see that all of the indirect effects are statistically significant at p<.05 as none of the 95% confidence intervals for the coefficients include zero.\n`r solend()`\n\n`r qbegin(qcounter())`\nWrite up your analysis as if you were presenting the work in academic paper, with brief separate 'Method' and 'Results' sections\n`r qend()` \n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n**Method**\n\nWe tested a theory of planned behaviour model of physical activity by fitting a structural equation model in which attitudes, subjective norms, perceived behavioural control, intentions and behaviour were latent variables defined by four items. We first tested the measurement models for each construct by fitting a one-factor CFA model.  Latent variable scaling was by fixing the loading of the first item for each construct to 1. \n\nWithin the SEM, behaviour was regressed on intentions and perceived behavioural control and intentions were regressed on attitudes, subjective norms, and perceived behavioiural control. In addition, attitudes, subjective norms, and perceived behavioural control were allowed to covary. The indirect effects of attitudes, subjective norms and perceived behavioural control on behaviour were calculated as the product of the effect of the relevant predictor on the mediator (intentions) and the effect of the mediator on the outcome. The statistical significance of the indirect effects were evaluated using bootstrapped 95% confidence intervals with 1000 resamples.\n\nIn all cases models were fit using maximum likelihood estimation and model fit was judged to be good if CFI and TLI were $>.95$ and RMSEA and SRMR were $<.05$. Modification indices and expected parameter changes were inspected to identify any areas of local mis-fit but model modifications were only made if they could be justified on substantive grounds.\n\n**Results**\n\nAll measurement models fit well (CFI and TLI $>.95$ and RMSEA and SRMR $<.05$) with the exception of the measurement model for intentions. Modification indices suggested the inclusion of residual covariance between two items on the intentions scale (int2 and int4) that both made specific reference to short term intentions. The addition of this parameter resulted in a good fit. \nThe full structural equation model (with the residual covariance between int2 and int4 included) fit well (CFI = `r round(fitmeasures(TPB_model2.est)[\"cfi\"],2)`, TLI = `r round(fitmeasures(TPB_model2.est)[\"tli\"],2)`, RMSEA = `r round(fitmeasures(TPB_model2.est)[\"rmsea\"],2)`, SRMR = `r round(fitmeasures(TPB_model2.est)[\"srmr\"],2)`). Unstandardised parameter estimates are provided in @tbl-tabsem. All of the hypothesised paths  were statistically significant at $p<.05$. Significant indirect effects suggested that intentions mediate the effects of attitudes, subjective norms, and  perceived behavioural control on behaviour whilst perceived behavioural control also has a direct effect on behaviour. Results thus provide support for a theory of planned behaviour model of physical activity. \n\n```{r}\n#| echo: false\n#| label: tbl-tabsem\n#| tbl-cap: \"Unstandardised parameter estimates for structural equation model for a theory of planned behaviour model of physical activity. Note: PBC = Perceived Behavioural Control, CI = Confidence Interval\"\nlibrary(gt)\nparameterestimates(TPB_model2.est) |>\n  mutate(\n    lhs = case_when(\n      lhs == \"att\" ~ \"Attitudes\",\n      lhs == \"SN\" ~ \"Subjective Norms\",\n      lhs == \"intent\" ~ \"Intentions\",\n      lhs == \"beh\" ~ \"Behaviours\",\n      TRUE ~ lhs\n    ),\n    rhs = case_when(\n      rhs == \"att\" ~ \"Attitudes\",\n      rhs == \"SN\" ~ \"Subjective Norms\",\n      rhs == \"intent\" ~ \"Intentions\",\n      rhs == \"beh\" ~ \"Behaviours\",\n      TRUE ~ rhs\n    ),\n    Parameter = case_when(\n      op == \"=~\" ~ rhs,\n      op == \"~~\" ~ paste0(lhs,\" with \",rhs),\n      op == \"~\" ~ paste0(lhs,\" on \",rhs),\n      rhs == \"a1*b\" ~ \"Attitudes via Intentions\",\n      rhs == \"a2*b\" ~ \"Subjective Norms via Intentions\",\n      rhs == \"a3*b\" ~ \"PBC via Intentions\",\n      TRUE ~ \"\"\n    ),\n    LV = case_when(\n      op == \"=~\" & rhs == \"attitude1\" ~ \"Attitudes\",\n      op == \"=~\" & rhs == \"SN1\" ~ \"Subjective Norms\",\n      op == \"=~\" & rhs == \"PBC1\" ~ \"PBC\",\n      op == \"=~\" & rhs == \"int1\" ~ \"Intentions\",\n      op == \"=~\" & rhs == \"beh1\" ~ \"Behaviours\",\n      TRUE ~ \"\"\n    ),\n    what = case_when(\n      op == \"=~\" ~ \"Loadings\",\n      op == \"~~\" ~ \"Covariances\",\n      op == \"~\" ~ \"Regressions\",\n      op == \":=\" ~ \"Indirect effects\",\n      TRUE ~ \"\"\n    )\n) |>\n  filter(!(op==\"~~\" & (lhs==rhs))) |>\n  transmute(\n    what, ` `=LV, Parameter,\n    Estimate = round(est,2),\n    SE = round(se,2),\n    z = round(z,2),\n    p = format.pval(pvalue,eps=.001,digits=3),\n    `95% CI` = paste0(\"[\",round(ci.lower,2),\", \",round(ci.upper,2),\"]\")\n  ) |> group_by(what) |> gt() |>\n  tab_style(\n    style = cell_fill(color = \"gray85\"),\n    locations = cells_row_groups()\n  ) |> \n  opt_stylize(style = 6, color = 'gray')\n```\n\n\n`r solend()`\n\n","srcMarkdownNoYaml":"\n\n```{r}\n#| label: setup\n#| include: false\nsource('assets/setup.R')\nlibrary(xaringanExtra)\nlibrary(tidyverse)\nlibrary(patchwork)\nxaringanExtra::use_panelset()\nqcounter <- function(){\n  if(!exists(\"qcounter_i\")){\n    qcounter_i <<- 1\n  }else{\n    qcounter_i <<- qcounter_i + 1\n  }\n  qcounter_i\n}\nlibrary(psych)\nlibrary(semPlot)\nlibrary(lavaan)\n```\n\n\n::: {.callout-note collapse=\"true\"}\n#### Measurement Error and the need for SEM\n\nYou have probably heard the term \"Structural Equation Modelling (SEM)\" for a few weeks now, but we haven't been very clear on what exactly it is. Is it CFA? Is it Path Analysis? In fact it is both - it is the overarching framework of which CFA and Path Analysis are just particular cases. The beauty comes in when we put the CFA and Path Analysis approaches together.\n\nPath analysis, as we saw last week, offers a way of specifying and evaluating a *structural* model, in which variables relate to one another in various ways, via different (sometimes indirect) paths. Common models like our old friend multiple regression can be expressed in a Path Analysis framework.\n\nFactor Analysis, on the other hand, brings something absolutely crucial to the table - it allows us to mitigate some of the problems which are associated with measurement error by specifying the existence of some latent variable which is measured via some observed variables. No question can perfectly measure someone's level of \"anxiety\", but if we take a set of 10 carefully chosen questions, we can consider the shared covariance between those 10 questions to represent the construct that is common between all of them (they all ask, in different ways, about \"anxiety\"), also modeling the unique error with which each individual question fails to perfectly represent the entire construct.  \n\nCombine them and we can reap the rewards of having both a *structural model* and a *measurement model*. The measurement model is our specification between the items we directly observed, and the latent variables of which we consider these items to be manifestations. The structural model is our specified model of the relationships between the latent variables.  \n\n\n```{r}\n#| label: fig-semmdiag\n#| fig-cap: \"SEM diagram. Measurement model in orange, Structural model in purple\"\n#| echo: false\nknitr::include_graphics(\"images/semdiag2.png\")\n```\n\n:::frame\n__You can't test the structural model if the measurement model is bad__  \n\nIf you test the relationships between a set of latent factors, and they are not reliably measured by the observed items, then this error propagates up to influence the fit of the structural model.  \nTo test the measurement model, it is typical to *saturate* the structural model (i.e., allow all the latent variables to correlate with one another). This way any misfit is due to the measurement model only.  \n\nAlternatively, we can fit individual CFA models for each construct and assess their fit (making any reasonable adjustments if necessary) prior to then fitting the full SEM.\n\n:::\n\n:::\n\n# Exercising Exercises\n\n```{r}\n#| include: false\nset.seed(235)\nm = \"\natt =~ 0.689*attitude1+0.726*attitude2+0.689*attitude3+0.719*attitude4\nSN =~ 0.661*SN1+0.651*SN2+0.616*SN3+0.638*SN4\nPBC =~ 0.799*PBC1+0.772*PBC2+0.756*PBC3+0.773*PBC4\nintent =~ 0.584*int1+0.646*int2+0.625*int3+0.597*int4+0.6*int5\nbeh =~ 0.649*beh1+0.599*beh2+0.588*beh3+-0.605*beh4\n\nint2~~.4*int4\nint1~~.14*int3\nSN3~~.12*SN4\nPBC1~~.1*PBC2\nbeh2~~.1*beh3\n\nbeh ~ 0.506*intent + 0.185*PBC\nintent ~ 0.359*att + 0.196*SN + 0.49*PBC\n\natt~~0.32*SN\natt~~0.253*PBC\nSN~~0.196*PBC\n\"\ndf = simulateData(m, sample.nobs = 890)\ndf = as.data.frame(apply(df, 2, function(x) as.numeric(cut(x,7,labels=1:7))))\nTPB_data<-df\n# write.table(df, file = \"../../data/tpb2.txt\",sep = \"\\t\")\n# save(TPB_data, file=\"../../data/tpb2.Rdata\")\n```\n\n\n\n:::frame\n__Dataset: tpb2__  \n\nThe \"Theory of Planned Behaviour\" is a theory about why people engage in physical activity (i.e. why people exercise). \n\nThe theory is represented in the diagram in @fig-tpb (only the latent variables and not the measured items are shown). **Attitudes** refer to the extent to which a person has a favourable view of exercising; **subjective norms** refer to whether they believe others whose opinions they care about believe exercise to be a good thing; and **perceived behavioural control** refers to the extent to which they believe exercising is under their control. **Intentions** refer to whether a person intends to exercise and **behaviour** is a measure of the extent to which they exercised. Each construct is measured using four items. \n\n```{r}\n#| label: fig-tpb\n#| fig-cap: \"Theory of planned behaviour (latent variables only)\"\n#| echo: false\nknitr::include_graphics(\"images/TPB example.png\")\n```\n\nThe data are available either:  \n\n+ as a .RData file: [https://uoepsy.github.io/data/tpb2.Rdata](https://uoepsy.github.io/data/tpb2.Rdata){target=\"_blank\"}\n+ as a .txt file: [https://uoepsy.github.io/data/tpb2.txt](https://uoepsy.github.io/data/tpb2.txt){target=\"_blank\"} \n\n```{r}\n#| label: tbl-tpbdict\n#| tbl-cap: \"Data Dictionary for TPB data\"\n#| echo: false\nread_csv(\"data/tpbdictionary.csv\") |>\n  gt::gt()\n```\n\n\n:::\n\n`r qbegin(qcounter())`\nLoad in the various packages you will probably need (tidyverse, lavaan), and read in the data using the appropriate function.  \n\nWe've given you **.csv** files for a long time now, but it's good to be prepared to encounter all sorts of weird filetypes. Can you successfully read in from both types of data?  \n`r qend()` \n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nEither one or the other of:\n```{r read in data}\nlibrary(tidyverse)\nlibrary(lavaan)\nload(url(\"https://uoepsy.github.io/data/tpb2.Rdata\"))\n\nTPB_data <- read.table(\"https://uoepsy.github.io/data/tpb2.txt\", header = TRUE, sep = \"\\t\")\n```\n`r solend()`\n\n\n\n`r qbegin(qcounter())`\nBefore we test the theory of planned behaviour, we want to think about the measurement models for each of the constructs we are trying to capture.  \n\nTest separate one-factor models for each construct.  \nAre the measurement models satisfactory? *(check their fit measures)*. \n`r qend()` \n`r solbegin(\"Attitudes\",slabel=FALSE, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nHere we specify our one factor CFA model for attitudes:\n```{r}\natt_mod <- \"\n  att =~ attitude1 + attitude2 + attitude3 + attitude4\n  \"\n```\nAnd we estimate the model using `cfa()`\n```{r}\natt_mod.est <- cfa(att_mod, data=TPB_data, std.lv = TRUE)\n```\nLet's first inspect the fit measures:  \n```{r}\nfitmeasures(att_mod.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n```\nOur fit is good: RMSEA<.05, SRMR<.05, TLI>0.95 and CFI>.95.  \nWe should also check that all loadings are significant and $>|.30|$.  \nTo save space I am going to not show the entire summary output here, but just pull out the parameter estimates:  \n```{r}\nparameterestimates(att_mod.est)\n```\nThey all look good!  \n`r solend()`\n`r solbegin(\"Subjective Norms\",slabel=FALSE, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nFollowing the same logic as for the Attitudes, let's fit the CFA for Subjective norms. \nAgain, all fit measures are very good, and loadings are all significant at greater than 0.3.  \n\n```{r}\nsn_mod <- \"\n  SubjN =~ SN1 + SN2 + SN3 + SN4\n  \"\n\nsn_mod.est <- cfa(sn_mod, data=TPB_data, std.lv = TRUE)\n\nfitmeasures(sn_mod.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n\nparameterestimates(sn_mod.est)\n```\n\n\n`r solend()`\n`r solbegin(\"Perceived Behavioural Control\",slabel=FALSE, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nAll good with Perceived Behavioural Control!  \nAlmost _too_ good (TLI>1, and RMSEA is coming out at exactly 0!), but this is most probably because of this being fake data.  \nWhen data is simulated based on a specific model, then fitting that same model structure to the data will obviously fit extremely well!  s\n```{r}\npbc_mod <- \"\n  PBC =~ PBC1 + PBC2 + PBC3 + PBC4\n  \"\n\npbc_mod.est <- cfa(pbc_mod, data=TPB_data, std.lv = TRUE)\n\nfitmeasures(pbc_mod.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n\nparameterestimates(pbc_mod.est)\n```\n\n\n`r solend()`\n`r solbegin(\"Intentions\",slabel=FALSE, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nUh-oh, it's looking less good with Intentions.  \nThe loadings all look okay, but the fit indices aren't great\n```{r}\nint_mod <- \"\n  intent =~ int1 + int2 + int3 + int4 + int5\n  \"\n\nint_mod.est <- cfa(int_mod, data=TPB_data, std.lv = TRUE)\n\nfitmeasures(int_mod.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n\nparameterestimates(int_mod.est)\n```\n\nLet's examine the modification indices:\n```{r}\nmodindices(int_mod.est, sort = TRUE)\n```\n\nIt looks like correlating the residuals for items `int2` and `int4` would improve our model. The expected correlation is 0.757, which is fairly large (remember correlations are between -1 and 1).  \n\nNote that the items have a possible theoretical link too, beyond just \"intention to exercise\". It looks like both `int2` and `int4` are specifically about intentions in the _next three months_. It might make sense that responses to these two items are related more than just representing general 'intention'.  \n\nWhen we include this covariance, our model fit looks much better!  \n```{r}\nint_mod <- \"\n  intent =~ int1 + int2 + int3 + int4 + int5\n  int2 ~~ int4\n  \"\n\nint_mod.est <- cfa(int_mod, data=TPB_data, std.lv = TRUE)\n\nfitmeasures(int_mod.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n\nparameterestimates(int_mod.est)\n```\n\n`r solend()`\n`r solbegin(\"Behaviour\",slabel=FALSE, show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nFinally, the behaviour model looks absolutely fine.  \nNote that `bey4` has a negative loading, which is perfectly okay. In fact, if you look at the items, you'll notice that this is the only item that is reversed (higher scores on the item reflect _less_ exercising)\n```{r}\nbeh_mod <- \"\n  behav =~ beh1 + beh2 + beh3 + beh4\n  \"\n\nbeh_mod.est <- cfa(beh_mod, data=TPB_data, std.lv = TRUE)\n\nfitmeasures(beh_mod.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n\nparameterestimates(beh_mod.est)\n```\n\n\n`r solend()`\n\n`r qbegin(qcounter())`\nUsing lavaan syntax, specify the full structural equation model that corresponds to the model in @fig-tpb. For each construct use the measurement models from the previous question.  \n\n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nThis involves specifying the measurement models for all the latent variables, and then also specifying the relationships between those latent variables. All in the same model!  \n:::\n\n\n`r qend()` \n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n```{r specify TPB model}\nTPB_model<-'\n  # measurement models  \n  att =~ attitude1 + attitude2 + attitude3 + attitude4\n  SN =~ SN1 + SN2 + SN3 + SN4\n  PBC =~ PBC1 + PBC2 + PBC3 + PBC4\n  intent =~ int1 + int2 + int3 + int4 + int5\n  beh =~ beh1 + beh2 + beh3 + beh4\n  \n  # covariances between items\n  int2 ~~ int4\n\n  # regressions  \n  beh ~ intent + PBC\n  intent ~ att + SN + PBC\n\n  # covariances between attitudes, SN, and PBC\n  att ~~ SN    \n  att ~~ PBC\n  SN ~~ PBC\n'\n\n```\n`r solend()`\n\n`r qbegin(qcounter())`\nEstimate and evaluate the model  \n\n+ Does the model fit well?  \n+ Are the hypothesised paths significant?  \n\n`r qend()` \n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\nWe can estimate the model using the `sem()` function.  \nAs with `cfa()`, by default the `sem()` function will scale the latent variables by fixing the loading of the first item for each latent variable to 1.  \n\n```{r estimate TPB_model}\nTPB_model.est<-sem(TPB_model, data=TPB_data, std.lv=TRUE)\n\nfitmeasures(TPB_model.est)[c(\"rmsea\",\"srmr\",\"tli\",\"cfi\")]\n```\n\nWe can see that the model fits well according to RMSEA, SRMR, TLI and CFI.  \nFrom the output below, all of the hypothesised paths in the theory of planned behaviour are statistically significant.  \n\n```{r}\nsummary(TPB_model.est, standardized=TRUE)\n```\n\n`r solend()`\n\n`r qbegin(qcounter())`\nExamine the modification indices and expected parameter changes - are there any additional parameters you would consider including?  \n`r qend()` \n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n```{r modindices}\nmodindices(TPB_model.est, sort = TRUE) |> head()\n```\n\nIn this case, none of the expected parameter changes are large enough that we would consider including any additional parameters\n`r solend()`\n\n`r qbegin(qcounter())`\nTest the indirect effect of attitudes, subjective norms, and perceived behavioural control on behaviour via intentions.  \n\nRemember, when you fit the model with `sem()`, use `se='bootstrap'` to get boostrapped standard errors (it may take a few minutes). When you inspect the model using `summary()`, get the 95% confidence intervals for parameters with `ci = TRUE`. \n`r qend()` \n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\nFirst, let's name the paths in the structural equation model:\n\n```{r echo=FALSE, out.width=\"85%\"}\nknitr::include_graphics(\"images/msmr-w9.png\")\n```\n\nTo test these indirect effects we create new a parameter for each indirect effect:\n\n```{r indirect effects}\nTPB_model2 <- '\n  # measurement models  \n  att =~ attitude1 + attitude2 + attitude3 + attitude4\n  SN =~ SN1 + SN2 + SN3 + SN4\n  PBC =~ PBC1 + PBC2 + PBC3 + PBC4\n  intent =~ int1 + int2 + int3 + int4 + int5\n  beh =~ beh1 + beh2 + beh3 + beh4\n  \n  # covariances between items\n  int2 ~~ int4\n\n  # regressions  \n  beh ~ b*intent + PBC\n  intent ~ a1*att + a2*SN + a3*PBC\n\n  # covariances between attitudes, SN, and PBC\n  att ~~ SN    \n  att ~~ PBC\n  SN ~~ PBC\n\n  # indirect effects:  \n  ind1 := a1*b  #indirect effect of attitudes via intentions\n  ind2 := a2*b  #indirect effect of SN via intentions\n  ind3 := a3*b  #indirect effect of PBC via intentions\n'\n```\n\nWhen we estimate the model, we request bootstrapped standard errors: \n```{r}\n#| echo: false\n# TPB_model2.est<-sem(TPB_model2, std.lv=TRUE, se='bootstrap', data=TPB_data)\n# save(TPB_model2.est, file=\"data/tpb_sem.Rdata\")\nload(\"data/tpb_sem.Rdata\")\n```\n```{r estimate model 2}\n#| eval: false\nTPB_model2.est<-sem(TPB_model2, std.lv=TRUE, se='bootstrap', data=TPB_data)\n```\n\nWhen we inspect the model, we request the 95% confidence intervals for parameters: \n\n```{r summarise model 2}\nsummary(TPB_model2.est, ci=TRUE)\n```\n\nWe can see that all of the indirect effects are statistically significant at p<.05 as none of the 95% confidence intervals for the coefficients include zero.\n`r solend()`\n\n`r qbegin(qcounter())`\nWrite up your analysis as if you were presenting the work in academic paper, with brief separate 'Method' and 'Results' sections\n`r qend()` \n`r solbegin(show=params$SHOW_SOLS, toggle=params$TOGGLE)`\n\n**Method**\n\nWe tested a theory of planned behaviour model of physical activity by fitting a structural equation model in which attitudes, subjective norms, perceived behavioural control, intentions and behaviour were latent variables defined by four items. We first tested the measurement models for each construct by fitting a one-factor CFA model.  Latent variable scaling was by fixing the loading of the first item for each construct to 1. \n\nWithin the SEM, behaviour was regressed on intentions and perceived behavioural control and intentions were regressed on attitudes, subjective norms, and perceived behavioiural control. In addition, attitudes, subjective norms, and perceived behavioural control were allowed to covary. The indirect effects of attitudes, subjective norms and perceived behavioural control on behaviour were calculated as the product of the effect of the relevant predictor on the mediator (intentions) and the effect of the mediator on the outcome. The statistical significance of the indirect effects were evaluated using bootstrapped 95% confidence intervals with 1000 resamples.\n\nIn all cases models were fit using maximum likelihood estimation and model fit was judged to be good if CFI and TLI were $>.95$ and RMSEA and SRMR were $<.05$. Modification indices and expected parameter changes were inspected to identify any areas of local mis-fit but model modifications were only made if they could be justified on substantive grounds.\n\n**Results**\n\nAll measurement models fit well (CFI and TLI $>.95$ and RMSEA and SRMR $<.05$) with the exception of the measurement model for intentions. Modification indices suggested the inclusion of residual covariance between two items on the intentions scale (int2 and int4) that both made specific reference to short term intentions. The addition of this parameter resulted in a good fit. \nThe full structural equation model (with the residual covariance between int2 and int4 included) fit well (CFI = `r round(fitmeasures(TPB_model2.est)[\"cfi\"],2)`, TLI = `r round(fitmeasures(TPB_model2.est)[\"tli\"],2)`, RMSEA = `r round(fitmeasures(TPB_model2.est)[\"rmsea\"],2)`, SRMR = `r round(fitmeasures(TPB_model2.est)[\"srmr\"],2)`). Unstandardised parameter estimates are provided in @tbl-tabsem. All of the hypothesised paths  were statistically significant at $p<.05$. Significant indirect effects suggested that intentions mediate the effects of attitudes, subjective norms, and  perceived behavioural control on behaviour whilst perceived behavioural control also has a direct effect on behaviour. Results thus provide support for a theory of planned behaviour model of physical activity. \n\n```{r}\n#| echo: false\n#| label: tbl-tabsem\n#| tbl-cap: \"Unstandardised parameter estimates for structural equation model for a theory of planned behaviour model of physical activity. Note: PBC = Perceived Behavioural Control, CI = Confidence Interval\"\nlibrary(gt)\nparameterestimates(TPB_model2.est) |>\n  mutate(\n    lhs = case_when(\n      lhs == \"att\" ~ \"Attitudes\",\n      lhs == \"SN\" ~ \"Subjective Norms\",\n      lhs == \"intent\" ~ \"Intentions\",\n      lhs == \"beh\" ~ \"Behaviours\",\n      TRUE ~ lhs\n    ),\n    rhs = case_when(\n      rhs == \"att\" ~ \"Attitudes\",\n      rhs == \"SN\" ~ \"Subjective Norms\",\n      rhs == \"intent\" ~ \"Intentions\",\n      rhs == \"beh\" ~ \"Behaviours\",\n      TRUE ~ rhs\n    ),\n    Parameter = case_when(\n      op == \"=~\" ~ rhs,\n      op == \"~~\" ~ paste0(lhs,\" with \",rhs),\n      op == \"~\" ~ paste0(lhs,\" on \",rhs),\n      rhs == \"a1*b\" ~ \"Attitudes via Intentions\",\n      rhs == \"a2*b\" ~ \"Subjective Norms via Intentions\",\n      rhs == \"a3*b\" ~ \"PBC via Intentions\",\n      TRUE ~ \"\"\n    ),\n    LV = case_when(\n      op == \"=~\" & rhs == \"attitude1\" ~ \"Attitudes\",\n      op == \"=~\" & rhs == \"SN1\" ~ \"Subjective Norms\",\n      op == \"=~\" & rhs == \"PBC1\" ~ \"PBC\",\n      op == \"=~\" & rhs == \"int1\" ~ \"Intentions\",\n      op == \"=~\" & rhs == \"beh1\" ~ \"Behaviours\",\n      TRUE ~ \"\"\n    ),\n    what = case_when(\n      op == \"=~\" ~ \"Loadings\",\n      op == \"~~\" ~ \"Covariances\",\n      op == \"~\" ~ \"Regressions\",\n      op == \":=\" ~ \"Indirect effects\",\n      TRUE ~ \"\"\n    )\n) |>\n  filter(!(op==\"~~\" & (lhs==rhs))) |>\n  transmute(\n    what, ` `=LV, Parameter,\n    Estimate = round(est,2),\n    SE = round(se,2),\n    z = round(z,2),\n    p = format.pval(pvalue,eps=.001,digits=3),\n    `95% CI` = paste0(\"[\",round(ci.lower,2),\", \",round(ci.upper,2),\"]\")\n  ) |> group_by(what) |> gt() |>\n  tab_style(\n    style = cell_fill(color = \"gray85\"),\n    locations = cells_row_groups()\n  ) |> \n  opt_stylize(style = 6, color = 'gray')\n```\n\n\n`r solend()`\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"include-in-header":["assets/toggling.html"],"number-sections":false,"output-file":"10ex.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","toc_float":true,"link-citations":true,"theme":["united","assets/style-labs.scss"],"title":"Week 10 Exercises: Structural Equation Modelling (SEM)","params":{"SHOW_SOLS":false,"TOGGLE":true},"editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}