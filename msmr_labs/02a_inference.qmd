---
title: "Inference for LMM"
params: 
    SHOW_SOLS: FALSE
    TOGGLE: TRUE
editor_options: 
  chunk_output_type: console
---

```{r}
#| label: setup
#| include: false
source('assets/setup.R')
library(xaringanExtra)
library(tidyverse)
library(patchwork)
xaringanExtra::use_panelset()
```


# Inference

SE, p-vals/confints


# Inference in LM

SE calc
F/t distribution ddf

test of coefficient vs model comparison 


# Inference in LMM

ddf

in a perfectly balanced design, then we can calculate ddf for F

mi = nr of groups at level i
mim1 = nr of groups as level i-1 (**higher** level)
pi = df for terms at level i
ddf_i = mi - (mim1 + pi)

SE = derived via ML/REML (not SS resid)

## wald t (balanced only)


## df approximations

satterthwaite

kr 
```{r}
#| eval: false
# ddf ----
d3=slice_sample(d3,prop=.78)
m0 =lmer(ACE ~ visit + condition + (1+visit|ppt), d3,REML=F)
m0r =lmer(ACE ~ visit + condition + (1+visit|ppt), d3,REML=T)
m1 =lmer(ACE ~ visit * condition + (1+visit|ppt), d3,REML=F)
m1r =lmer(ACE ~ visit * condition + (1+visit|ppt), d3,REML=T)
SATmodcomp(m1,m0) # refits with REML
SATmodcomp(m1r,m0r) # refits with REML
KRmodcomp(m1,m0) # refits with REML
KRmodcomp(m1r,m0r) # refits with REML


SATmodcomp(m1,m0) # refits with REML
KRmodcomp(m1,m0) # refits with REML

parameters::model_parameters(m1, ci_method="kr")
# CIs computed via REML, estimates, t, p not unless initial model fitted with REML
parameters::model_parameters(m1r,ci_method="sat")
# CIs computed via REML, estimates, t, p not unless initial model fitted with REML
```

## likelihood based

profile likelihood

lrt


## parametric bootstrap












