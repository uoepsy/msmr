<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Logistic Multilevel Models</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-chevron-circle-right')) {
    f.classList.add('fa-chevron-circle-down')
    f.classList.remove('fa-chevron-circle-right')
} else {
    f.classList.add('fa-chevron-circle-right')
    f.classList.remove('fa-chevron-circle-down')
}
}
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="assets/style-labs.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><strong>MSMR</strong></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Mixed Effects Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01_intromlm.html">1: Introduction to Multilevel Models</a>
    </li>
    <li>
      <a href="02_lmm_log.html">2: Logistic Multilevel Models</a>
    </li>
    <li>
      <a href="03_nonlin.html">3: Longitudinal Nonlinear Models</a>
    </li>
    <li>
      <a href="04_ranef.html">4: Random Effect Structures</a>
    </li>
    <li>
      <a href="05_multilevel_recap.html">5: Multilevel Modelling Recap</a>
    </li>
    <li class="dropdown-header">FLW: Flexible Learning Week</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data Reduction &amp; SEM
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="06_efapca.html">6: PCA | EFA</a>
    </li>
    <li>
      <a href="07_cfa.html">7: CFA</a>
    </li>
    <li>
      <a href="08_path.html">8: Path Analysis</a>
    </li>
    <li>
      <a href="09_sem1.html">9: SEM 1</a>
    </li>
    <li>
      <a href="10_sem2.html">10: SEM 2</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-info-circle"></span>
     
    Extras
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="zz_tidyverse_markdown.html">Tidyverse &amp; Markdown Recap</a>
    </li>
    <li>
      <a href="zz_binary_binomial.html">Binary vs Binomial Data</a>
    </li>
    <li>
      <a href="zz_quickcontrasts.html">Contrasts: a Quick Overview</a>
    </li>
    <li>
      <a href="zz_lvp.html">Likelihood vs Probability</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Logistic Multilevel Models</h1>

</div>


<div class="blue">
<p><strong>Preliminaries</strong></p>
<ol style="list-style-type: decimal">
<li><p>Open Rstudio, create a new R script or RMarkdown document (whichever you prefer working with) and give it a title for this week.</p></li>
<li><p>Load any of the packages you think you might be using today.<br />
By now you may have started get into a sort of routine with R, and you might know what functions you like, and which you don’t. Because there are so many alternatives for doing the same thing, the packages and functions you use are very much up to you.<br />
If I’m planning on doing some multilevel modelling, I will tend to load these by default at the top:</p>
<pre class="r"><code>library(tidyverse) # for everything
library(lme4) # for fitting models
library(broom.mixed) # for tidying model output</code></pre></li>
</ol>
</div>
<div id="exercises" class="section level1">
<h1>Exercises</h1>
<div class="rtip">
<p><strong>lmer() &gt;&gt; glmer()</strong></p>
<p>Remember how we simply used <code>glm()</code> and could specify the <code>family = "binomial"</code> in order to fit a logistic regression? Well it’s much the same thing for multi-level models!</p>
<ul>
<li>Gaussian model:
<ul>
<li><code>lmer(y ~ x1 + x2 + (1 | g), data = data)</code><br />
</li>
</ul></li>
<li>Binomial model:
<ul>
<li><code>glmer(y ~ x1 + x2 + (1 | g), data = data, family = binomial(link='logit'))</code><br>or</li>
<li><code>glmer(y ~ x1 + x2 + (1 | g), data = data, family = "binomial")</code><br>or</li>
<li><code>glmer(y ~ x1 + x2 + (1 | g), data = data, family = binomial)</code></li>
</ul></li>
</ul>
<p>For more on Binary vs Binomial, see this <a href="zz_binary_binomial.html">in depth section</a>.</p>
</div>
<div class="frame">
<p><strong>Novel Word Learning: Data Codebook</strong></p>
<pre class="r"><code>load(url(&quot;https://uoepsy.github.io/msmr/data/nwl.RData&quot;))</code></pre>
<p>In the <code>nwl</code> data set (accessed using the code above), participants with aphasia are separated into two groups based on the general location of their brain lesion: anterior vs. posterior. There is data on the numbers of correct and incorrect responses participants gave in each of a series of experimental blocks. There were 7 learning blocks, immediately followed by a test. Finally, participants also completed a follow-up test.
<br>
Data were also collect from healthy controls.
<br>
Figure <a href="#fig:nwl-fig">1</a> shows the differences between lesion location groups in the average proportion of correct responses at each point in time (i.e., each block, test, and follow-up)</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:nwl-fig"></span>
<img src="02_lmm_log_files/figure-html/nwl-fig-1.png" alt="Differences between groups in the average proportion of correct responses at each block" width="80%" />
<p class="caption">
Figure 1: Differences between groups in the average proportion of correct responses at each block
</p>
</div>
<table>
<colgroup>
<col width="9%" />
<col width="90%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">variable</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">group</td>
<td align="left">Whether participant is a stroke patient (‘patient’) or a healthy control (‘control’)</td>
</tr>
<tr class="even">
<td align="left">lesion_location</td>
<td align="left">Location of brain lesion: anterior vs posterior</td>
</tr>
<tr class="odd">
<td align="left">block</td>
<td align="left">Experimental block (1-9). Blocks 1-7 were learning blocks, immediately followed by a test in block 8. Block 9 was a follow-up test at a later point</td>
</tr>
<tr class="even">
<td align="left">PropCorrect</td>
<td align="left">Proportion of 30 responses in a given block that the participant got correct</td>
</tr>
<tr class="odd">
<td align="left">NumCorrect</td>
<td align="left">Number of responses (out of 30) in a given block that the participant got correct</td>
</tr>
<tr class="even">
<td align="left">NumError</td>
<td align="left">Number of responses (out of 30) in a given block that the participant got incorrect</td>
</tr>
<tr class="odd">
<td align="left">ID</td>
<td align="left">Participant Identifier</td>
</tr>
<tr class="even">
<td align="left">Phase</td>
<td align="left">Experimental phase, corresponding to experimental block(s): ‘Learning’, ‘Immediate’,‘Follow-up’</td>
</tr>
</tbody>
</table>
</div>
<div class="question-begin">
Question A1
</div>
<div class="question-body">
<p>Load the data. Take a look around. Any missing values? Can you think of why?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-17" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-17&#39;, &#39;sol-start-17&#39;)"> Solution </span>
</div>
<div id="sol-body-17" class="solution-body" style="display: none;">
<pre class="r"><code>load(url(&quot;https://uoepsy.github.io/msmr/data/nwl.RData&quot;))
summary(nwl)</code></pre>
<pre><code>##      group      lesion_location     block    PropCorrect       NumCorrect   
##  control:126   anterior : 45    Min.   :1   Min.   :0.2000   Min.   : 6.00  
##  patient:117   posterior: 63    1st Qu.:3   1st Qu.:0.5333   1st Qu.:16.00  
##                NA&#39;s     :135    Median :5   Median :0.7000   Median :21.00  
##                                 Mean   :5   Mean   :0.6822   Mean   :20.47  
##                                 3rd Qu.:7   3rd Qu.:0.8333   3rd Qu.:25.00  
##                                 Max.   :9   Max.   :1.0000   Max.   :30.00  
##                                                                             
##     NumError              ID         Phase          
##  Min.   : 0.000   control1 :  9   Length:243        
##  1st Qu.: 5.000   control10:  9   Class :character  
##  Median : 9.000   control11:  9   Mode  :character  
##  Mean   : 9.535   control12:  9                     
##  3rd Qu.:14.000   control13:  9                     
##  Max.   :24.000   control14:  9                     
##                   (Other)  :189</code></pre>
<p>The only missing vales are in the lesion location, and it’s probably because the healthy controls don’t have any lesions. There may also be a few patients for which the lesion_location is missing, but this should be comparatively fewer values compared to controls.</p>
<p>The following command creates a two-way frequency table showing the number of controls or patients by lesion location, confirming that controls only have missing values (NAs) and only 9 patients have missing values:</p>
<pre class="r"><code>table(nwl$group, nwl$lesion_location, useNA = &quot;ifany&quot;)</code></pre>
<pre><code>##          
##           anterior posterior &lt;NA&gt;
##   control        0         0  126
##   patient       45        63    9</code></pre>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A2
</div>
<div class="question-body">
<p>Our broader research aim today is to compare the two lesion location groups (those with anterior vs. posterior lesions) with respect to their accuracy of responses over the course of the study.</p>
<ul>
<li>What is the outcome variable?</li>
</ul>
<p><em>Hint:</em> Think carefully: there might be several variables which either fully or partly express the information we are considering the “outcome” here.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-18" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-18&#39;, &#39;sol-start-18&#39;)"> Solution </span>
</div>
<div id="sol-body-18" class="solution-body" style="display: none;">
<p>The outcome here is (in words) the proportion of correct answers or, equivalently, the probability of answering correctly. A proportion/probability can only vary between 0 and 1 and, as such, we cannot use traditional linear regression or we could end up with predictions outside of the [0, 1] range.</p>
<p>As said, the outcome is the proportion of correct answers in each block. This makes it tempting to look at the variable called <code>PropCorrect</code>, but this is encoded as a proportion. We have learned to use logistic models, but these require either:</p>
<ul>
<li>a binary outcome variable, where the values are 0s or 1s</li>
<li>a binomial outcome variable, where the values are aggregated counts of 1s and 0s</li>
</ul>
<p><strong>Binary data</strong>. In the case below you would use the specification <code>correct ~ ...</code>:</p>
<div id="zprdmmcfyj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#zprdmmcfyj .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zprdmmcfyj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zprdmmcfyj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zprdmmcfyj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zprdmmcfyj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zprdmmcfyj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zprdmmcfyj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zprdmmcfyj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zprdmmcfyj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zprdmmcfyj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zprdmmcfyj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zprdmmcfyj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zprdmmcfyj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zprdmmcfyj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zprdmmcfyj .gt_from_md > :first-child {
  margin-top: 0;
}

#zprdmmcfyj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zprdmmcfyj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zprdmmcfyj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zprdmmcfyj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zprdmmcfyj .gt_row_group_first td {
  border-top-width: 2px;
}

#zprdmmcfyj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zprdmmcfyj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zprdmmcfyj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zprdmmcfyj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zprdmmcfyj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zprdmmcfyj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zprdmmcfyj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zprdmmcfyj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zprdmmcfyj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zprdmmcfyj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zprdmmcfyj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zprdmmcfyj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zprdmmcfyj .gt_left {
  text-align: left;
}

#zprdmmcfyj .gt_center {
  text-align: center;
}

#zprdmmcfyj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zprdmmcfyj .gt_font_normal {
  font-weight: normal;
}

#zprdmmcfyj .gt_font_bold {
  font-weight: bold;
}

#zprdmmcfyj .gt_font_italic {
  font-style: italic;
}

#zprdmmcfyj .gt_super {
  font-size: 65%;
}

#zprdmmcfyj .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#zprdmmcfyj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zprdmmcfyj .gt_indent_1 {
  text-indent: 5px;
}

#zprdmmcfyj .gt_indent_2 {
  text-indent: 10px;
}

#zprdmmcfyj .gt_indent_3 {
  text-indent: 15px;
}

#zprdmmcfyj .gt_indent_4 {
  text-indent: 20px;
}

#zprdmmcfyj .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="participant">participant</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="question">question</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="correct">correct</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="participant" class="gt_row gt_right">1</td>
<td headers="question" class="gt_row gt_right">1</td>
<td headers="correct" class="gt_row gt_right">1</td></tr>
    <tr><td headers="participant" class="gt_row gt_right">1</td>
<td headers="question" class="gt_row gt_right">2</td>
<td headers="correct" class="gt_row gt_right">0</td></tr>
    <tr><td headers="participant" class="gt_row gt_right">1</td>
<td headers="question" class="gt_row gt_right">3</td>
<td headers="correct" class="gt_row gt_right">1</td></tr>
    <tr><td headers="participant" class="gt_row gt_right">...</td>
<td headers="question" class="gt_row gt_right">...</td>
<td headers="correct" class="gt_row gt_right">...</td></tr>
  </tbody>
  
  
</table>
</div>
<p><strong>Binomial data</strong>. You would use the specification <code>cbind(num_successes, num_failures)</code> which, in the case below, would be:</p>
<p><code>cbind(questions_correct, questions_incorrect) ~ ...</code></p>
<div id="rnhujwjixp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rnhujwjixp .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rnhujwjixp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rnhujwjixp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rnhujwjixp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rnhujwjixp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rnhujwjixp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rnhujwjixp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rnhujwjixp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rnhujwjixp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rnhujwjixp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rnhujwjixp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rnhujwjixp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rnhujwjixp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rnhujwjixp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rnhujwjixp .gt_from_md > :first-child {
  margin-top: 0;
}

#rnhujwjixp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rnhujwjixp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rnhujwjixp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rnhujwjixp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rnhujwjixp .gt_row_group_first td {
  border-top-width: 2px;
}

#rnhujwjixp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnhujwjixp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rnhujwjixp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rnhujwjixp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rnhujwjixp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnhujwjixp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rnhujwjixp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rnhujwjixp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rnhujwjixp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rnhujwjixp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnhujwjixp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rnhujwjixp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnhujwjixp .gt_left {
  text-align: left;
}

#rnhujwjixp .gt_center {
  text-align: center;
}

#rnhujwjixp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rnhujwjixp .gt_font_normal {
  font-weight: normal;
}

#rnhujwjixp .gt_font_bold {
  font-weight: bold;
}

#rnhujwjixp .gt_font_italic {
  font-style: italic;
}

#rnhujwjixp .gt_super {
  font-size: 65%;
}

#rnhujwjixp .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#rnhujwjixp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rnhujwjixp .gt_indent_1 {
  text-indent: 5px;
}

#rnhujwjixp .gt_indent_2 {
  text-indent: 10px;
}

#rnhujwjixp .gt_indent_3 {
  text-indent: 15px;
}

#rnhujwjixp .gt_indent_4 {
  text-indent: 20px;
}

#rnhujwjixp .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="participant">participant</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="questions_correct">questions_correct</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="questions_incorrect">questions_incorrect</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="participant" class="gt_row gt_right">1</td>
<td headers="questions_correct" class="gt_row gt_right">2</td>
<td headers="questions_incorrect" class="gt_row gt_right">1</td></tr>
    <tr><td headers="participant" class="gt_row gt_right">2</td>
<td headers="questions_correct" class="gt_row gt_right">1</td>
<td headers="questions_incorrect" class="gt_row gt_right">2</td></tr>
    <tr><td headers="participant" class="gt_row gt_right">3</td>
<td headers="questions_correct" class="gt_row gt_right">3</td>
<td headers="questions_incorrect" class="gt_row gt_right">0</td></tr>
    <tr><td headers="participant" class="gt_row gt_right">...</td>
<td headers="questions_correct" class="gt_row gt_right">...</td>
<td headers="questions_incorrect" class="gt_row gt_right">...</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A3
</div>
<div class="question-body">
<blockquote>
<p><strong>Research Question 1:</strong><br />
Is the learning rate (training blocks) different between the two lesion location groups?</p>
</blockquote>
<p><strong>Hints</strong>:</p>
<ul>
<li><p>Do we want <code>cbind(num_successes, num_failures)</code>?</p></li>
<li><p>Ensure you are running models on only the data we are actually interested in.</p>
<ul>
<li>Are the healthy controls included in the research question under investigation?</li>
<li>Are the testing blocks included in the research question, or only the learning blocks?</li>
</ul></li>
<li><p>We could use model comparison via likelihood ratio tests (using <code>anova(model1, model2, model3, ...)</code>. For this question, we could compare:</p>
<ul>
<li>A model with just the change over the sequence of blocks</li>
<li>A model with the change over the sequence of blocks <em>and</em> an overall difference between groups</li>
<li>A model with groups differing with respect to their change over the sequence of blocks</li>
</ul></li>
<li><p>What about the random effects part?</p>
<ol style="list-style-type: decimal">
<li>What are our observations grouped by?</li>
<li>What variables can vary within these groups?</li>
<li>What do you want your model to allow to vary within these groups?</li>
</ol></li>
</ul>
</div>
<p class="question-end">
</p>
<div class="optional-begin">
<span id="opt-start-19" class="fa fa-chevron-circle-right optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-19&#39;, &#39;opt-start-19&#39;)"> Suggested answers to the hints if you don’t know where to start</span>
</div>
<div id="opt-body-19" class="optional-body" style="display: none;">
<ul>
<li><p>Do we want <code>cbind(num_successes, num_failures)</code>?</p>
<ul>
<li>Yes, we don’t a binary variable with correct/incorrect questions but the binomial variables NumCorrect and NumError representing, respectively, the aggregated count (out of 30) of correct and incorrect questions. As such, we will need the following: <code>cbind(NumCorrect, NumError)</code></li>
</ul></li>
<li><p>Ensure you are running models on only the data we are actually interested in.</p>
<ul>
<li>The healthy controls are not included in the research question under investigation, so we will exclude them.</li>
<li>We are only interested in the learning blocks, and we will exclude the testing blocks (block &gt; 7)</li>
<li>You might want to store this data in a separate object, but in the code for the solution we will just use <code>filter()</code> <em>inside</em> the <code>glmer()</code>.</li>
</ul></li>
<li><p>A model with just the change over the sequence of blocks:</p>
<ul>
<li><strong>outcome ~ block</strong></li>
</ul></li>
<li><p>A model with the change over the sequence of blocks <em>and</em> an overall difference between groups:</p>
<ul>
<li><strong>outcome ~ block + lesion_location</strong></li>
</ul></li>
<li><p>A model with groups differing with respect to their change *over the sequence of blocks:</p>
<ul>
<li><strong>outcome ~ block * lesion_location</strong></li>
</ul></li>
<li><p>What are our observations grouped by?</p>
<ul>
<li>repeated measures by-participant. i.e., the <code>ID</code> variable</li>
</ul></li>
<li><p>What variables can vary within these groups?</p>
<ul>
<li><code>Block</code> and <code>Phase</code>. Be careful though - you can create the <code>Phase</code> variable out of the <code>Block</code> variable, so really this is just one piece of information, encoded differently in two variables.</li>
<li>The other variables (<code>lesion_location</code> and <code>group</code>) do <strong>not</strong> vary for each ID. Lesions don’t suddenly change where they are located, nor do participants swap between being a patient vs a control (we don’t need the group variable anyway as we are excluding the controls).<br />
What do you want your model to allow to vary within these groups?</li>
<li>Do you think the change over the course of the blocks is <strong>the same</strong> for everybody? Or do you think it varies? Is this variation important to think about in terms of your research question?</li>
</ul></li>
</ul>
</div>
<p class="optional-end">
</p>
<div class="solution-begin">
<span id="sol-start-20" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-20&#39;, &#39;sol-start-20&#39;)"> Solution </span>
</div>
<div id="sol-body-20" class="solution-body" style="display: none;">
<pre class="r"><code>m.base &lt;- glmer(cbind(NumCorrect, NumError) ~ block + (block | ID), 
                data = filter(nwl, block &lt; 8, !is.na(lesion_location)),
                family=binomial)
m.loc0 &lt;- glmer(cbind(NumCorrect, NumError) ~ block + lesion_location + (block | ID), 
                data=filter(nwl, block &lt; 8, !is.na(lesion_location)),
                family=binomial)
m.loc1 &lt;- glmer(cbind(NumCorrect, NumError) ~ block * lesion_location + (block | ID), 
                data=filter(nwl, block &lt; 8, !is.na(lesion_location)),
                family=binomial)
#summary(m.loc1)
anova(m.base, m.loc0, m.loc1, test=&quot;Chisq&quot;)</code></pre>
<pre><code>## Data: filter(nwl, block &lt; 8, !is.na(lesion_location))
## Models:
## m.base: cbind(NumCorrect, NumError) ~ block + (block | ID)
## m.loc0: cbind(NumCorrect, NumError) ~ block + lesion_location + (block | ID)
## m.loc1: cbind(NumCorrect, NumError) ~ block * lesion_location + (block | ID)
##        npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
## m.base    5 454.12 466.27 -222.06   444.12                     
## m.loc0    6 454.66 469.25 -221.33   442.66 1.4572  1     0.2274
## m.loc1    7 454.47 471.48 -220.23   440.47 2.1974  1     0.1382</code></pre>
<div class="int">
<p>No significant difference in learning rate between groups (<span class="math inline">\(\chi^2(1)=2.2, p = 0.138\)</span>).</p>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A4
</div>
<div class="question-body">
<blockquote>
<p><strong>Research Question 2</strong><br />
In the testing phase, does performance on the immediate test differ between lesion location groups, and does the retention from immediate to follow-up test differ between the two lesion location groups?</p>
</blockquote>
<p>Let’s try a different approach to this. Instead of fitting various models and comparing them via likelihood ratio tests, just fit the one model which could answer both parts of the question above.</p>
<p><strong>Hints:</strong></p>
<ul>
<li>This might required a bit more data-wrangling before hand. Think about the order of your factor levels (alphabetically speaking, “Follow-up” comes before “Immediate”)!</li>
</ul>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-21" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-21&#39;, &#39;sol-start-21&#39;)"> Solution </span>
</div>
<div id="sol-body-21" class="solution-body" style="display: none;">
<pre class="r"><code>nwl_test &lt;- filter(nwl, block &gt; 7, !is.na(lesion_location)) %&gt;%
    mutate(
        Phase = factor(Phase), 
        Phase = fct_relevel(Phase, &quot;Immediate&quot;)
    )

m.recall.loc &lt;- glmer(cbind(NumCorrect, NumError) ~ Phase * lesion_location + (1 | ID), 
                      nwl_test, family=&quot;binomial&quot;)

summary(m.recall.loc)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: cbind(NumCorrect, NumError) ~ Phase * lesion_location + (1 |      ID)
##    Data: nwl_test
## 
##      AIC      BIC   logLik deviance df.resid 
##    139.3    145.2    -64.6    129.3       19 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.1556 -0.3352  0.0039  0.4963  1.3506 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  ID     (Intercept) 0.3626   0.6021  
## Number of obs: 24, groups:  ID, 12
## 
## Fixed effects:
##                                         Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)                              -0.1124     0.3167  -0.355   0.7226  
## PhaseFollow-up                           -0.0278     0.2357  -0.118   0.9061  
## lesion_locationposterior                  0.9672     0.4211   2.297   0.0216 *
## PhaseFollow-up:lesion_locationposterior  -0.2035     0.3191  -0.638   0.5236  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) PhsFl- lsn_lc
## PhaseFllw-p -0.372              
## lsn_lctnpst -0.752  0.280       
## PhsFllw-p:_  0.275 -0.739 -0.385</code></pre>
<p><strong>Note 1</strong>:</p>
<p>In the above, we have made sure to select the patients by specifying <code>!is.na(lesion_location)</code>, meaning that we want those rows where the lesion location is not missing. As a reminder <code>!</code> is the negation function (not). As we saw in Question A1, this excludes the 126 healthy controls, as well as the 9 patients for which we have missing values (NAs).</p>
<p><strong>Note 2</strong>:</p>
<p>We didn’t specify <code>(Phase | ID)</code> as the random effect because each participant only has 2 data points for Phase, and there is only one line that fits two data points. In other words, there is only one possible way to fit those two data points. As such, as each group of 2 points will have a perfect line fit, and the residuals <span class="math inline">\(\varepsilon_{ij}\)</span> will all be 0. As a consequence of this, the residuals will have no variability as they are all 0, so <span class="math inline">\(\sigma_{\epsilon}\)</span> is 0 which in turn leads to problem with estimating the model coefficients.</p>
<pre class="r"><code>subset(nwl_test, ID == &#39;patient15&#39;)</code></pre>
<pre><code>##      group lesion_location block PropCorrect NumCorrect NumError        ID
## 1  patient        anterior     8   0.5333333         16       14 patient15
## 13 patient        anterior     9   0.5333333         16       14 patient15
##        Phase
## 1  Immediate
## 13 Follow-up</code></pre>
<p>If you try using <code>(Phase | ID)</code> as random effect, you will see the following message:</p>
<p><code>boundary (singular) fit: see help('isSingular')</code></p>
</div>
<p class="solution-end">
</p>
<div class="frame">
<p><strong>Interpreting coefficients in logistic regression</strong><br />
Take some time to remind yourself from USMR of the interpretation of logistic regression coefficients.</p>
<p>The interpretation of the fixed effects of a logistic multilevel model is not very different.<br />
We can obtain the fixed effects from our model by using:</p>
<ul>
<li><code>fixef(model)</code></li>
<li><code>summary(model)$coefficients</code><br />
</li>
<li><code>coef(summary(model))</code></li>
<li><code>tidy(model)</code> from the <strong>broom.mixed</strong> package<br />
</li>
<li>(there are probably more ways, but I can’t think of them right now!)</li>
</ul>
<p>It’s just that for multilevel models, we can model by-cluster random variation around these effects.</p>
</div>
<div class="question-begin">
Question A5
</div>
<div class="question-body">
<ol style="list-style-type: decimal">
<li>In <code>family = binomial(link='logit')</code>. What function is used to relate the linear predictors in the model to the expected value of the response variable?<br />
</li>
<li>How do we convert this into something more interpretable?</li>
</ol>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-22" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-22&#39;, &#39;sol-start-22&#39;)"> Solution </span>
</div>
<div id="sol-body-22" class="solution-body" style="display: none;">
<ol style="list-style-type: decimal">
<li><p>The link function is the <code>logit</code>, or log-odds (other link functions are available).</p></li>
<li><p>To convert log-odds to odds, we can use <code>exp()</code>, to get odds and odds ratios.</p></li>
</ol>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A6
</div>
<div class="question-body">
<p>Make sure you pay attention to trying to interpret each fixed effect from your models.<br />
These can be difficult, especially when it’s logistic, and especially when there are interactions.</p>
<ul>
<li>What is the increase in the odds of answering correctly in the immediate test for someone with a posterior legion compared to someone with an anterior legion?</li>
</ul>
<!-- 

<div class="optional-begin"><span id='opt-start-23' class="fa fa-chevron-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-23', 'opt-start-23')">  Optional help: Our Solution to A4</span></div><div class="optional-body" id = "opt-body-23" style="display: none;">

 -->
<!-- ```{r eval=F} -->
<!-- nwl_test <- filter(nwl, block > 7, !is.na(lesion_location)) %>% -->
<!--   mutate( -->
<!--     Phase = fct_relevel(factor(Phase),"Immediate") -->
<!--   ) -->
<!-- m.recall.loc <- glmer(cbind(NumCorrect, NumError) ~ Phase * lesion_location + (Phase | ID),  -->
<!--                   nwl_test, family="binomial") -->
<!-- ``` -->
<!-- 

</div><p class="optional-end"></p>

 -->
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-24" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-24&#39;, &#39;sol-start-24&#39;)"> Solution </span>
</div>
<div id="sol-body-24" class="solution-body" style="display: none;">
<ul>
<li><code>(Intercept)</code> ==&gt; Anterior lesion group performance in immediate test. This is the log-odds of them answering correctly in the immediate test.</li>
<li><code>PhaseFollow-up</code> ==&gt; Change in performance (for the anterior lesion group) from immediate to follow-up test.</li>
<li><code>lesion_locationposterior</code> ==&gt; Posterior lesion group performance in immediate test relative to anterior lesion group performance in immediate test</li>
<li><code>PhaseFollow-up:lesion_locationposterior</code> ==&gt; Change in performance from immediate to follow-up test, posterior lesion group relative to anterior lesion group</li>
</ul>
<pre><code>## lesion_locationposterior 
##                 2.630634</code></pre>
<div class="int">
<p>Those with posterior lesions have 2.63 times the odds of answering correctly in the immediate test compared to someone with an anterior lesion.</p>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
OPTIONAL: A7
</div>
<div class="question-body">
<p>Recreate the visualisation in Figure <a href="#fig:nwl-fig2">2</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:nwl-fig2"></span>
<img src="02_lmm_log_files/figure-html/nwl-fig2-1.png" alt="Differences between groups in the average proportion of correct responses at each block" width="80%" />
<p class="caption">
Figure 2: Differences between groups in the average proportion of correct responses at each block
</p>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-25" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-25&#39;, &#39;sol-start-25&#39;)"> Solution </span>
</div>
<div id="sol-body-25" class="solution-body" style="display: none;">
<pre class="r"><code>ggplot(filter(nwl, !is.na(lesion_location)), aes(block, PropCorrect, 
                                                 color=lesion_location, 
                                                 shape=lesion_location)) +
    #geom_line(aes(group=ID),alpha=.2) + 
    stat_summary(fun.data=mean_se, geom=&quot;pointrange&quot;) + 
    stat_summary(data=filter(nwl, !is.na(lesion_location), block &lt;= 7), 
                 fun=mean, geom=&quot;line&quot;) + 
    geom_hline(yintercept=0.5, linetype=&quot;dashed&quot;) + 
    geom_vline(xintercept=c(7.5, 8.5), linetype=&quot;dashed&quot;) + 
    scale_x_continuous(breaks=1:9, 
                       labels=c(1:7, &quot;Test&quot;, &quot;Follow-Up&quot;)) + 
    theme_bw(base_size=10) + 
    labs(x=&quot;Block&quot;, y=&quot;Proportion Correct&quot;, 
         shape=&quot;Lesion\nLocation&quot;, color=&quot;Lesion\nLocation&quot;)</code></pre>
<p><img src="02_lmm_log_files/figure-html/unnamed-chunk-12-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
<div class="frame">
<p><strong>Coding Schemes for Categorical Predictors</strong></p>
<p>Remember that categorical predictors get inputted into our model as a series of variables which are 0s and 1s? Previously the variable in our model for lesion location was actually being coded with 0 representing one level, and 1 representing the other. This is known as “treatment coding”.</p>
<p>There are lots of other ways we might encode our categorical predictors. One common approach is to use “effects coding”. In the case where we have a binary predictor, this makes zero the mid-point between the two - i.e., the overall mean (this is a bit like mean-centering a continuous predictor).</p>
<p>If we recall that the intercept is “when all predictors are zero”, and that when we have an interaction <code>Y~A+B+A*B</code> in our model, the individual coefficients for <code>A</code> and <code>B</code> are estimated “when the other variable is zero”, then we can start to understand how these different ways of encoding our categorical predictors can change what we are getting out of our model. (Note, they don’t actually change anything about the model fit, but they change what information we are estimating from the model).</p>
<p><img src="02_lmm_log_files/figure-html/unnamed-chunk-13-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>If you want to understand this a little more, take a look at this <a href="zz_quickcontrasts.html">in depth section</a>.</p>
</div>
<div class="question-begin">
Question A8
</div>
<div class="question-body">
<p>This code is that we used to answer question A4 above, only we have edited it to change lesion location to be fitted with “effects coding”.</p>
<pre class="r"><code>nwl_test &lt;- filter(nwl, block &gt; 7, !is.na(lesion_location)) %&gt;%
    mutate(
        Phase = factor(Phase),
        Phase = fct_relevel(Phase, &quot;Immediate&quot;)
    )

m.recall.loc.effcoding &lt;- 
    glmer(cbind(NumCorrect, NumError) ~ Phase * lesion_location + (1 | ID), 
          contrasts = list(lesion_location = &quot;contr.sum&quot;),
          data = nwl_test, family=&quot;binomial&quot;)</code></pre>
<p>The interpretation of this is going to get pretty tricky - we have a logistic regression, and we have different coding scheme for our categorical predictor, and we have an interaction.. 🤯</p>
<p>Can you work out the interpretation of the fixed effects estimates?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-26" class="fa fa-chevron-circle-right solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-26&#39;, &#39;sol-start-26&#39;)"> Solution </span>
</div>
<div id="sol-body-26" class="solution-body" style="display: none;">
<ul>
<li><code>(Intercept)</code> ==&gt; Overall performance in immediate test. This is the overall log-odds of answering correctly in the immediate test.</li>
<li><code>PhaseFollow-up</code> ==&gt; Average change in performance from immediate to follow-up test.</li>
<li><code>lesion_location1</code> ==&gt; Anterior lesion group performance in immediate test relative to <em>overall average</em> performance in immediate test</li>
<li><code>PhaseFollow-up:lesion_location1</code> ==&gt; Change in performance from immediate to follow-up test, anterior lesion group relative to overall average</li>
</ul>
<p><strong>???</strong><br />
How do we know that <code>lesion_location1</code> is the <em>anterior</em> and not the <em>posterior</em> lesion group?
We need to check the what the contrasts look like:</p>
<pre class="r"><code>contrasts(nwl_test$lesion_location) &lt;- &quot;contr.sum&quot;
contrasts(nwl_test$lesion_location)</code></pre>
<pre><code>##           [,1]
## anterior     1
## posterior   -1</code></pre>
<p>Because there are only two levels to this variable, the estimate will simply flip sign (positive/negative) depending on which way the contrast is leveled.</p>
<div class="optional-begin">
<span id="opt-start-27" class="fa fa-chevron-circle-right optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-27&#39;, &#39;opt-start-27&#39;)"> Optional: I liked my coefficients being named properly</span>
</div>
<div id="opt-body-27" class="optional-body" style="display: none;">
<pre class="r"><code>colnames(contrasts(nwl_test$lesion_location)) &lt;- &quot;PeppaPig&quot;

contrasts(nwl_test$lesion_location)</code></pre>
<pre><code>##           PeppaPig
## anterior         1
## posterior       -1</code></pre>
<pre class="r"><code>modeltest &lt;- 
    glmer(cbind(NumCorrect, NumError) ~ Phase * lesion_location + (1 | ID),
          nwl_test, family=&quot;binomial&quot;)
summary(modeltest)$coefficients</code></pre>
<pre><code>##                                          Estimate Std. Error    z value
## (Intercept)                             0.3711859  0.2105010  1.7633455
## PhaseFollow-up                         -0.1295472  0.1595315 -0.8120479
## lesion_locationPeppaPig                -0.4836152  0.2105572 -2.2968351
## PhaseFollow-up:lesion_locationPeppaPig  0.1017455  0.1595298  0.6377840
##                                          Pr(&gt;|z|)
## (Intercept)                            0.07784223
## PhaseFollow-up                         0.41676413
## lesion_locationPeppaPig                0.02162818
## PhaseFollow-up:lesion_locationPeppaPig 0.52361429</code></pre>
</div>
<p class="optional-end">
</p>
</div>
<p class="solution-end">
</p>
<div class="frame">
<p><strong>Hang on.. p-values are back?!</strong></p>
<p>We noted at the end of last week that we don’t have p-values for <code>lmer()</code><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, but you might notice that we do now have them when we’ve fitted a model with <code>glmer()</code>?</p>
<p>The reason is partly just one of convention. There is a standard practice for determining the statistical significance of parameters in the generalised linear model, relying on asymptotic Wald tests which evaluate differences in log-likelihood.</p>
</div>
</div>
<div id="reading-inference-in-mlm" class="section level1">
<h1>Reading: Inference in MLM</h1>
<p>In USMR, we fitted various simple linear models using <code>lm()</code>, and we could get out either a table of coefficients (for example, Table <a href="#tab:lmcoeftab">1</a>) or a table of the reduction in sums of squared residuals (for example, Table <a href="#tab:lmanovtab">2</a>). In both of these cases we had a nice set of p-values for us to look at (in R, we often find the p-values in the column named something like <code>Pr(&gt;F)</code>).</p>
<div class="statbox">
<p><strong>A quick reminder:</strong> a p-value is the probability of observing results as or more extreme than the obtained ones, <em>if the data were really generated by the hypothesised model or process</em>).</p>
</div>
<div class="tabwid"><style>.cl-2e67898e{table-layout:auto;}.cl-2e2a0578{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2e38e476{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-2e392896{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2e3928a0{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2e3928aa{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-2e67898e'>

<caption>
<span id="tab:lmcoeftab">Table 1: </span><span>t-tests for slope coefficients for predictors in a linear model</span>
</caption>

<thead><tr style="overflow-wrap:break-word;"><th class="cl-2e392896"><p class="cl-2e38e476"><span class="cl-2e2a0578">Term</span></p></th><th class="cl-2e392896"><p class="cl-2e38e476"><span class="cl-2e2a0578">Estimate</span></p></th><th class="cl-2e392896"><p class="cl-2e38e476"><span class="cl-2e2a0578">Std. Error</span></p></th><th class="cl-2e392896"><p class="cl-2e38e476"><span class="cl-2e2a0578">t value</span></p></th><th class="cl-2e392896"><p class="cl-2e38e476"><span class="cl-2e2a0578">Pr(&gt;|t|)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2e3928a0"><p class="cl-2e38e476"><span class="cl-2e2a0578">(Intercept)</span></p></td><td class="cl-2e3928a0"><p class="cl-2e38e476"><span class="cl-2e2a0578">5.37</span></p></td><td class="cl-2e3928a0"><p class="cl-2e38e476"><span class="cl-2e2a0578">4.32</span></p></td><td class="cl-2e3928a0"><p class="cl-2e38e476"><span class="cl-2e2a0578">1.24</span></p></td><td class="cl-2e3928a0"><p class="cl-2e38e476"><span class="cl-2e2a0578">.224</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2e3928a0"><p class="cl-2e38e476"><span class="cl-2e2a0578">outdoor_time</span></p></td><td class="cl-2e3928a0"><p class="cl-2e38e476"><span class="cl-2e2a0578">0.59</span></p></td><td class="cl-2e3928a0"><p class="cl-2e38e476"><span class="cl-2e2a0578">0.17</span></p></td><td class="cl-2e3928a0"><p class="cl-2e38e476"><span class="cl-2e2a0578">3.51</span></p></td><td class="cl-2e3928a0"><p class="cl-2e38e476"><span class="cl-2e2a0578">.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2e3928aa"><p class="cl-2e38e476"><span class="cl-2e2a0578">social_int</span></p></td><td class="cl-2e3928aa"><p class="cl-2e38e476"><span class="cl-2e2a0578">1.80</span></p></td><td class="cl-2e3928aa"><p class="cl-2e38e476"><span class="cl-2e2a0578">0.27</span></p></td><td class="cl-2e3928aa"><p class="cl-2e38e476"><span class="cl-2e2a0578">6.70</span></p></td><td class="cl-2e3928aa"><p class="cl-2e38e476"><span class="cl-2e2a0578">&lt; .001</span></p></td></tr></tbody></table></div>
<p><br></p>
<div class="tabwid"><style>.cl-2ecea2ea{table-layout:auto;}.cl-2ea91f3e{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2ea91f52{font-family:'Times New Roman';font-size:12pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2eb9b86c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 2;background-color:transparent;}.cl-2eba00ba{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2eba00ce{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2eba00cf{background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-2ecea2ea'>

<caption>
<span id="tab:lmanovtab">Table 2: </span><span>F-tests for predictors in a linear model</span>
</caption>

<thead><tr style="overflow-wrap:break-word;"><th class="cl-2eba00ba"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">Term</span></p></th><th class="cl-2eba00ba"><p class="cl-2eb9b86c"><span class="cl-2ea91f52">df</span></p></th><th class="cl-2eba00ba"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">Sum Sq</span></p></th><th class="cl-2eba00ba"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">Mean Sq</span></p></th><th class="cl-2eba00ba"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">F value</span></p></th><th class="cl-2eba00ba"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">Pr(&gt;F)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2eba00ce"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">outdoor_time</span></p></td><td class="cl-2eba00ce"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">1</span></p></td><td class="cl-2eba00ce"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">1,427.94</span></p></td><td class="cl-2eba00ce"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">1,427.94</span></p></td><td class="cl-2eba00ce"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">37.77</span></p></td><td class="cl-2eba00ce"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">&lt; .001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2eba00ce"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">social_int</span></p></td><td class="cl-2eba00ce"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">1</span></p></td><td class="cl-2eba00ce"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">1,697.82</span></p></td><td class="cl-2eba00ce"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">1,697.82</span></p></td><td class="cl-2eba00ce"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">44.91</span></p></td><td class="cl-2eba00ce"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">&lt; .001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2eba00cf"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">Residuals</span></p></td><td class="cl-2eba00cf"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">29</span></p></td><td class="cl-2eba00cf"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">1,096.24</span></p></td><td class="cl-2eba00cf"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e">37.80</span></p></td><td class="cl-2eba00cf"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e"></span></p></td><td class="cl-2eba00cf"><p class="cl-2eb9b86c"><span class="cl-2ea91f3e"></span></p></td></tr></tbody></table></div>
<p><br></p>
<p>We could get p-values for these models because we know what the distribution of test statistics of interest (e.g. <span class="math inline">\(F\)</span>-statistics and <span class="math inline">\(t\)</span>-statistics), will look like if the null hypothesis were true (i.e., we can describe what they look like in terms of <span class="math inline">\(F\)</span> and <span class="math inline">\(t\)</span> distributions with specific degrees of freedom (look back to the <a href="https://uoepsy.github.io/usmr/2223/labs/07a_slr.html#the-f-statistic">USMR materials for a formula</a>).</p>
<p>Unfortunately, the same is not true of multilevel models. For the multilevel model, we can think of it as having residuals at multiple levels: we have the random variation of clusters around the fixed effects, and then random variation of observations around the cluster-level effects (more on this in Week 4).<br />
In the rare occasion that you have a perfectly balanced experimental design, then ratios of sums of squares for multi-level models follow an <span class="math inline">\(F\)</span>-distribution, in which we know the numerator and denominator degrees of freedom (this means we can work out the degrees of freedom for the <span class="math inline">\(t\)</span>-test of our fixed effect parameters). Unfortunately, in the real world where things are not often perfectly balanced, determining the denominator degrees of freedom becomes unclear.</p>
<p>Last week, we mentioned a couple of approaches that we might take for drawing inferences, finding ways to compute p-values or confidence intervals.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> We’re going to now extend this to include a few more, and discuss the strengths and limitations of the different approaches.</p>
<div class="frame">
<p><strong>For these examples… </strong></p>
<p>For the following examples, we’re going to return to our dataset of various toys, and we are going to be concerned with whether practice (the <code>hrs_week</code> variable) is associated with changes in reading ages (<code>R_AGE</code> variable).<br />
To accommodate for the clustered nature of the data, we are going to fit a model with both intercepts and slopes varying by toy-type.</p>
<pre class="r"><code>toys_read &lt;- read_csv(&quot;https://uoepsy.github.io/data/toyexample.csv&quot;)
full_model &lt;- lmer(R_AGE ~ hrs_week + (1 + hrs_week | toy_type), data = toys_read)
summary(full_model)</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: R_AGE ~ hrs_week + (1 + hrs_week | toy_type)
##    Data: toys_read
## 
## REML criterion at convergence: 637.8
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -2.51393 -0.58005 -0.00348  0.64053  2.38403 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr
##  toy_type (Intercept) 2.0349   1.4265       
##           hrs_week    0.7834   0.8851   0.63
##  Residual             4.3702   2.0905       
## Number of obs: 132, groups:  toy_type, 20
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)   1.7559     0.9610   1.827
## hrs_week      1.1435     0.2957   3.867
## 
## Correlation of Fixed Effects:
##          (Intr)
## hrs_week -0.547</code></pre>
</div>
<div class="optional-begin">
<span id="opt-start-28" class="fa fa-chevron-circle-right optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-28&#39;, &#39;opt-start-28&#39;)"> Use a normal approximation (not advisable)</span>
</div>
<div id="opt-body-28" class="optional-body" style="display: none;">
<p>Remember that the <span class="math inline">\(t\)</span> distribution starts to look more and more like the <span class="math inline">\(z\)</span> (“normal”) distribution when degrees of freedom increase? We could just assume we have infinite degrees of freedom in our test statistics, and pretend that the <span class="math inline">\(t\)</span>-values we get are actually <span class="math inline">\(z\)</span>-values. This is “anti-conservative” in as much as it is not a very cautious approach, and we are likely to have a higher false positive rate (e.g. more chance of saying “there <strong>is</strong> an effect!” when there actually isn’t.)</p>
<pre class="r"><code>coefs &lt;- as.data.frame(summary(full_model)$coefficients)
coefs$p.z &lt;- 2 * (1 - pnorm(abs(coefs[,3])))
coefs</code></pre>
<pre><code>##             Estimate Std. Error  t value          p.z
## (Intercept) 1.755943  0.9610348 1.827138 0.0676790647
## hrs_week    1.143508  0.2956875 3.867286 0.0001100533</code></pre>
</div>
<p class="optional-end">
</p>
<div class="optional-begin">
<span id="opt-start-29" class="fa fa-chevron-circle-right optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-29&#39;, &#39;opt-start-29&#39;)"> Satterthwaite df approximation</span>
</div>
<div id="opt-body-29" class="optional-body" style="display: none;">
<p>There have been a couple of methods proposed to estimate the degrees of freedom in order to provide a better approximation to the null distribution of our tests. The way the Satterthwaite method has been implemented in R will just add a column for p-values to your <code>summary(model)</code> output).</p>
<p>Load the <strong>lmerTest</strong> package, refit the model, and voila!</p>
<pre class="r"><code>library(lmerTest)
full_model &lt;- lmer(R_AGE ~ hrs_week + (1 + hrs_week | toy_type), data = toys_read)
summary(full_model)$coefficients</code></pre>
<pre><code>##             Estimate Std. Error       df  t value    Pr(&gt;|t|)
## (Intercept) 1.755943  0.9610348 16.19251 1.827138 0.086168780
## hrs_week    1.143508  0.2956875 17.51503 3.867286 0.001178702</code></pre>
<div class="int">
<p><strong>Reporting</strong></p>
<p>To account for the extra uncertainty brought by the inclusion of random effects in the model, the degrees of freedom in the coefficients tests have been corrected via Satterthwaite’s method.<br />
…<br />
…<br />
Weekly hours of reading practice was associated with increased reading age (<span class="math inline">\(\beta = 1.14,\ SE = 0.30,\ t(17.52^*) = 3.87,\ p = .001\)</span>).</p>
</div>
<p><strong>Note:</strong> if you have the <strong>lmerTest</strong> package loaded, then all the models you fit with <code>lmer()</code> will show p-values! If you want to stop this, then you will have to detach/unload the package, and refit the model.</p>
<pre class="r"><code>detach(&quot;package:lmerTest&quot;, unload=TRUE)</code></pre>
</div>
<p class="optional-end">
</p>
<div class="optional-begin">
<span id="opt-start-30" class="fa fa-chevron-circle-right optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-30&#39;, &#39;opt-start-30&#39;)"> Kenward Rogers df approximations</span>
</div>
<div id="opt-body-30" class="optional-body" style="display: none;">
<p>The Kenward-Rogers approach is slightly more conservative than the Satterthwaite method, and has been implemented for model comparison between a full model and a restricted model (a model without the parameter of interest), using the KR adjustment for the denominator degrees of freedom in the <span class="math inline">\(F\)</span>-test.<br />
For this, models must be fitted with REML, <strong>not</strong> ML. The function <code>KRmodcomp()</code> will take care of this and re-fit them for you.</p>
<pre class="r"><code>library(pbkrtest)
restricted_model &lt;- lmer(R_AGE ~ 1 + (1 + hrs_week | toy_type), data = toys_read)
full_model &lt;- lmer(R_AGE ~ hrs_week + (1 + hrs_week | toy_type), data = toys_read)
KRmodcomp(full_model, restricted_model)</code></pre>
<pre><code>## large : R_AGE ~ hrs_week + (1 + hrs_week | toy_type)
## small : R_AGE ~ 1 + (1 + hrs_week | toy_type)
##         stat    ndf    ddf F.scaling  p.value   
## Ftest 14.637  1.000 17.738         1 0.001266 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="int">
<p><strong>Reporting</strong></p>
<p>To account for the extra uncertainty brought by the inclusion of random effects in the model, the denominator degrees of freedom in have been corrected via Kenward-Rogers’ method.<br />
…<br />
…<br />
Inclusion of weekly hours of reading practice as a predictor was associated with an improvement in model fit (<span class="math inline">\(F(1,17.74^*) = 14.64,\ p = .001\)</span>).</p>
</div>
</div>
<p class="optional-end">
</p>
<div class="optional-begin">
<span id="opt-start-31" class="fa fa-chevron-circle-right optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-31&#39;, &#39;opt-start-31&#39;)"> Likelihood Ratio Test (LRT)</span>
</div>
<div id="opt-body-31" class="optional-body" style="display: none;">
<p>Conduct a model comparison between your model and a restricted model (a model without the parameter of interest), evaluating the change in log-likelihood.</p>
<div class="statbox">
<p><strong>Likelihood</strong></p>
<p>“likelihood” is a function that associates to a parameter the probability (or probability density) of observing the given sample data.</p>
<p>The intuition behind likelihood:</p>
<ol style="list-style-type: decimal">
<li>I toss a coin 10 time and observed 8 Heads.<br />
</li>
<li>We can think of a ‘model’ of the process that governs the coin’s behaviour in terms of just one number: a parameter that indicates the probability of the coin landing on heads.<br />
I have two models:</li>
</ol>
<ul>
<li>Model 1: The coin will land on heads 20% of the time. <span class="math inline">\(P(Heads)=0.2\)</span><br />
</li>
<li>Model 2: The coin will land on heads 70% of the time. <span class="math inline">\(P(Heads)=0.7\)</span><br />
</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Given the data I observe (see 1, above), we can (hopefully) intuit that Model 2 is more likely than Model 1.</li>
</ol>
<p>For a (slightly) more detailed explanation, see <a href="zz_lvp.html">here</a>.</p>
</div>
<p>This method assumes that the ratio of two likelihoods will (as sample size increases) become closer to being <span class="math inline">\(\chi^2\)</span> distributed, and so may be unreliable for small samples.</p>
<p>Models must be fitted with ML, <strong>not</strong> REML. The function <code>anova()</code> will re-fit them for you.</p>
<pre class="r"><code>restricted_model &lt;- lmer(R_AGE ~ 1 + (1 + hrs_week | toy_type), data = toys_read)
full_model &lt;- lmer(R_AGE ~ hrs_week + (1 + hrs_week | toy_type), data = toys_read)
anova(restricted_model, full_model, test = &quot;Chisq&quot;)</code></pre>
<pre><code>## refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>## Data: toys_read
## Models:
## restricted_model: R_AGE ~ 1 + (1 + hrs_week | toy_type)
## full_model: R_AGE ~ hrs_week + (1 + hrs_week | toy_type)
##                  npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
## restricted_model    5 660.32 674.73 -325.16   650.32                         
## full_model          6 650.51 667.80 -319.25   638.51 11.813  1   0.000588 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="int">
<p><strong>Reporting</strong></p>
<p>A likelihood ratio test indicated that the inclusion of weekly hours of reading practice as a predictor was associated with an improvement in model fit (<span class="math inline">\(\chi^2(1) = 11.81, p &lt; .001\)</span>).</p>
</div>
</div>
<p class="optional-end">
</p>
<div class="optional-begin">
<span id="opt-start-32" class="fa fa-chevron-circle-right optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-32&#39;, &#39;opt-start-32&#39;)"> Optional: Parametric Bootstrap LRT</span>
</div>
<div id="opt-body-32" class="optional-body" style="display: none;">
<p>There are also various “bootstrapping” methods which it is worth looking into. Think back to USMR when we first learned about hypothesis testing. Remember that we did lots of simulating data, so that we can compare what we actually observe with what we would expect if the null hypothesis were true? By doing this, we were essentially <em>creating</em> a null distribution, so that our calculating a p-value can become an issue of summarising data (e.g. calculate the proportion of our simulated null distribution that is more extreme than our observed statistic)</p>
<p>Instead of assuming that the likelihood ratio test statistics are <span class="math inline">\(\chi^2\)</span>-distributed, we can bootstrap this test instead. This approach simulates data from the simpler model, fits both the simple model and the complex model and evaluates the change in log-likelihood. By doing this over and over again, we build a distribution of what changes in log-likelihood we would be likely to see if the more complex model is not any better. In this way it actually constructs a distribution reflecting our null hypothesis, against which we can then compare our actual observed effect</p>
<pre class="r"><code>library(pbkrtest)
PBmodcomp(full_model, restricted_model, nsim=1000)</code></pre>
<pre><code>## Bootstrap test; time: 55.66 sec; samples: 1000; extremes: 1;
## Requested samples: 1000 Used samples: 630 Extremes: 1
## large : R_AGE ~ hrs_week + (1 + hrs_week | toy_type)
## R_AGE ~ 1 + (1 + hrs_week | toy_type)
##          stat df  p.value    
## LRT    11.813  1 0.000588 ***
## PBtest 11.813    0.003170 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="int">
<p><strong>Reporting</strong></p>
<p>A parametric bootstrap likelihood ratio test (R = 1000) indicated that the inclusion of weekly hours of reading practice as a predictor was associated with an improvement in model fit (<span class="math inline">\(LRT = 11.81, p = .003\)</span>).</p>
</div>
</div>
<p class="optional-end">
</p>
<div class="optional-begin">
<span id="opt-start-33" class="fa fa-chevron-circle-right optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-33&#39;, &#39;opt-start-33&#39;)"> Optional: Parametric Bootstrap Confidence Intervals</span>
</div>
<div id="opt-body-33" class="optional-body" style="display: none;">
<p>Much the same as above, but with just one model we simulate data many times and refit the model, so that we get an empirical distribution that we can use to construct confidence intervals for our effects.</p>
<pre class="r"><code>confint(full_model, method=&quot;boot&quot;)  </code></pre>
<pre><code>##                   2.5 %   97.5 %
## .sig01       0.00000000 4.268332
## .sig02      -0.58357448 1.000000
## .sig03       0.34042506 1.456812
## .sigma       1.76948252 2.331535
## (Intercept) -0.04916593 3.566227
## hrs_week     0.57591194 1.733356</code></pre>
<div class="int">
<p><strong>Reporting</strong></p>
<p>95% Confidence Intervals were obtained via parametric bootstrapping with 1000 iterations.<br />
…<br />
…<br />
Weekly hours of reading practice was associated increased reading age
<span class="math inline">\((\beta = 1.14,\ 95\%\ CI\ [0.58, 1.73])\)</span>.</p>
</div>
<p><strong>Note.</strong> You may get slightly different numbers as bootstrap methods use random numbers, so if you results are slightly (just slightly) different, that’s normal.</p>
</div>
<p class="optional-end">
</p>
<div class="optional-begin">
<span id="opt-start-34" class="fa fa-chevron-circle-right optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-34&#39;, &#39;opt-start-34&#39;)"> Optional: Case-based Bootstrap Confidence Intervals</span>
</div>
<div id="opt-body-34" class="optional-body" style="display: none;">
<p>It’s worth noting that there are many different types of bootstrapping that we can conduct. Different methods of bootstrapping vary with respect to the assumptions we will have to make when using them for drawing inferences. For instance, the parametric bootstrap discussed above assumes that explanatory variables are fixed and that model specification and the distributions such as <span class="math inline">\(\zeta_i \sim N(0,\sigma_{\zeta})\)</span> and <span class="math inline">\(\varepsilon_i \sim N(0,\sigma_{\varepsilon})\)</span> are correct.<br />
An alternative is to generate a distribution by <strong>resampling with replacement</strong> from our data, fitting our model to the resample, and then repeating this over and over. This doesn’t have to rely on assumptions about the shape of the distributions of <span class="math inline">\(\zeta_i\)</span> and <span class="math inline">\(\varepsilon_i\)</span> - we just need to ensure that we correctly specify the hierarchical dependency of data. It does, however, require the decision of at which levels to resample (this is discussed more in week 4, and is what the <strong>lmeresampler</strong> package is all about).</p>
</div>
<p class="optional-end">
</p>
<div class="frame">
<p>If you want more information (not required reading for this course), then Julian Faraway has a page <a href="https://people.bath.ac.uk/jjf23/mixchange/index.html">here</a> with links to some worked examples, and Ben Bolker has a wealth of information on his <a href="http://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#why-doesnt-lme4-display-denominator-degrees-of-freedomp-values-what-other-options-do-i-have">GLMM FAQ pages</a>.</p>
</div>
<!-- Formatting -->
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>We also didn’t get <span class="math inline">\(R^2\)</span>. Check out <a href="http://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#how-do-i-compute-a-coefficient-of-determination-r2-or-an-analogue-for-glmms">http://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#how-do-i-compute-a-coefficient-of-determination-r2-or-an-analogue-for-glmms</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>It’s always important to note that aiming for a p-value or confidence interval to make a dichotomous decision is only <em>one approach</em> to doing statistics. If you continue to develop your learning of statistics after this course (which we hope you will!), then you will find that there are other schools of thought that bring different benefits.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

<link rel="stylesheet" href="https://uoepsy.github.io/assets/css/ccfooter.css" />
<div class="ccfooter"></div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "site_libs/mathjax-local/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
