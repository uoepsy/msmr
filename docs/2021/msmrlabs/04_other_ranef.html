<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Other random effects structures</title>

<script src="site_libs/header-attrs-2.8/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-plus')) {
    f.classList.add('fa-minus')
    f.classList.remove('fa-plus')
} else {
    f.classList.add('fa-plus')
    f.classList.remove('fa-minus')
}
}
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="assets/style-labs.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><strong>MSMR</strong></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Mixed Effects Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="01_intromlm.html">1: Intro to Multi-Level Modelling</a>
    </li>
    <li>
      <a href="02_lmm_log.html">2: Logistic | Longitudinal (linear)</a>
    </li>
    <li>
      <a href="03_nonlin.html">3: Longitudinal (non-linear)</a>
    </li>
    <li>
      <a href="04_other_ranef.html">4: Other Random Effect Structures</a>
    </li>
    <li>
      <a href="05_multilevel_recap.html">5: Recap | Individual Differences</a>
    </li>
    <li>
      <a href="06_rev.html">Break Week</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data Reduction &amp; SEM
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="07_efapca.html">PCA | EFA</a>
    </li>
    <li>
      <a href="08_cfa.html">CFA</a>
    </li>
    <li>
      <a href="09_path.html">Path Analysis</a>
    </li>
    <li>
      <a href="10_sem1.html">SEM 1</a>
    </li>
    <li>
      <a href="11_sem2.html">SEM 2</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-info-circle"></span>
     
    Help
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="00_tidyverse_markdown.html">Recap - Tidyverse &amp; Markdown</a>
    </li>
    <li>
      <a href="zz_writeuplogistic.html">Write-up &amp; Logistic GCA</a>
    </li>
    <li>
      <a href="zz_assumpts.html">MLM Assumptions &amp; Diagnostics</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Other random effects structures</h1>

</div>


<div class="red">
<p><strong>Preliminaries</strong></p>
<p>Open Rstudio, and create a new RMarkdown document (giving it a title for this week).</p>
</div>
<div id="non-convergence-and-singular-fits-what-should-i-do" class="section level1">
<h1>Non-convergence and singular fits: what should I do?</h1>
<div id="singular-fits" class="section level2">
<h2>Singular fits</h2>
<p>You may have noticed that a lot of our models over the last few weeks have been giving a warning: <code>boundary (singular) fit: see ?isSingular</code>.<br />
Up to now, we’ve been largely ignoring these warnings. However, this week we’re going to look at how to deal with this issue.</p>
<p>The warning is telling us that our model has resulted in a ‘singular fit.’ Singular fits often indicate that the model is ‘overfitted’ - that is, the random effects structure which we have specified is too complex to be supported by the data.</p>
<p>Perhaps the most intuitive advice would be remove the most complex part of the random effects structure (i.e. random slopes). This leads to a simpler model that is not over-fitted. In other words, start simplying from the top (where the most complexity is) to the bottom (where the lowest complexity is).
Additionally, when variance estimates are very low for a specific random effect term, this indicates that the model is not estimating this parameter to differ much between the levels of your grouping variable. It might, in some experimental designs, be perfectly acceptable to remove this or simply include it as a fixed effect.</p>
<p>A key point here is that when fitting a mixed model, we should think about how the data are generated. Asking yourself questions such as “do we have good reason to assume subjects might vary over time, or to assume that they will have different starting points (i.e., different intercepts)?” can help you in specifying your random effect structure</p>
<p>You can read in depth about what this means by reading the help documentation for <code>?isSingular</code>. For our purposes, a relevant section is copied below:</p>
<p><em>… intercept-only models, or 2-dimensional random effects such as intercept + slope models, singularity is relatively easy to detect because it leads to random-effect variance estimates of (nearly) zero, or estimates of correlations that are (almost) exactly -1 or 1.</em></p>
</div>
<div id="convergence-warnings" class="section level2">
<h2>Convergence warnings</h2>
<p>Issues of non-convergence can be caused by many things. If you’re model doesn’t converge, it does <em>not necessarily</em> mean the fit is incorrect, however it is <strong>is cause for concern</strong>, and should be addressed, else you may end up reporting inferences which do not hold.</p>
<p>There are lots of different things which you could do which <em>might</em> help your model to converge. A select few are detailed below:</p>
<ul>
<li><p>double-check the model specification and the data</p></li>
<li><p>adjust stopping (convergence) tolerances for the nonlinear optimizer, using the optCtrl argument to [g]lmerControl. (see <code>?convergence</code> for convergence controls).</p>
<ul>
<li>What is “tolerance?” Remember that our optimizer is the the method by which the computer finds the best fitting model, by iteratively assessing and trying to maximise the likelihood (or minimise the loss).
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-2"></span>
<img src="images/otherranef/tolerance.png" alt="An optimizer will stop after a certain number of iterations, or when it meets a tolerance threshold" width="80%" />
<p class="caption">
Figure 1: An optimizer will stop after a certain number of iterations, or when it meets a tolerance threshold
</p>
</div></li>
</ul></li>
<li><p>center and scale continuous predictor variables (e.g. with <code>scale</code>)</p></li>
<li><p>Change the optimization method (for example, here we change it to <code>bobyqa</code>):
<code>lmer(..., control = lmerControl(optimizer="bobyqa"))</code><br />
<code>glmer(..., control = glmerControl(optimizer="bobyqa"))</code></p></li>
<li><p>Increase the number of optimization steps:
<code>lmer(..., control = lmerControl(optimizer="bobyqa", optCtrl=list(maxfun=50000))</code><br />
<code>glmer(..., control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=50000))</code></p></li>
<li><p>Use <code>allFit()</code> to try the fit with all available optimizers. This will of course be slow, but is considered ‘the gold standard’; <em>“if all optimizers converge to values that are practically equivalent, then we would consider the convergence warnings to be false positives.”</em></p></li>
</ul>
<p><br></p>
</div>
</div>
<div id="random-effects" class="section level1">
<h1>Random effects</h1>
<p>When specifying a random effects model, think about the data you have and how they fit in the following table:</p>
<table>
<colgroup>
<col width="11%" />
<col width="37%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Criterion:</th>
<th>Repetition: <br> <em>If the experiment were repeated:</em></th>
<th>Desired inference: <br> <em>The conclusions refer to:</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fixed effects</td>
<td>Same levels would be used</td>
<td>The levels used</td>
</tr>
<tr class="even">
<td>Random effects</td>
<td>Different levels would be used</td>
<td>A population from which the levels used are just a (random) sample</td>
</tr>
</tbody>
</table>
<p>For example, applying the criteria to the following questions:</p>
<ul>
<li><p>Do dogs learn faster with higher rewards?</p>
<p>FIXED: reward</p>
<p>RANDOM: dog</p></li>
<li><p>Do students read faster at higher temperatures?</p>
<p>FIXED: temperature</p>
<p>RANDOM: student</p></li>
<li><p>Does people speaking one language speak faster than another?</p>
<p>FIXED: the language</p>
<p>RANDOM: the people speaking that language</p></li>
</ul>
<p><br></p>
<p>Sometimes, after simplifying the model, you find that there isn’t much variability in a specific random effect and, if it still leads to singular fits or convergence warnings, it is common to just model that variable as a fixed effect.</p>
<p>Other times, you don’t have sufficient data or levels to estimate the random effect variance, and you are forced to model it as a fixed effect.
This is similar to trying to find the “best-fit” line passing through a single point… You can’t because you need two points!</p>
<div id="random-effects-in-lme4" class="section level2">
<h2>Random effects in lme4</h2>
<p>Below are a selection of different formulas for specifying different random effect structures, taken from the <a href="https://cran.r-project.org/web/packages/lme4/vignettes/lmer.pdf">lme4 vignette</a>. This might look like a lot, but over time and repeated use of multilevel models you will get used to reading these in a similar way to getting used to reading the formula structure of <code>y ~ x1 + x2</code> in all our linear models.
<br></p>
<table>
<colgroup>
<col width="29%" />
<col width="41%" />
<col width="29%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Formula</th>
<th align="right">Alternative</th>
<th align="right">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(\text{(1 | g)}\)</span></td>
<td align="right"><span class="math inline">\(\text{1 + (1 | g)}\)</span></td>
<td align="right">Random intercept with fixed mean</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(\text{0 + offset(o) + (1 | g)}\)</span></td>
<td align="right"><span class="math inline">\(\text{-1 + offset(o) + (1 | g)}\)</span></td>
<td align="right">Random intercept with <em>a priori</em> means</td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(\text{(1 | g1/g2)}\)</span></td>
<td align="right"><span class="math inline">\(\text{(1 | g1) + (1 | g1:g2)}\)</span></td>
<td align="right">Intercept varying among <span class="math inline">\(g1\)</span> and <span class="math inline">\(g2\)</span> within <span class="math inline">\(g1\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(\text{(1 | g1) + (1 | g2)}\)</span></td>
<td align="right"><span class="math inline">\(\text{1 + (1 | g1) + (1 | g2)}\)</span></td>
<td align="right">Intercept varying among <span class="math inline">\(g1\)</span> and <span class="math inline">\(g2\)</span></td>
</tr>
<tr class="odd">
<td align="right"><span class="math inline">\(\text{x + (x | g)}\)</span></td>
<td align="right"><span class="math inline">\(\text{1 + x + (1 + x | g)}\)</span></td>
<td align="right">Correlated random intercept and slope</td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(\text{x + (x || g)}\)</span></td>
<td align="right"><span class="math inline">\(\text{1 + x + (x | g) + (0 + x | g)}\)</span></td>
<td align="right">Uncorrelated random intercept and slope</td>
</tr>
</tbody>
</table>
<p><strong>Table 1:</strong> Examples of the right-hand-sides of mixed effects model formulas. <span class="math inline">\(g\)</span>, <span class="math inline">\(g1\)</span>, <span class="math inline">\(g2\)</span> are grouping factors, covariates and <em>a priori</em> known offsets are <span class="math inline">\(x\)</span> and <span class="math inline">\(o\)</span>.</p>
</div>
</div>
<div id="a.-three-level-nesting" class="section level1">
<h1>A. Three-level nesting</h1>
<div class="optional-begin">
Data Codebook: Treatment effects<span id="opt-start-67" class="fa fa-plus optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-67&#39;, &#39;opt-start-67&#39;)"></span>
</div>
<div id="opt-body-67" class="optional-body" style="display: none;">
<p>Synthetic data from a RCT treatment study: 5 therapists randomly assigned participants to control or treatment group and monitored the participants’ performance over time. There was a baseline test, then 6 weeks of treatment, with test sessions every week (7 total sessions).</p>
<p>The following code will load in your R session an object already called <code>tx</code> with the data:</p>
<pre class="r"><code>load(url(&quot;https://uoepsy.github.io/msmr/data/tx.Rdata&quot;))</code></pre>
You can see the head of the data below:
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
group
</th>
<th style="text-align:center;">
session
</th>
<th style="text-align:center;">
therapist
</th>
<th style="text-align:center;">
Score
</th>
<th style="text-align:center;">
PID
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
control
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
0.56
</td>
<td style="text-align:center;">
A_control_15
</td>
</tr>
<tr>
<td style="text-align:center;">
control
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
0.61
</td>
<td style="text-align:center;">
B_control_15
</td>
</tr>
<tr>
<td style="text-align:center;">
control
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
C
</td>
<td style="text-align:center;">
0.54
</td>
<td style="text-align:center;">
C_control_15
</td>
</tr>
<tr>
<td style="text-align:center;">
control
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
D
</td>
<td style="text-align:center;">
0.45
</td>
<td style="text-align:center;">
D_control_15
</td>
</tr>
<tr>
<td style="text-align:center;">
control
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
E
</td>
<td style="text-align:center;">
0.59
</td>
<td style="text-align:center;">
E_control_15
</td>
</tr>
<tr>
<td style="text-align:center;">
control
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
0.56
</td>
<td style="text-align:center;">
A_control_21
</td>
</tr>
</tbody>
</table>
</div>
<p class="optional-end">
</p>
<div class="question-begin">
Question 1
</div>
<div class="question-body">
<p>Load and visualise the data. Does it look like the treatment had an effect on the performance score?</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-68" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-68&#39;, &#39;sol-start-68&#39;)"></span>
</div>
<div id="sol-body-68" class="solution-body" style="display: none;">
<pre class="r"><code>ggplot(tx, aes(session, Score, color=group)) +
  stat_summary(fun.data = mean_se, geom=&quot;pointrange&quot;) +
  stat_smooth() +
  theme_classic()</code></pre>
<p><img src="04_other_ranef_files/figure-html/unnamed-chunk-5-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Just for fun, let’s add on the individual participant scores, and also make a plot for each therapist.</p>
<pre class="r"><code>ggplot(tx, aes(session, Score, color=group)) +
  stat_summary(fun.data = mean_se, geom = &quot;pointrange&quot;) +
  stat_smooth() +
  theme_classic() +
  geom_line(aes(group = PID), alpha = .2) + 
  facet_wrap(~ therapist)</code></pre>
<p><img src="04_other_ranef_files/figure-html/unnamed-chunk-6-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 2
</div>
<div class="question-body">
<p>Consider these questions when you’re designing your model(s) and use your answers to motivate your model design and interpretation of results:</p>
<ol style="list-style-type: lower-alpha">
<li>What are the levels of nesting? How should that be reflected in the random effect structure?</li>
<li>What is the shape of change over time? Do you need polynomials to model this shape? If yes, what order polynomials?</li>
</ol>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-69" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-69&#39;, &#39;sol-start-69&#39;)"></span>
</div>
<div id="sol-body-69" class="solution-body" style="display: none;">
<ol style="list-style-type: lower-alpha">
<li>There are repeated measures of participants (session). There are also repeated measures of therapists (each one treated many participants).</li>
<li>Looks like linear change, don’t need polynomials. Good to know that there is no difference at baseline, so no need for orthogonal time.</li>
</ol>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 3
</div>
<div class="question-body">
<p>Test whether the treatment had an effect using mixed-effects modelling.</p>
<p>Try to fit the <strong>maximal</strong> model.<br />
Does it converge? Is it singular?</p>
<div class="optional-begin">
Hint: What <em>is</em> the maximal model?<span id="opt-start-70" class="fa fa-plus optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-70&#39;, &#39;opt-start-70&#39;)"></span>
</div>
<div id="opt-body-70" class="optional-body" style="display: none;">
<p>There’s an interaction between session and group. Each participant has several sessions, so we want <code>(1 + session | PID)</code> and each therapist has several groups and sessions, so we want <code>(1 + ? * ? | ?)</code></p>
</div>
<p class="optional-end">
</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-71" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-71&#39;, &#39;sol-start-71&#39;)"></span>
</div>
<div id="sol-body-71" class="solution-body" style="display: none;">
<pre class="r"><code>library(lme4)
library(lmerTest)

# start with maximal model
m1 &lt;- lmer(Score ~ session * group + 
             (1 + session | PID) + 
             (1 + session * group | therapist),
           data=tx, REML=FALSE)

isSingular(m1)</code></pre>
<pre><code>## [1] TRUE</code></pre>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 4
</div>
<div class="question-body">
<p>Try adjusting your model by removing random effects or correlations, examine the model again, and so on..</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-72" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-72&#39;, &#39;sol-start-72&#39;)"></span>
</div>
<div id="sol-body-72" class="solution-body" style="display: none;">
<pre class="r"><code>VarCorr(m1)</code></pre>
<pre><code>##  Groups    Name                 Std.Dev.   Corr                
##  PID       (Intercept)          0.11715958                     
##            session              0.03137359 -0.601              
##  therapist (Intercept)          0.00000000                     
##            session              0.00069241    NaN              
##            groupcontrol         0.00290504    NaN  1.000       
##            session:groupcontrol 0.00058153    NaN -1.000 -1.000
##  Residual                       0.07326948</code></pre>
<p>There’s a correlation of exactly -1 between the random intercepts and slopes for therapists, and the standard deviation estimate for <code>session|therapist</code> is pretty small. Let’s remove it.</p>
<pre class="r"><code>m2 &lt;- lmer(Score ~ session * group + 
             (1 + session | PID) + 
             (1 | therapist),
           data=tx, REML=FALSE)
VarCorr(m2)</code></pre>
<pre><code>##  Groups    Name        Std.Dev. Corr  
##  PID       (Intercept) 0.11717        
##            session     0.03138  -0.601
##  therapist (Intercept) 0.00000        
##  Residual              0.07327</code></pre>
<p>It now looks like estimates for random intercepts for therapists is now 0. If we remove this, our model finally is non-singular:</p>
<pre class="r"><code>m3 &lt;- lmer(Score ~ session * group + 
             (1 + session | PID),
           data=tx, REML=FALSE)
summary(m3)</code></pre>
<pre><code>## Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite&#39;s
##   method [lmerModLmerTest]
## Formula: Score ~ session * group + (1 + session | PID)
##    Data: tx
## 
##      AIC      BIC   logLik deviance df.resid 
##  -1649.8  -1611.0    832.9  -1665.8      937 
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -2.63288 -0.58802  0.01438  0.55505  2.87865 
## 
## Random effects:
##  Groups   Name        Variance  Std.Dev. Corr 
##  PID      (Intercept) 0.0137300 0.11717       
##           session     0.0009848 0.03138  -0.60
##  Residual             0.0053685 0.07327       
## Number of obs: 945, groups:  PID, 135
## 
## Fixed effects:
##                        Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)            0.526849   0.015841 135.002803  33.260  &lt; 2e-16 ***
## session                0.033688   0.004100 134.995010   8.217 1.51e-13 ***
## groupcontrol           0.018136   0.022829 135.002805   0.794 0.428332    
## session:groupcontrol  -0.020138   0.005908 134.995014  -3.409 0.000861 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) sessin grpcnt
## session     -0.655              
## groupcontrl -0.694  0.454       
## sssn:grpcnt  0.454 -0.694 -0.655</code></pre>
<p>Lastly, it’s then a good idea to check that the parameter estimates and SE are not radically different across these models (they are virtually identical)</p>
<pre class="r"><code>summary(m1)$coefficients</code></pre>
<pre><code>##                         Estimate  Std. Error        df   t value     Pr(&gt;|t|)
## (Intercept)           0.52684907 0.015838899 134.71030 33.262986 7.987774e-67
## session               0.03368821 0.004110515  49.18334  8.195617 9.353263e-11
## groupcontrol          0.01813605 0.022863224  95.49304  0.793241 4.296040e-01
## session:groupcontrol -0.02013829 0.005912772 111.37780 -3.405897 9.180515e-04</code></pre>
<pre class="r"><code>summary(m2)$coefficients</code></pre>
<pre><code>##                         Estimate  Std. Error       df    t value     Pr(&gt;|t|)
## (Intercept)           0.52684907 0.015840448 135.0046 33.2597335 6.641086e-67
## session               0.03368821 0.004099564 135.0029  8.2175099 1.507171e-13
## groupcontrol          0.01813605 0.022828515 135.0046  0.7944471 4.283295e-01
## session:groupcontrol -0.02013829 0.005908101 135.0029 -3.4085898 8.611531e-04</code></pre>
<pre class="r"><code>summary(m3)$coefficients</code></pre>
<pre><code>##                         Estimate  Std. Error       df    t value     Pr(&gt;|t|)
## (Intercept)           0.52684907 0.015840534 135.0028 33.2595529 6.653281e-67
## session               0.03368821 0.004099663 134.9950  8.2173108 1.509284e-13
## groupcontrol          0.01813605 0.022828639 135.0028  0.7944428 4.283320e-01
## session:groupcontrol -0.02013829 0.005908244 134.9950 -3.4085072 8.614061e-04</code></pre>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Extra: Question 5
</div>
<div class="question-body">
<p>Try the code below to use the <code>allFit()</code> function to fit your final model with all the available optimizers.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<ul>
<li>You might need to install the <code>dfoptim</code> package to get one of the optimizers</li>
</ul>
<pre class="r"><code>sumfits &lt;- allFit(yourmodel)
summary(sumfits)</code></pre>
<p class="question-end">
</p>
</div>
</div>
<div id="b.-crossed-random-effects" class="section level1">
<h1>B. Crossed random effects</h1>
<div class="optional-begin">
Data Codeook: Test-enhanced learning<span id="opt-start-73" class="fa fa-plus optional-icon clickable" onclick="toggle_visibility(&#39;opt-body-73&#39;, &#39;opt-start-73&#39;)"></span>
</div>
<div id="opt-body-73" class="optional-body" style="display: none;">
<p>An experiment was run to replicate “test-enhanced learning” (Roediger &amp; Karpicke, 2006): two groups of 25 participants were presented with material to learn. One group studied the material twice (<code>StudyStudy</code>), the other group studied the material once then did a test (<code>StudyTest</code>). Recall was tested immediately (one minute) after the learning session and one week later. The recall tests were composed of 175 items identified by a keyword (<code>Test_word</code>).</p>
<p>The critical (replication) prediction is that the <code>StudyStudy</code> group should perform somewhat better on the immediate recall test, but the <code>StudyTest</code> group will retain the material better and thus perform better on the 1-week follow-up test.</p>
<p>The following code loads the data into your R environment by creating a variable called <code>tel</code>:</p>
<pre class="r"><code>load(url(&quot;https://uoepsy.github.io/msmr/data/TestEnhancedLearning.RData&quot;))</code></pre>
The head of the dataset can be seen below:
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Subject_ID
</th>
<th style="text-align:center;">
Group
</th>
<th style="text-align:center;">
Delay
</th>
<th style="text-align:center;">
Test_word
</th>
<th style="text-align:center;">
Correct
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
StudyTest_L
</td>
<td style="text-align:center;">
StudyTest
</td>
<td style="text-align:center;">
min
</td>
<td style="text-align:center;">
van
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
StudyTest_L
</td>
<td style="text-align:center;">
StudyTest
</td>
<td style="text-align:center;">
week
</td>
<td style="text-align:center;">
dinosaur
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
StudyTest_L
</td>
<td style="text-align:center;">
StudyTest
</td>
<td style="text-align:center;">
min
</td>
<td style="text-align:center;">
typewriter
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
StudyTest_L
</td>
<td style="text-align:center;">
StudyTest
</td>
<td style="text-align:center;">
min
</td>
<td style="text-align:center;">
chimney
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
StudyTest_L
</td>
<td style="text-align:center;">
StudyTest
</td>
<td style="text-align:center;">
week
</td>
<td style="text-align:center;">
dog
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
StudyTest_L
</td>
<td style="text-align:center;">
StudyTest
</td>
<td style="text-align:center;">
min
</td>
<td style="text-align:center;">
turkey
</td>
<td style="text-align:center;">
1
</td>
</tr>
</tbody>
</table>
</div>
<p class="optional-end">
</p>
<div class="question-begin">
Question 6
</div>
<div class="question-body">
<p>Load and plot the data. Does it look like the effect was replicated?</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-74" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-74&#39;, &#39;sol-start-74&#39;)"></span>
</div>
<div id="sol-body-74" class="solution-body" style="display: none;">
<p>You can make use of <code>stat_summary()</code> again!</p>
<pre class="r"><code>ggplot(tel, aes(Delay, Correct, col=Group)) + 
  stat_summary(fun.data=mean_se, geom=&quot;pointrange&quot;)+
  theme_light()</code></pre>
<p>It’s more work, but some people might rather calculate the numbers and then plot them directly. It does just the same thing:</p>
<pre class="r"><code>tel %&gt;% 
  group_by(Delay, Group) %&gt;%
  summarise(
    mean = mean(Correct),
    se = sd(Correct)/sqrt(n())
  ) %&gt;%
  ggplot(., aes(x=Delay, col = Group)) +
  geom_pointrange(aes(y=mean, ymin=mean-se, ymax=mean+se))+
  theme_light() +
  labs(y = &quot;Correct&quot;)</code></pre>
<p><img src="04_other_ranef_files/figure-html/unnamed-chunk-16-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>That looks like test-enhanced learning to me!</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 7
</div>
<div class="question-body">
<p>Test the critical hypothesis using a mixed-effects model. Fit the maximal random effect structure supported by the experimental design.</p>
<p>Some questions to consider:</p>
<ul>
<li><p>Item accuracy is a binary variable. What kind of model will you use?<br />
</p></li>
<li><p>We can expect variability across subjects (some people are better at learning than others) and across items (some of the recall items are harder than others). How should this be represented in the random effects?</p></li>
<li><p>If a model takes ages to fit, you might want to cancel it by pressing the escape key. It is normal for complex models to take time, but for the purposes of this task, give up after a couple of minutes, and try simplifying your model.</p></li>
</ul>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-75" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-75&#39;, &#39;sol-start-75&#39;)"></span>
</div>
<div id="sol-body-75" class="solution-body" style="display: none;">
<p>This one will probably take too long:</p>
<pre class="r"><code>m &lt;- glmer(Correct ~ Delay*Group +
             (1 + Delay | Subject_ID) +
             (1 + Delay * Group | Test_word),
           data=tel, family=&quot;binomial&quot;,
           glmerControl(optimizer = &quot;bobyqa&quot;))</code></pre>
<p>So lets remove the interaction in the by-word random effects:</p>
<pre class="r"><code>m &lt;- glmer(Correct ~ Delay*Group +
             (1 + Delay | Subject_ID) +
             (1 + Delay + Group | Test_word),
           data=tel, family=&quot;binomial&quot;,
           glmerControl(optimizer = &quot;bobyqa&quot;))
summary(m)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: Correct ~ Delay * Group + (1 + Delay | Subject_ID) + (1 + Delay +  
##     Group | Test_word)
##    Data: tel
## Control: glmerControl(optimizer = &quot;bobyqa&quot;)
## 
##      AIC      BIC   logLik deviance df.resid 
##  16289.8  16390.8  -8131.9  16263.8    17485 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -7.4352 -0.4778  0.2763  0.5182  7.5360 
## 
## Random effects:
##  Groups     Name           Variance Std.Dev. Corr       
##  Test_word  (Intercept)    1.160006 1.07704             
##             Delayweek      0.005544 0.07446  -0.80      
##             GroupStudyTest 0.011906 0.10911  -0.93  0.97
##  Subject_ID (Intercept)    2.527060 1.58967             
##             Delayweek      0.044398 0.21071  -0.60      
## Number of obs: 17498, groups:  Test_word, 175; Subject_ID, 50
## 
## Fixed effects:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               1.28218    0.33086   3.875 0.000107 ***
## Delayweek                -1.07133    0.07068 -15.157  &lt; 2e-16 ***
## GroupStudyTest           -0.42871    0.45380  -0.945 0.344804    
## Delayweek:GroupStudyTest  0.79434    0.10191   7.795 6.47e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) Delywk GrpStT
## Delayweek   -0.441              
## GropStdyTst -0.688  0.309       
## Dlywk:GrpST  0.292 -0.679 -0.430
## optimizer (bobyqa) convergence code: 0 (OK)
## boundary (singular) fit: see ?isSingular</code></pre>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 8
</div>
<div class="question-body">
<p>The model with maximal random effects will probably not converge, or will obtain a singular fit. Simplify the model until you achieve convergence.<br />
<br>
What we’re aiming to do here is to follow <a href="https://doi.org/10.1016/j.jml.2012.11.001">Barr et al.’s</a> advice of defining our maximal model and then removing only the terms to allow a non-singular fit.<br />
<br>
<strong>Note:</strong> This strategy - starting with the maximal random effects structure and removing terms until obtaining model convergence, is just <em>one</em> approach, and there are drawbacks (see <a href="https://doi.org/10.1016/j.jml.2017.01.001">Matuschek et al., 2017</a>). There is no consensus on what approach is best (see <code>?isSingular</code>).<br />
<br>
<br>
<em>Tip:</em> you can look at the variance estimates and correlations easily by using the <code>VarCorr()</code> function. What jumps out?<br />
<br>
<em>Hint:</em> Generalization over subjects could be considered more important than over items - if the estimated variance of slopes for <code>Delay</code> and <code>Group</code> by-items are comparatively small, it might be easier to remove them?</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-76" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-76&#39;, &#39;sol-start-76&#39;)"></span>
</div>
<div id="sol-body-76" class="solution-body" style="display: none;">
<pre class="r"><code>VarCorr(m)</code></pre>
<pre><code>##  Groups     Name           Std.Dev. Corr         
##  Test_word  (Intercept)    1.077036              
##             Delayweek      0.074456 -0.803       
##             GroupStudyTest 0.109113 -0.930  0.966
##  Subject_ID (Intercept)    1.589673              
##             Delayweek      0.210709 -0.600</code></pre>
<p>The by-item slope of <code>Group</code> seems to be quite highly correlated with other by-item terms.</p>
<p>For now, we will just simply remove the term (however, we could - if we had theoretical justification - constrain our model so that there was 0 correlation)</p>
<pre class="r"><code>m2 &lt;- glmer(Correct ~ Delay*Group +
             (1 + Delay | Subject_ID) +
             (1 + Delay | Test_word),
            data=tel, family=&quot;binomial&quot;,
            glmerControl(optimizer = &quot;bobyqa&quot;))
VarCorr(m2)</code></pre>
<pre><code>##  Groups     Name        Std.Dev. Corr  
##  Test_word  (Intercept) 1.027504       
##             Delayweek   0.055414 -1.000
##  Subject_ID (Intercept) 1.598992       
##             Delayweek   0.208731 -0.599</code></pre>
<p>It’s still a singular fit, and the <code>Delay</code> random slope by <code>Test_word</code> variance is extremely low and perfectly correlated with the intercept, let’s try removing that:</p>
<pre class="r"><code>m3 &lt;- glmer(Correct ~ Delay*Group +
              (1 + Delay | Subject_ID) +
              (1 | Test_word),
            data=tel, family=&quot;binomial&quot;,
            glmerControl(optimizer = &quot;bobyqa&quot;))</code></pre>
<p>Hooray, the model converged!</p>
<pre class="r"><code>summary(m3)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: Correct ~ Delay * Group + (1 + Delay | Subject_ID) + (1 | Test_word)
##    Data: tel
## Control: glmerControl(optimizer = &quot;bobyqa&quot;)
## 
##      AIC      BIC   logLik deviance df.resid 
##  16285.3  16347.4  -8134.6  16269.3    17490 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -7.5190 -0.4795  0.2758  0.5199  8.0698 
## 
## Random effects:
##  Groups     Name        Variance Std.Dev. Corr 
##  Test_word  (Intercept) 0.9961   0.9980        
##  Subject_ID (Intercept) 2.5170   1.5865        
##             Delayweek   0.0387   0.1967   -0.52
## Number of obs: 17498, groups:  Test_word, 175; Subject_ID, 50
## 
## Fixed effects:
##                          Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               1.25717    0.32858   3.826  0.00013 ***
## Delayweek                -1.04684    0.06750 -15.508  &lt; 2e-16 ***
## GroupStudyTest           -0.39818    0.45252  -0.880  0.37890    
## Delayweek:GroupStudyTest  0.77633    0.09916   7.829 4.92e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) Delywk GrpStT
## Delayweek   -0.371              
## GropStdyTst -0.687  0.267       
## Dlywk:GrpST  0.252 -0.679 -0.371</code></pre>
</div>
<p class="solution-end">
</p>
<!-- You can also get some odds-ratios and quick confidence intervals using the following: -->
<!-- *Note, the `method = "Wald"` corresponds to a quick-and-easy method of calculating confidence intervals (simply $1.96 \times SE$). The gold standard for confidence intervals is `method = "boot"`, which obtains them via bootstrapping, but this will take too long!  -->
<!-- ```{r} -->
<!-- exp(fixef(m4)) -->
<!-- exp(confint(m4, method="Wald"))[8:11,] -->
<!-- ``` -->
<!-- No difference between groups on the immediate test.  -->
<!-- For the `StudyStudy` group, there was a decreased likelihood of getting an item correct on the follow-up test relative to the immediate test ($OR = 0.35, \text{95% CI} = [0.31, 0.40]$).   -->
<!-- For the The likelihood of correctly answering an item  -->
<div class="question-begin">
Question 9
</div>
<div class="question-body">
<p>Load the <strong>effects</strong> package, and try running this code:</p>
<pre class="r"><code>library(effects)
ef &lt;- as.data.frame(effect(&quot;Delay:Group&quot;, m3))</code></pre>
<p>What is <code>ef</code>? and how can you use it to plot the model-estimated condition means and variability?</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-77" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-77&#39;, &#39;sol-start-77&#39;)"></span>
</div>
<div id="sol-body-77" class="solution-body" style="display: none;">
<pre class="r"><code>ggplot(ef, aes(Delay, fit, color=Group)) + 
  geom_pointrange(aes(ymax=upper, ymin=lower), position=position_dodge(width = 0.2))+
  theme_classic() # just for a change :)</code></pre>
<p><img src="04_other_ranef_files/figure-html/unnamed-chunk-24-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<p class="solution-end">
</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 10
</div>
<div class="question-body">
<p>What should we do with this information? How can we apply test-enhanced learning to learning R and statistics?</p>
<p class="question-end">
</p>
</div>
<div class="solution-begin">
Solution <span id="sol-start-78" class="fa fa-plus solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-78&#39;, &#39;sol-start-78&#39;)"></span>
</div>
<div id="sol-body-78" class="solution-body" style="display: none;">
<p>You’ll get the benefits of test-enhanced learning if you try yourself before looking at the solutions! If you don’t test yourself, you’re more likely to forget it in the long run.</p>
</div>
<p class="solution-end">
</p>
</div>
<div id="suggested-readings-optional" class="section level1">
<h1>Suggested readings (optional)</h1>
<ul>
<li><a href="https://doi.org/10.1016/j.jml.2007.12.005">Baayen et al., 2008</a><br />
</li>
<li><a href="https://doi.org/10.1016/j.jml.2012.11.001">Barr et al., 2013</a><br />
</li>
<li><a href="https://doi.org/10.1016/j.jml.2017.01.001">Matuschek et al., 2017</a></li>
</ul>
<!-- Formatting -->
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>If you have an older version of <code>lme4</code>, then <code>allFit()</code> might not be directly available, and you will need to run the following: <code>source(system.file("utils", "allFit.R", package="lme4"))</code>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

<link rel="stylesheet" href="https://uoepsy.github.io/assets/css/ccfooter.css" />
<div class="ccfooter"></div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
