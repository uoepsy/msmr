<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Week 9 Exercises: Path Analysis &amp; Mediation – MSMR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>

function toggle_visibility(id1, id2) {

var e = document.getElementById(id1);

var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('jk-circle-right')) {

    f.classList.add('jk-circle-down')

    f.classList.remove('jk-circle-right')

} else {

    f.classList.add('jk-circle-right')

    f.classList.remove('jk-circle-down')

}

}

</script>



<!---<script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script>-->

<link href="site_libs/panelset-0.3.0/panelset.css" rel="stylesheet">

<script src="site_libs/panelset-0.3.0/panelset.js"></script>

<link rel="stylesheet" href="https://uoepsy.github.io/assets/css/ccfooter.css">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./09ex.html">Week 9 Exercises: Path Analysis &amp; Mediation</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MSMR</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra Exercises: Regression Refresher</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 1 Exercises: Intro to MLM</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 2 Exercises: Logistic and Longitudinal</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3 Exercises: Non-Linear Change</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 4 Exercises: Nested and Crossed</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 5 Exercises: Assumptions, Diagnostics, Writing up</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 7 Exercises: PCA &amp; EFA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 8 Exercises: CFA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09ex.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Week 9 Exercises: Path Analysis &amp; Mediation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 10 Exercises: Structural Equation Modelling (SEM)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 11 Exercises: More SEM!</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Additional</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PCA in 3D</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_qdata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Questionnaire Data Wrangling</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#education-and-salary" id="toc-education-and-salary" class="nav-link active" data-scroll-target="#education-and-salary">Education and Salary</a></li>
  <li><a href="#more-conduct-problems" id="toc-more-conduct-problems" class="nav-link" data-scroll-target="#more-conduct-problems">More Conduct Problems</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 9 Exercises: Path Analysis &amp; Mediation</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How does Path Analysis work?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The logic behind path analysis is to estimate a system of equations that best reproduce the covariance structure that we see in the data.</p>
<ol type="1">
<li>We specify our theoretical model of the world as a system of paths between variables that represent which variables influence which other variables. This is simply a diagramatic way of specifying a set of equations.
<ul>
<li>A single headed arrow from <span class="math inline">\(X \rightarrow Y\)</span> indicates that Y “listens to” X - if X changes, then Y will change accordingly (but not vice versa)</li>
<li>A double headed arrow between <span class="math inline">\(X \leftrightarrow Y\)</span> indicates that these two variables are related, not because one causes the other, but because there is some mechanism outside of our model that results in these two variables being associated.</li>
</ul></li>
<li>We collect data on the relevant variables and we observe a covariance matrix (i.e.&nbsp;how each variable covaries with every other variable).</li>
<li>We fit our model to the data, and evaluate how well our theoretical model (the estimated values for our path coefficients) can reproduce the observed covariance matrix.</li>
</ol>
<div class="sticky">
<p><strong>Terminology</strong></p>
<ul>
<li><strong>Exogenous variables</strong> are a bit like what we have been describing with words like “independent variable” or “predictor”. In a path diagram, they have no arrows coming into them from other variables in the system, but have paths <em>going out</em> to other variables.<br>
</li>
<li><strong>Endogenous variables</strong> are more like the “outcome”/“dependent”/“response” variables we are used to. They have some arrow coming into them from another variable in the system (and may also - but not necessarily - have paths going out from them).<br>
</li>
</ul>
</div>
<p><br></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
optional: The fun details!
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For Path Diagrams that meet a certain set of pre-requisites, we can use a cool technique called “Path Tracing” to move between the path estimates and the implied covariances between a set of variables. The process is much easier with correlations, so in the examples below everything is standardised to have a variance of 1, meaning that covariance == correlation.</p>
<p>For us to be able to do this, a Path Diagram must meet these criteria:</p>
<ul>
<li>The model has no two-way causal relations or feedback loops (e.g.&nbsp;A<span class="math inline">\(\rightarrow\)</span>B<span class="math inline">\(\rightarrow\)</span>C<span class="math inline">\(\rightarrow\)</span>A).<br>
</li>
<li>All relations are linear and additive.<br>
</li>
<li>‘causes’ are unitary (if A<span class="math inline">\(\rightarrow\)</span>B and A<span class="math inline">\(\rightarrow\)</span>C, then it is presumed that this is the same aspect of A resulting in a change in both B and C, and not two distinct aspects of A, which would be better represented by two correlated variables A1 and A2).<br>
</li>
<li>The variables are measured without error (we will relax this assumption later on by including latent variables).</li>
<li>Endogenous variables are not connected by correlations (we would correlate the residuals instead, because residuals are not endogenous).<br>
</li>
<li>The residuals (error terms) are uncorrelated with exogenous variables.<br>
</li>
<li>All our exogenous variables are correlated (unless we specifically assume that their correlation is zero).</li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
causality?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Path models allow us to reason about ‘cause and effect’ without having to conduct an experiment and manipulate a given variable. However, there is nothing special about the statistical machinery or techniques here that makes our results ‘causal’. The extent to which we can claim ‘causation’ is <em>entirely</em> theory dependent. That is, the use of ‘causal’ refers to an assumption that our analysis includes all relevant causal relations (and captures them appropriately). When we test these models, a good fitting model does <strong>not</strong> prove that the causal assumptions are correct.</p>
</div>
</div>
</div>
<p><strong>Path Tracing Rules</strong></p>
<p>Thanks to <a href="https://www.jstor.org/stable/pdf/2527551.pdf?casa_token=3QF0ad2ZoBcAAAAA:MbEkDNNdoLZr1SXE4LrnK--qrhhsTXLgsRtcWre1UvWxiQiGNUl5vWytGp34XIxhAYMZJe-MbIcBnEwXSfX6MAONevz04-sMXpEDI3IaYKk6mMX46QvX">Sewal Wright</a>, we can express the correlation between any two variables in the system as the sum of all <em>compound paths</em> between the two variables<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p><em>compound paths</em> are the products of any paths you can trace between A and B for which there are:</p>
<ul>
<li>no loops. If you are tracing from one variable to another, you cannot pass through the same variable twice in a particular path.</li>
<li>no going forward then backward (and no going forward then across a curved arrow)<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></li>
<li>maximum of one curved arrow per path</li>
</ul>
<p>If we look at our path diagram and find all the distinct routes to get from A to B that adhere to the 3 rules above, and sum these routes up, then we get the implied covariance between A and B. (routes are ‘distinct’ if they contain different coefficients, or encounter coefficients in a different order).</p>
<div class="panelset">
<section id="example-1" class="level4 panel">
<h4 class="anchored" data-anchor-id="example-1">Example 1</h4>
<p>Let’s consider the example below, for which the paths are all labelled with lower case letters <span class="math inline">\(a, b, c, \text{and } d\)</span>. In this case, we have two exogenous variables X1 and X2 that both influence a single outcome Y. This is actually just a multiple regression expressed as a path diagram!</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-patheq1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-patheq1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/patheq1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-patheq1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: A multiple regression model as a path diagram
</figcaption>
</figure>
</div>
</div>
</div>
<p>According to Wright’s tracing rules above, we can write out the equations corresponding to the 3 correlations between our observed variables (remember that <span class="math inline">\(r_{a,b} = r_{b,a}\)</span>, so it doesn’t matter at which variable we start the paths).</p>
<p>There is only one way to move between X1 and X2, according to Wright’s rules, and that is to go via the double headed arrow <span class="math inline">\(c\)</span>. There are two ways to go from X1 to Y - we can go across the double headed arrow to X2, and then go from X2 to y (path <span class="math inline">\(bc\)</span>), or we can go directly from X1 to Y (path <span class="math inline">\(a\)</span>). To get from X2 to Y, we can go either via X1 (path <span class="math inline">\(ac\)</span>), or go directly (path <span class="math inline">\(b\)</span>).</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>covariance</th>
<th>paths</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(r_{x1,x2}\)</span></td>
<td>c</td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{x1,y}\)</span></td>
<td>a + bc</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r_{x2,y}\)</span></td>
<td>b + ac</td>
</tr>
</tbody>
</table>
<p>Suppose that we fit this model to some data using something like our good friend maximum likelihood estimation, and we get some estimates for our path coefficients such as those below:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># our data:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>egdata <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/path_eg1.csv"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># our model formula</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>mod.formula <span class="ot">&lt;-</span> <span class="st">"y ~ x1 + x2"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fitted to some data</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>mod.est <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod.formula, <span class="at">data =</span> egdata)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># extract parameters:</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">parTable</span>(mod.est) <span class="sc">|&gt;</span> <span class="fu">select</span>(lhs,op,rhs,est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  lhs op rhs   est
1   y  ~  x1 0.612
2   y  ~  x2 0.382
3   y ~~   y 0.310
4  x1 ~~  x1 0.995
5  x1 ~~  x2 0.359
6  x2 ~~  x2 0.995</code></pre>
</div>
</div>
<p>With this set of path estimates (<span class="math inline">\(a = 0.61\)</span>, <span class="math inline">\(b = 0.38\)</span>, and <span class="math inline">\(c = 0.36\)</span>), we can calculate the correlation that is <em>implied</em> by our estimated model:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>covariance</th>
<th>paths</th>
<th>model implied correlation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(r_{x1,x2}\)</span></td>
<td>c</td>
<td><span class="math inline">\(0.36\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{x1,y}\)</span></td>
<td>a + bc</td>
<td><span class="math inline">\(0.61 + (0.38 \times 0.36) = 0.75\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r_{x2,y}\)</span></td>
<td>b + ac</td>
<td><span class="math inline">\(0.38 + (0.61 \times 0.36) = 0.60\)</span></td>
</tr>
</tbody>
</table>
<p>We can then examine how far off this is from the observed covariance matrix. In this specific case, our covariance matrix has 6 values in it, and we are estimating 6 things (see the parameters above). This means that there is unique solution, and our model is <strong>just-identified</strong> (or “saturated”), and is capable of <strong>perfectly</strong> reproducing the covariance matrix.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(egdata) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     x1   x2    y
x1 1.00 0.36 0.75
x2 0.36 1.00 0.60
y  0.75 0.60 1.00</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
why 6? the model in full
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The variances of individual variables (also covariances of each variable with itself) are also in our covariance matrix on the diagonals, and in full, our model also includes the estimation of variances of exogenous variables, as well as the residual variance of endogenous variables. These can be represented as the paths <span class="math inline">\(d\)</span>, <span class="math inline">\(e\)</span> and <span class="math inline">\(f\)</span> in <a href="#fig-patheq1a" class="quarto-xref">Figure&nbsp;2</a>.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>covariance</th>
<th>paths</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(r_{x1,x2}\)</span></td>
<td>c</td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{x1,y}\)</span></td>
<td>a + bc</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r_{x2,y}\)</span></td>
<td>b + ac</td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{x1,x1}\)</span></td>
<td>e</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r_{x2,x2}\)</span></td>
<td>f</td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{y,y}\)</span></td>
<td>d + a<span class="math inline">\(^2\)</span> + b<span class="math inline">\(^2\)</span> + acb + bca</td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-patheq1a" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-patheq1a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/patheq1a.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-patheq1a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: A multiple regression model as a path diagram with variances of exogenous variables and residuals indicated
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="example-2" class="level4 panel">
<h4 class="anchored" data-anchor-id="example-2">Example 2</h4>
<p>One benefit of a path model over a regression model is that we can include multiple endogenous variables. In <a href="#fig-patheq2" class="quarto-xref">Figure&nbsp;3</a>, we can see now a model in which we have two outcomes (Y1 and Y2), an exogenous predictor X, and a variable M that sits on the path between X and the two outcomes. In this case, M is itself an outcome of Z.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-patheq2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-patheq2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/patheq2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-patheq2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: A model with 2 outcomes
</figcaption>
</figure>
</div>
</div>
</div>
<p>Using the path tracing rules, there is only one way to get between X and M, and that is the path <span class="math inline">\(a\)</span>. There is only one way to get between M and Y1 (path <span class="math inline">\(b\)</span>), and only one way to get between M and Y2 (path <span class="math inline">\(c\)</span>). To get between X and Y1, we can only go via <span class="math inline">\(ab\)</span>, and to get between X and Y2, we can only go via <span class="math inline">\(ac\)</span>. To get between Y1 and Y2, we can go backwards to M and then forwards to Y2, the path <span class="math inline">\(bc\)</span>.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>covariance</th>
<th>paths</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(r_{x,m}\)</span></td>
<td>a</td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{m,y1}\)</span></td>
<td>b</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r_{m,y2}\)</span></td>
<td>c</td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{x,y1}\)</span></td>
<td>ab</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r_{x,y2}\)</span></td>
<td>ac</td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{y1,y2}\)</span></td>
<td>bc</td>
</tr>
</tbody>
</table>
<p>As with the previous example, we fit our model to some sample data, and get some estimates for the parameters:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># our data:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>egdata2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/path_eg2.csv"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># our model formula</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>mod.formula <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="st">y1 ~ m</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="st">y2 ~ m</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="st">m ~ x</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="st"># by default, lavaan will correlate the residual variance</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="st"># for the purposes of this example, to match our model exactly, </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="st"># we'll constrain it to 0:  </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="st">y1~~0*y2</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># fitted to some data</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>mod.est <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod.formula, <span class="at">data =</span> egdata2)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># extract parameters:</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">parTable</span>(mod.est) <span class="sc">|&gt;</span> <span class="fu">select</span>(lhs,op,rhs,est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  lhs op rhs   est
1  y1  ~   m 0.520
2  y2  ~   m 0.187
3   m  ~   x 0.461
4  y1 ~~  y2 0.000
5  y1 ~~  y1 0.728
6  y2 ~~  y2 0.963
7   m ~~   m 0.786
8   x ~~   x 0.998</code></pre>
</div>
</div>
<p>And the estimated path coefficients of <span class="math inline">\(a = 0.46\)</span>, <span class="math inline">\(b = 0.52\)</span> and <span class="math inline">\(c = 0.19\)</span>, imply that our covariances are:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>covariance</th>
<th>paths</th>
<th>model implied covariance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(r_{x,m}\)</span></td>
<td>a</td>
<td><span class="math inline">\(0.46\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{m,y1}\)</span></td>
<td>b</td>
<td><span class="math inline">\(0.52\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r_{m,y2}\)</span></td>
<td>c</td>
<td><span class="math inline">\(0.19\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{x,y1}\)</span></td>
<td>ab</td>
<td><span class="math inline">\(0.46 \times 0.52 = 0.24\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r_{x,y2}\)</span></td>
<td>ac</td>
<td><span class="math inline">\(0.46 \times 0.19 = 0.09\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{y1,y2}\)</span></td>
<td>bc</td>
<td><span class="math inline">\(0.52 \times 0.19 = 0.10\)</span></td>
</tr>
</tbody>
</table>
<p>Finally, our <strong>observed</strong> covariances are here:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(egdata2) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     y1   y2    m    x
y1 1.00 0.06 0.52 0.49
y2 0.06 1.00 0.19 0.06
m  0.52 0.19 1.00 0.46
x  0.49 0.06 0.46 1.00</code></pre>
</div>
</div>
<p>But wait.. unlike the first example, this one does <em>not</em> perfectly reproduce our the covariances we observe. This is because our model is <strong>over-identified</strong>. We are trying to recreate our covariance matrix with 10 values in it using only <strong>7</strong> unknown parameters. This is a good thing! It means we can assess the fit of the model to the data, and evaluate the plausibility of the proposed relationships!</p>
<p>Notably, some of our “model implied covariances” are quite different to those in our observed covariance matrix (e.g, the model implies that <span class="math inline">\(r_{x,y1} = 0.24\)</span>, but we actually observe it to be 0.49!).</p>
</section>
<section id="example-3" class="level4 panel">
<h4 class="anchored" data-anchor-id="example-3">Example 3</h4>
<p>In Example 2, our theoretical model proposed that <em>all</em> of the association that we might observe between X and Y1 is due to the relationship that X has with M, and that M in turn has with Y1. However, an alternative model (see <a href="#fig-patheq3" class="quarto-xref">Figure&nbsp;4</a>) could propose that X still directly influences Y1 beyond the influence it exerts via M. We would indicate this via an additional path (path <span class="math inline">\(g\)</span> in <a href="#fig-patheq3" class="quarto-xref">Figure&nbsp;4</a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-patheq3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-patheq3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/patheq3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-patheq3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: X now directly influences Y, as well as its influence via M
</figcaption>
</figure>
</div>
</div>
</div>
<p>Fitting this model (to the same data), we get out estimates for the paths (including this additional parameter):</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># our model formula</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mod.formula <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="st">y1 ~ m + x</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">y2 ~ m</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="st">m ~ x</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="st"># by default, lavaan will correlate the residual variance</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="st"># for the purposes of this example, to match our model exactly, </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="st"># we'll constrain it to 0:  </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="st">y1~~0*y2</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># fitted to the same data as for example 2</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>mod.est <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod.formula, <span class="at">data =</span> egdata2)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># extract parameters:</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">parTable</span>(mod.est) <span class="sc">|&gt;</span> <span class="fu">select</span>(lhs,op,rhs,est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  lhs op rhs   est
1  y1  ~   m 0.375
2  y1  ~   x 0.313
3  y2  ~   m 0.187
4   m  ~   x 0.461
5  y1 ~~  y2 0.000
6  y1 ~~  y1 0.651
7  y2 ~~  y2 0.963
8   m ~~   m 0.786
9   x ~~   x 0.998</code></pre>
</div>
</div>
<p>Our covariances between variables are, in this model, expressed as:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 52%">
<col style="width: 21%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>covariance</th>
<th>paths</th>
<th>model implied covariance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(r_{x,m}\)</span></td>
<td>a</td>
<td><span class="math inline">\(0.46\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{m,y1}\)</span></td>
<td>b + ag</td>
<td><span class="math inline">\(0.38 + (0.46 \times 0.31) = 0.52\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r_{m,y2}\)</span></td>
<td>c</td>
<td><span class="math inline">\(0.19\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{x,y1}\)</span></td>
<td>ab + g</td>
<td><span class="math inline">\((0.46 \times 0.38) + 0.31 = 0.49\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(r_{x,y2}\)</span></td>
<td>ac</td>
<td><span class="math inline">\(0.46 \times 0.19 = 0.09\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(r_{y1,y2}\)</span></td>
<td>bc + gac</td>
<td><span class="math inline">\((0.38 \times 0.19) + (0.31 \times 0.46 \times 0.19) = 0.10\)</span></td>
</tr>
</tbody>
</table>
<p>And now, when we look at our observed covariance matrix, we are doing a much better job of recreating it, than we did with the model from Example 2!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(egdata2) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     y1   y2    m    x
y1 1.00 0.06 0.52 0.49
y2 0.06 1.00 0.19 0.06
m  0.52 0.19 1.00 0.46
x  0.49 0.06 0.46 1.00</code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
</div>
<section id="education-and-salary" class="level1">
<h1>Education and Salary</h1>
<div class="frame">
<p>We sampled 500 people who were all 5 years out of their last year of education. All participants completed an extensive questionnaire to ascertain the number of and expertise in any skills that may be of potential interest to employers. This resulted in a “Skillset Metric”. 5 years later, participants were followed up and asked to provide their current salaries. 110 participants failed to respond to follow-ups and thus the final sample included 390 people.</p>
<p>The data are available at <a href="https://uoepsy.github.io/data/edskill.csv" target="_blank">https://uoepsy.github.io/data/edskill.csv</a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fgbjnpxgpo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fgbjnpxgpo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fgbjnpxgpo thead, #fgbjnpxgpo tbody, #fgbjnpxgpo tfoot, #fgbjnpxgpo tr, #fgbjnpxgpo td, #fgbjnpxgpo th {
  border-style: none;
}

#fgbjnpxgpo p {
  margin: 0;
  padding: 0;
}

#fgbjnpxgpo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fgbjnpxgpo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fgbjnpxgpo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fgbjnpxgpo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fgbjnpxgpo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fgbjnpxgpo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fgbjnpxgpo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fgbjnpxgpo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fgbjnpxgpo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fgbjnpxgpo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fgbjnpxgpo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fgbjnpxgpo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fgbjnpxgpo .gt_spanner_row {
  border-bottom-style: hidden;
}

#fgbjnpxgpo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fgbjnpxgpo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fgbjnpxgpo .gt_from_md > :first-child {
  margin-top: 0;
}

#fgbjnpxgpo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fgbjnpxgpo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fgbjnpxgpo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fgbjnpxgpo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fgbjnpxgpo .gt_row_group_first td {
  border-top-width: 2px;
}

#fgbjnpxgpo .gt_row_group_first th {
  border-top-width: 2px;
}

#fgbjnpxgpo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fgbjnpxgpo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fgbjnpxgpo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fgbjnpxgpo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fgbjnpxgpo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fgbjnpxgpo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fgbjnpxgpo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fgbjnpxgpo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fgbjnpxgpo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fgbjnpxgpo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fgbjnpxgpo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fgbjnpxgpo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fgbjnpxgpo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fgbjnpxgpo .gt_left {
  text-align: left;
}

#fgbjnpxgpo .gt_center {
  text-align: center;
}

#fgbjnpxgpo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fgbjnpxgpo .gt_font_normal {
  font-weight: normal;
}

#fgbjnpxgpo .gt_font_bold {
  font-weight: bold;
}

#fgbjnpxgpo .gt_font_italic {
  font-style: italic;
}

#fgbjnpxgpo .gt_super {
  font-size: 65%;
}

#fgbjnpxgpo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fgbjnpxgpo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fgbjnpxgpo .gt_indent_1 {
  text-indent: 5px;
}

#fgbjnpxgpo .gt_indent_2 {
  text-indent: 10px;
}

#fgbjnpxgpo .gt_indent_3 {
  text-indent: 15px;
}

#fgbjnpxgpo .gt_indent_4 {
  text-indent: 20px;
}

#fgbjnpxgpo .gt_indent_5 {
  text-indent: 25px;
}

#fgbjnpxgpo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fgbjnpxgpo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">variable</th>
<th id="description" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">description</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="variable">Educ</td>
<td class="gt_row gt_left" headers="description">Number of years of education undertaken</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">Skill</td>
<td class="gt_row gt_left" headers="description">Skillset metric (standardised score obtained via a 100 item questionnaire measuring the number of, and expertise in, any skills deemed relevant to employers)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">Salary</td>
<td class="gt_row gt_left" headers="description">Salary (in thousands of £)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div class="question-begin">
Question 1
</div>
<div class="question-body">
<p>Read in the dataset.<br>
Let’s suppose that the only statistical machinery available to us is the good old regression models with <code>lm()</code>, and we are interested in the estimated effect of education on salary.</p>
<p>Which model are you going to fit?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Salary <span class="sc">~</span> Educ, <span class="at">data =</span> ... )</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Salary <span class="sc">~</span> Skill <span class="sc">+</span> Educ, <span class="at">data =</span> ... )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-1" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-1', 'sol-start-1')">
Solution
</button>
</div>
<div id="sol-body-1" class="solution-body proof solution" style="display: none;">
<p><span class="proof-title"><em>Solution 1</em>. </span>Here’s the data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>edskill <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/edskill.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I’m going to fit both models so that we can discuss them below</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Salary <span class="sc">~</span> Educ, <span class="at">data =</span> edskill)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Salary <span class="sc">~</span> Skill <span class="sc">+</span> Educ, <span class="at">data =</span> edskill)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># model tables side by side</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(m1,m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Salary</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Salary</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">22.88</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">16.96&nbsp;–&nbsp;28.80</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">32.06</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">25.37&nbsp;–&nbsp;38.75</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Educ</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.07</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.70&nbsp;–&nbsp;1.45</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.48</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.06&nbsp;–&nbsp;0.91</td>
<td style="text-align: center;"><strong>0.026</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">Skill</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">3.57</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">2.23&nbsp;–&nbsp;4.91</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">390</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">390</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.076 / 0.073</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.137 / 0.132</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>So we have got two quite different pictures. The first model says that for every additional year of education, the salary offered would be £1070 more. The second model says it would only be £480 more, and it looks like skills are a lot more important than education is for getting a good salary, right?</p>
<p>But this makes it sound like Education and Skills are things that we can compare the effects of independently. The implicit model we are referring to when using <code>lm(Salary ~ Skill + Educ)</code> is in the left hand diagram, Model A, of <a href="#fig-educ" class="quarto-xref">Figure&nbsp;5</a>. But does it not make a lot more sense to think that Education is a cause of peoples’ skill level (especially as the skill level being measured 5 years after their last year of education precludes the opposite direction). In other words, does Model B in <a href="#fig-educ" class="quarto-xref">Figure&nbsp;5</a> not make more sense?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-educ" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-educ-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/path_educ.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-educ-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Two theoretical models of process that gives rise to the data
</figcaption>
</figure>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:80%;">
<p>What Model B suggests is that part of <em>how</em> education influences peoples’ salaries is by giving them more skills. A perfect example is that you are all now on your way to becoming proficient R users!</p>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:15%;">
<p><img src="images/new-skill-unlocked.gif" class="img-fluid"></p>
</div>
</div>
<p>This is a great example that illustrates instances we might <strong>not</strong> want to include a variable in our model. If you are interested in “what does having an extra year of education do for peoples’ salaries?”, then controlling for skill in our model actually <em>removes</em> that part of the mechanism by which education influences salary.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
another example
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To make this point super clear, suppose we were testing some drug that reduces blood pressure in order to lower the risk of cardiac arrest. We do an experiment where we gave some people the drug, and some people a placebo, then after a year we measured their blood pressure, and then we followed up 5 years later to see how many experienced cardiac arrests.</p>
<p>The diagram to show how these variable relate is clearly the one in <a href="#fig-pathdrugmed" class="quarto-xref">Figure&nbsp;6</a></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pathdrugmed" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pathdrugmed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/path_drug.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pathdrugmed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: A drug aimed at reducing cardiac arrests by lowering blood pressure. The faint grey line indicates the path that would be estimated if we attempted to control for post-treatment blood-pressure
</figcaption>
</figure>
</div>
</div>
</div>
<p>If we fitted the model <code>lm(cardiac_arrest ~ blood_pressure + drug)</code>, then the estimated coefficient we get for <code>drug</code> will be the effect of the drug on cardiac arrests that <em>isn’t</em> due to how it changes blood pressure. But that is exactly the opposite of what we want, because we think the drug works specifically by lowering blood pressure!</p>
<p>Contrast this with another example, where we do not run an experiment and allocate people into “drug” or “placebo”, we simply observe a whole load of people who either do or do not take the drug, and we follow them up to see how many have cardiac arrests. <strong>But</strong>, it is generally older people who take the drug, whereas younger people do not. In addition, older people have a higher risk of cardiac arrests. So our model is that seen in <a href="#fig-pathdrugcon" class="quarto-xref">Figure&nbsp;7</a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pathdrugcon" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pathdrugcon-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/path_drug_con.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pathdrugcon-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: We are interested in a drug aimed at reducing cardiac arrests. Older people are more likely to take the drug, and are also more likely to experience cardiac arrest
</figcaption>
</figure>
</div>
</div>
</div>
<p>In this case, controlling for the third variable <code>age</code> is the right thing to do.<br>
If we do not control for age, and fit the model <code>lm(cardiac_arrest ~ drug)</code>, then the coefficient for <code>drug</code> will be biased because the group who take the drug are on average older, and thus will tend to experience more cardiac arrests. If the imbalance of age between the drug and no-drug groups is great enough, it could even look like the drug is making cardiac arrests <em>more</em> likely!</p>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 2
</div>
<div class="question-body">
<p>Instead, let’s suppose we are actually interested in the mechanism of <em>how</em> education influences salary. Do more educated people tend to have higher salaries in part because of the skills obtained during their education?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Direct, Indirect and Total effects
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In path diagrams:</p>
<ul>
<li>Direct effect = one single-headed arrow between the two variables concerned<br>
</li>
<li>Indirect effect = An effect transmitted via some other variables</li>
</ul>
<p>If we have a variable <span class="math inline">\(X\)</span> that we take to ‘cause’ variable <span class="math inline">\(Y\)</span>, then our path diagram will look like <a href="#fig-total" class="quarto-xref">Figure&nbsp;8</a>, which path <span class="math inline">\(c\)</span> is the <strong>total effect</strong>. This is the <em>unmediated</em> effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-total" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-total-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/MED1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-total-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: The total effect of X on Y
</figcaption>
</figure>
</div>
</div>
</div>
<p>However, the effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> could in part be explained by the process of being mediated by some variable <span class="math inline">\(M\)</span> as well as affecting <span class="math inline">\(Y\)</span> directly. A path diagram representing this theoretical idea of ‘mediation’ is shown in <a href="#fig-indirect" class="quarto-xref">Figure&nbsp;9</a>. In this case, path <span class="math inline">\(c'\)</span> is the <strong>direct effect</strong>, and paths <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> make up the <strong>indirect effect</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-indirect" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-indirect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/MED2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-indirect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: The effect of X on Y is partly mediated by M
</figcaption>
</figure>
</div>
</div>
</div>
<p>You will find in some areas people talk about the ideas of <strong>“complete”</strong> vs <strong>“partial”</strong> mediation.</p>
<ul>
<li><strong>Complete mediation</strong> is when <span class="math inline">\(X\)</span> does not influence <span class="math inline">\(Y\)</span> other than its influence through <span class="math inline">\(M\)</span> (therefore path <span class="math inline">\(c'\)</span> would not be significantly different from zero).</li>
<li><strong>Partial mediation</strong> is when the path from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span> is <em>reduced in magnitude</em> when the mediator <span class="math inline">\(M\)</span> is introduced, <em>but still different from zero.</em><br>
</li>
<li>The <strong>Proportion Mediated</strong> is the amount of the total effect of <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span> that goes via <span class="math inline">\(M\)</span>. i.e.&nbsp;<span class="math inline">\(\frac{a \times b}{c}\)</span> in the images above.</li>
</ul>
</div>
</div>
</div>
<p>Fit a path model in which education has an effect on salary both directly and indirectly, via its influence on the skills obtained.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A path model is essential a <em>set</em> of equations. We can do this similarly these models similarly to how we estimated factor models using the <strong>lavaan</strong> package, but instead of <code>cfa()</code> we use the function <code>sem()</code> to fit the models.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mod.formula <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="st">y1 ~ x1 + x2 + x3</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="st">y2 ~ x1</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="st">x1 ~ x3</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>mod.est <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod.formula, <span class="at">data =</span> mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-2" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-2', 'sol-start-2')">
Solution
</button>
</div>
<div id="sol-body-2" class="solution-body proof solution" style="display: none;">
<p><span class="proof-title"><em>Solution 2</em>. </span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="st">Salary ~ Educ + Skill</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="st">Skill ~ Educ</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>mod1.est <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod1, <span class="at">data =</span> edskill)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1.est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                           390

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  Salary ~                                            
    Educ              0.482    0.215    2.239    0.025
    Skill             3.568    0.679    5.255    0.000
  Skill ~                                             
    Educ              0.166    0.014   12.128    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .Salary          130.237    9.326   13.964    0.000
   .Skill             0.724    0.052   13.964    0.000</code></pre>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 3
</div>
<div class="question-body">
<p>While the model in the previous question better reflects our theoretical notions of how these variables are actually related, we would ideally get out an estimate of the indirect effect.</p>
<div class="columns">
<div class="column" style="width:60%;">
<p>That is, we want to test the estimated path from X to Y through M. Typically, this is done by calculating the <em>product</em> of the sub-component paths. This would be <span class="math inline">\(a \times b\)</span> in the image to the right.</p>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:35%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/MED2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>Taking the product makes some intuitive sense, as if either one were zero then the product would be zero, indicating no effect. You can find a nice explanation from Aja of why exactly we take the product <a href="https://uoepsy.github.io/msmr/indirect_effects.pdf">here</a>).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defined Parameters in lavaan
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To specifically test the indirect effect, we need to explicitly <strong>define</strong> the indirect effect in our model, by first creating a label for each of its sub-component paths, and then defining the indirect effect itself as the product of these two paths.</p>
<p>To do this, we use a new operator, <code>:=</code>.</p>
<p><em>“This operator ‘defines’ new parameters which take on values that are an arbitrary function of the original model parameters. The function, however, must be specified in terms of the parameter labels that are explicitly mentioned in the model syntax.”</em> <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.<br>
The labels are entirely up to us, we can use “a”, “b” and “c”, or “dougal”, “dylan” and “ermintrude”, they’re just labels!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>med_model <span class="ot">&lt;-</span> <span class="st">" </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="st">    Y ~ b*M + c*X</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="st">    M ~ a*X</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="st">    indirect := a*b</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="st">    total := a*b + c</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Edit your model formula from the previous question to also estimate both the total and the indirect effects.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-3" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-3', 'sol-start-3')">
Solution
</button>
</div>
<div id="sol-body-3" class="solution-body proof solution" style="display: none;">
<p><span class="proof-title"><em>Solution 3</em>. </span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="st">Salary ~ c*Educ + b*Skill</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="st">Skill ~ a*Educ</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="st">indirect := a*b</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="st">total := a*b + c</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 4
</div>
<div class="question-body">
<p>Re-fit the model, estimating the parameters using bootstrapping.<br>
Is the association between education and salary mediated by skills? What proportion of the effect is mediated?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why Bootstrap?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We are computing our indirect effect as the <em>product</em> of the sub-component paths. However, this results in the estimated indirect effect rarely following a normal distribution, and makes our usual analytically derived standard errors &amp; p-values inappropriate.</p>
<p>Instead, bootstrapping has become the norm for assessing sampling distributions of indirect effects in mediation models (remember, bootstrapping involves resampling the data with replacement, thousands of times, in order to empirically generate a sampling distribution).</p>
<p>We can do this easily in lavaan:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mod.est <span class="ot">&lt;-</span> <span class="fu">sem</span>(model_formula, <span class="at">data=</span>my_data, <span class="at">se =</span> <span class="st">"bootstrap"</span>) </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># to print out the confidence intervals:</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.est, <span class="at">ci =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-4" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-4', 'sol-start-4')">
Solution
</button>
</div>
<div id="sol-body-4" class="solution-body proof solution" style="display: none;">
<p><span class="proof-title"><em>Solution 4</em>. </span>Note that we get a warning here, but it’s not too much to worry about. It tells us that 8 (out of 1000) of the bootstraps has failed to converge. This means our bootstrapped estimates are really based on 992 bootstrap draws (and so a write up would need to clearly report this).<br>
If this number was bigger (e.g.&nbsp;10% or 20% of the bootstraps failed) then we it would be more of a cause for concern.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mod1.est <span class="ot">&lt;-</span> <span class="fu">sem</span>(mod1, <span class="at">data =</span> edskill, <span class="at">se =</span> <span class="st">"bootstrap"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p style="color:red;font-size:0.8em">
Warning message:<br> In lav_model_nvcov_bootstrap(lavmodel = lavmodel, lavsamplestats = lavsamplestats, :<br> lavaan WARNING: 8 bootstrap runs failed or did not converge.
</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1.est, <span class="at">ci =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                           390

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws             1000
  Number of successful bootstrap draws             992

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
  Salary ~                                                              
    Educ       (c)    0.482    0.217    2.219    0.027    0.043    0.899
    Skill      (b)    3.568    0.694    5.142    0.000    2.223    4.949
  Skill ~                                                               
    Educ       (a)    0.166    0.013   12.663    0.000    0.139    0.193

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
   .Salary          130.237   10.239   12.720    0.000  109.272  149.353
   .Skill             0.724    0.050   14.606    0.000    0.632    0.825

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
    indirect          0.592    0.118    5.028    0.000    0.366    0.828
    total             1.073    0.189    5.677    0.000    0.687    1.425</code></pre>
</div>
</div>
<p>The relationship between education and salary <strong>is</strong> mediated by skill level! We have a significant indirect effect of 0.59, 95% CI [0.37, 0.83].</p>
<p>The total effect of education on salary is 1.07, and the indirect effect is 0.59.<br>
<span class="math inline">\(\frac{0.59}{1.07} = 0.55\)</span>, so 55% of the effect is mediated by the influence that education has on skillset and skillset has on salary.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
optional: Y increases by 0.59 when what?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Typically people go no further in their interpretation of this coefficient than “The effect of X on Y through M”.</p>
<p>If you want to make this more explicit, the indirect effect estimate is the amount by which the outcome Y changes when the predictor X is held constant, and the mediator M changes by however much it <em>would have changed</em> had the predictor increased by one.</p>
<p>We can see this a bit clearer if we write down the prediction equations for Skill and Salary, and then see how it changes when we move from Education = 0 to Education = 1.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 37%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>Educ</th>
<th>Skill</th>
<th>Salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td><span class="math inline">\(= (a \times Educ)\)</span></td>
<td><span class="math inline">\(= (c' \times Educ) + (b \times Skill)\)</span></td>
</tr>
<tr class="even">
<td>0</td>
<td><span class="math inline">\(= (0.166 \times Educ)\)</span><br><span class="math inline">\(= (0.166 \times 0)\)</span><br><span class="math inline">\(= 0\)</span></td>
<td><span class="math inline">\(= (0.482 \times Educ) + (3.568 \times Skill)\)</span><br><span class="math inline">\(= (0.482 \times 0) + (3.568 \times 0)\)</span><br><span class="math inline">\(= 0\)</span></td>
</tr>
<tr class="odd">
<td>1</td>
<td><span class="math inline">\(= (0.166 \times Educ)\)</span><br><span class="math inline">\(= (0.166 \times 1)\)</span><br><span class="math inline">\(= 0.166\)</span></td>
<td><span class="math inline">\(= (0.482 \times Educ) + (3.568 \times Skill)\)</span><br><span class="math inline">\(= (0.482 \times 1) + (3.568 \times 0.166)\)</span><br><span class="math inline">\(= (0.482) + (0.59)\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 5
</div>
<div class="question-body">
<p>In order for us to accurately estimate mediation effects, a few conditions have to be met.</p>
<ul>
<li><strong>Causal direction:</strong> Doing mediation analysis on cross-sectional data (variables collected all at the same time) is commonly done, but is almost always a bad idea. X<span class="math inline">\(\rightarrow\)</span>M<span class="math inline">\(\rightarrow\)</span>Y will fit your data just as well as X<span class="math inline">\(\rightarrow\)</span>Y<span class="math inline">\(\rightarrow\)</span>M or Y<span class="math inline">\(\rightarrow\)</span>M<span class="math inline">\(\rightarrow\)</span>X!</li>
<li><strong>Perfect reliability of M:</strong> The mediator is measured without error</li>
<li><strong>No X-M interaction:</strong> The effect of the mediator M on the outcome Y does not depend on the level of the predictor X.</li>
<li><strong>No confounding:</strong> A variable that is a common cause of both X and Y will bias the total and direct effects, and a variable that is a common cause of both X and M will bias the indirect effect (it will bias the X<span class="math inline">\(\rightarrow\)</span>M path). Randomised experiments (i.e.&nbsp;randomly allocating people to different values of X) will avoid the first two, because nothing but the random allocation would cause X. However, confounding of the indirect effect can also happen if some variable is a common cause of both M and Y, and it is hard to randomly allocate to a mediator<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</li>
</ul>
<p>Think of two unmeasured variables that could be in the place of the variables indicated by <code>?</code> in <a href="#fig-blanks" class="quarto-xref">Figure&nbsp;10</a> and may be confounding our estimates.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-blanks" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-blanks-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/path_educ_conf_blank.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-blanks-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: fill in the blanks!
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-5" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-5', 'sol-start-5')">
Solution
</button>
</div>
<div id="sol-body-5" class="solution-body proof solution" style="display: none;">
<p><span class="proof-title"><em>Solution 5</em>. </span>Here are my suggestions. Even if we don’t believe that it <em>should</em>, something like “socioeconomic status” can likely influence both peoples’ levels of education (people from wealthier backgrounds have more access to more years of education) and their eventual salary (social connections might lead to better paying jobs, etc.).<br>
Similarly, aspects of peoples’ employment post-education will influence the skills they have <em>and</em> their salary. For instance, some people might leave education and go into private industry jobs with lots of options for on-the-job training and ‘upskilling’. These jobs might also generally pay higher salaries!</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/path_educ_conf_example.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<!-- 

<div class='question-begin'>Question 6</div><div class='question-body'>

 -->
<!-- Thinking point (no need to _do_ anything) - what would an "X-M interaction" look like in this example? -->
<!-- 

</div><p class="question-end"></p>

 -->
<!-- 

<div class="solution-begin"><button id='sol-start-6' class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-6', 'sol-start-6')">  Solution </button></div><div class="solution-body" id = "sol-body-6" style="display: none;">

 -->
<!-- In our example of Educ$\rightarrow$Skill$\rightarrow$Salary, the "X-M interaction" would refer to if skills has a different effect on salary depending on the level of education. -->
<!-- Intuitively to me this actually seems like a pretty important point here. Skills may well have a bigger bearing on salaries for people with lower levels of education. i.e., something like this:  -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- tibble( -->
<!--   Educ = sample(c("low","high"),500,T), -->
<!--   Skill = rnorm(500,(Educ=="high")*1), -->
<!--   Salary = (Educ=="high")*.5 + Skill*3.5 + -->
<!--     -2*(Educ=="high")*Skill -->
<!-- ) |>  -->
<!--   ggplot(aes(x=Skill,y=Salary,col=Educ))+ -->
<!--   stat_smooth(method="lm",se=F) -->
<!-- ``` -->
<!-- 

</div><p class="solution-end"></p>

 -->
<p><br></p>
</section>
<section id="more-conduct-problems" class="level1">
<h1>More Conduct Problems</h1>
<div class="frame">
<p><strong>Dataset: cprobteach.csv</strong></p>
<p>Thus far, we have explored the underlying structure of a scale of adolescent ‘conduct problems’ <a href="07ex.html#conduct-problems" target="_blank">(PCA &amp; EFA exercises)</a> and we then tested this measurement model when the scale was administered to a further sample <a href="08ex.html#conduct-problems" target="_blank">(CFA exericses)</a>.</p>
<p>This week, we are looking at whether there are associations between conduct problems (both aggressive and non-aggressive) and academic performance and whether the relations are mediated by the quality of relationships with teachers. We collected data on 557 adolescents as they entered school. Their responses to the conduct problem scale were averaged and scaled to create a standardised score. Two years later, we followed up these students, and obtained measures of Academic performance and of their relationship quality with their teachers. Standardised scale scores were created for both of these measures.</p>
<p>The data are available at <a href="https://uoepsy.github.io/data/cprobteach.csv" target="_blank">https://uoepsy.github.io/data/cprobteach.csv</a></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="ibpmllesrk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ibpmllesrk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ibpmllesrk thead, #ibpmllesrk tbody, #ibpmllesrk tfoot, #ibpmllesrk tr, #ibpmllesrk td, #ibpmllesrk th {
  border-style: none;
}

#ibpmllesrk p {
  margin: 0;
  padding: 0;
}

#ibpmllesrk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ibpmllesrk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ibpmllesrk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ibpmllesrk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ibpmllesrk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ibpmllesrk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibpmllesrk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ibpmllesrk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ibpmllesrk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ibpmllesrk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ibpmllesrk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ibpmllesrk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ibpmllesrk .gt_spanner_row {
  border-bottom-style: hidden;
}

#ibpmllesrk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ibpmllesrk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ibpmllesrk .gt_from_md > :first-child {
  margin-top: 0;
}

#ibpmllesrk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ibpmllesrk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ibpmllesrk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ibpmllesrk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ibpmllesrk .gt_row_group_first td {
  border-top-width: 2px;
}

#ibpmllesrk .gt_row_group_first th {
  border-top-width: 2px;
}

#ibpmllesrk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibpmllesrk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ibpmllesrk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ibpmllesrk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibpmllesrk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibpmllesrk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ibpmllesrk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ibpmllesrk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ibpmllesrk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ibpmllesrk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ibpmllesrk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibpmllesrk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ibpmllesrk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ibpmllesrk .gt_left {
  text-align: left;
}

#ibpmllesrk .gt_center {
  text-align: center;
}

#ibpmllesrk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ibpmllesrk .gt_font_normal {
  font-weight: normal;
}

#ibpmllesrk .gt_font_bold {
  font-weight: bold;
}

#ibpmllesrk .gt_font_italic {
  font-style: italic;
}

#ibpmllesrk .gt_super {
  font-size: 65%;
}

#ibpmllesrk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ibpmllesrk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ibpmllesrk .gt_indent_1 {
  text-indent: 5px;
}

#ibpmllesrk .gt_indent_2 {
  text-indent: 10px;
}

#ibpmllesrk .gt_indent_3 {
  text-indent: 15px;
}

#ibpmllesrk .gt_indent_4 {
  text-indent: 20px;
}

#ibpmllesrk .gt_indent_5 {
  text-indent: 25px;
}

#ibpmllesrk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ibpmllesrk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">variable</th>
<th id="description" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">description</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="variable">ID</td>
<td class="gt_row gt_left" headers="description">participant ID</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">Acad</td>
<td class="gt_row gt_left" headers="description">Academic performance (standardised score based on all available assessments)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">Teach_r</td>
<td class="gt_row gt_left" headers="description">Teacher relationship quality (standardised score based on the Teacher-Child-Relationship (TCR) scale)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="variable">Non_agg</td>
<td class="gt_row gt_left" headers="description">Non-Aggressive conduct problems (standardised score score based on items 1-5 of the 10 item conduct problems scale)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="variable">Agg</td>
<td class="gt_row gt_left" headers="description">Aggressive conduct problems (standardised score score based on items 6-10 of the 10 item conduct problems scale)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div class="question-begin">
Question 7
</div>
<div class="question-body">
<p>As a little exercise before we get started, let’s just show ourselves that we can use <strong>lavaan</strong> to estimate all sorts of models, including a multiple regression model.</p>
<p>The code below fits the same model using <code>sem()</code> and using <code>lm()</code>. Examine the <code>summary()</code> output for both models, and spot the similarities.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in data</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>cp_teach<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/cprobteach.csv"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># a straightforward multiple regression model</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>m1_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Acad <span class="sc">~</span> Non_agg <span class="sc">+</span> Agg, <span class="at">data =</span> cp_teach)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the same model fitted in lavaan</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>m1_lav <span class="ot">&lt;-</span> <span class="st">'Acad ~ Non_agg + Agg'</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>m1_lav.est <span class="ot">&lt;-</span> <span class="fu">sem</span>(m1_lav, <span class="at">data =</span> cp_teach)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-7" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-7', 'sol-start-7')">
Solution
</button>
</div>
<div id="sol-body-7" class="solution-body proof solution" style="display: none;">
<p><span class="proof-title"><em>Solution 6</em>. </span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Acad ~ Non_agg + Agg, data = cp_teach)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.89617 -0.59575  0.00731  0.62189  3.13248 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.63659    0.15536  10.534  &lt; 2e-16 ***
Non_agg     -0.18238    0.05755  -3.169  0.00161 ** 
Agg         -0.31809    0.05697  -5.583  3.7e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9737 on 554 degrees of freedom
Multiple R-squared:  0.1937,    Adjusted R-squared:  0.1908 
F-statistic: 66.54 on 2 and 554 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1_lav.est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         3

  Number of observations                           557

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  Acad ~                                              
    Non_agg          -0.182    0.057   -3.178    0.001
    Agg              -0.318    0.057   -5.599    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .Acad              0.943    0.057   16.688    0.000</code></pre>
</div>
</div>
<p>We can see that both non-aggressive and aggressive conduct problems significantly predict academic performance. The coefficients from the <code>lm()</code> are exactly the same as the estimates under the “Regressions” section of the model fitted with <code>sem()</code>.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 8
</div>
<div class="question-body">
<p>Now specify in lavaan a model in which non-aggressive conduct problems have both a direct and indirect effect (via teacher relationships) on academic performance.</p>
<p>Sketch the path diagram on a piece of paper, or use a website like <a href="https://semdiag.psychstat.org/" target="_blank">https://semdiag.psychstat.org/</a> or <a href="https://www.diagrams.net/" target="_blank">https://www.diagrams.net/</a>.</p>
<p>Make sure to define the indirect effect in order to test the hypothesis that non-aggressive conduct problems have both a direct and an indirect effect (via teacher relationships) on academic performance. Specify also the total (direct+indirect) effect of non-aggressive conduct problems on academic performance</p>
<p>Estimate the model by bootstrapping and examine the 95% CI.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-8" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-8', 'sol-start-8')">
Solution
</button>
</div>
<div id="sol-body-8" class="solution-body proof solution" style="display: none;">
<p><span class="proof-title"><em>Solution 7</em>. </span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/msmr-w8-a.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>model1<span class="ot">&lt;-</span><span class="st">'</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="st">    # regress academic performance on non-aggressive conduct problems </span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="st">    # (the direct effect)</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="st">    Acad ~ c*Non_agg  </span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="st">    # regress academic peformance on teacher relationship quality</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="st">    Acad ~ b*Teach_r</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="st">    # regress teacher relationship quality on non-aggressive conduct problems</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="st">    Teach_r ~ a*Non_agg  </span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="st">    ind := a*b   </span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="st">    total := c + a*b </span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model estimation</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>model1.est <span class="ot">&lt;-</span> <span class="fu">sem</span>(model1, <span class="at">data=</span>cp_teach, <span class="at">se=</span><span class="st">'bootstrap'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># examine output</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1.est, <span class="at">ci=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                           557

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws             1000
  Number of successful bootstrap draws            1000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
  Acad ~                                                                
    Non_agg    (c)   -0.158    0.059   -2.683    0.007   -0.272   -0.041
    Teach_r    (b)    0.328    0.050    6.501    0.000    0.230    0.430
  Teach_r ~                                                             
    Non_agg    (a)   -0.769    0.032  -23.672    0.000   -0.834   -0.708

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
   .Acad              0.919    0.057   16.215    0.000    0.810    1.031
   .Teach_r           0.713    0.040   17.742    0.000    0.627    0.787

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
    ind              -0.252    0.039   -6.477    0.000   -0.330   -0.175
    total            -0.410    0.044   -9.306    0.000   -0.498   -0.330</code></pre>
</div>
</div>
<div class="red">
<p><strong>Note</strong></p>
<p>The confidence intervals computed using bootstrapping may be slightly different for you. This is normal, as bootstrap is based on random sampling!</p>
</div>
<p>We can see that the 95% bootstrapped confidence interval for the indirect effect of non-aggressive conduct problems on academic performance (‘ind’) does not include zero. We can conclude that the indirect effect is significant at <span class="math inline">\(\alpha = .05\)</span>. The direct effect is also statistically significant.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 9
</div>
<div class="question-body">
<p>Now visualise the estimated model and its parameters using the <code>semPaths()</code> function from the <strong>semPlot</strong> package.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-9" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-9', 'sol-start-9')">
Solution
</button>
</div>
<div id="sol-body-9" class="solution-body proof solution" style="display: none;">
<p><span class="proof-title"><em>Solution 8</em>. </span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to include the parameter estimates we set what='est'</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model1.est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="09ex_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 10
</div>
<div class="question-body">
<p>Make a new sketch for a model in which <strong>both</strong> aggressive and non-aggressive conduct problems have indirect (via teacher relationships) and direct effects on academic performance.</p>
<p>Now specify the model in R, taking care to also define the parameters for the indirect and total effects.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>you’ll need more labels than just a, b, and c!</p>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-10" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-10', 'sol-start-10')">
Solution
</button>
</div>
<div id="sol-body-10" class="solution-body proof solution" style="display: none;">
<p><span class="proof-title"><em>Solution 9</em>. </span>There are many ways in which you could position the variables in your diagram, so the two path diagrams below are equivalent:</p>
<section id="section" class="level2 unnumbered tabset">
<h2 class="unnumbered tabset anchored" data-anchor-id="section"></h2>
<section id="option-a" class="level3">
<h3 class="anchored" data-anchor-id="option-a">Option A</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/msmr-w8-b1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="option-b" class="level3">
<h3 class="anchored" data-anchor-id="option-b">Option B</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/msmr-w8-b2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="section-1" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="section-1"></h2>
<p>We now have two predictors, one mediator and one outcome (and two indirect effects, one for each predictor). We can represent this in two lines: one where we specify academic performance as the outcome variable and one where we specify teacher relationships (the mediator) as the outcome variable.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="st">    Acad ~ c_A*Agg + c_NA*Non_agg + b*Teach_r</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="st">    Teach_r ~ a_A*Agg + a_NA*Non_agg</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="st">    #indirect effect for aggressive conduct problems</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="st">    ind_agg := a_A*b </span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="st">    #indirect effect for non-aggressive conduct problems</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="st">    ind_nonagg := a_NA*b </span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="st">    # total effects</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="st">    tot_agg := a_A*b + c_A</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="st">    tot_nonagg := a_NA*b + c_NA</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 11
</div>
<div class="question-body">
<p>Now estimate the model and test the significance of the indirect effects</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-11" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-11', 'sol-start-11')">
Solution
</button>
</div>
<div id="sol-body-11" class="solution-body proof solution" style="display: none;">
<p><span class="proof-title"><em>Solution 10</em>. </span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>model2.est<span class="ot">&lt;-</span><span class="fu">sem</span>(model2,  <span class="at">data=</span>cp_teach,<span class="at">se=</span><span class="st">'bootstrap'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2.est, <span class="at">ci=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         7

  Number of observations                           557

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws             1000
  Number of successful bootstrap draws            1000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
  Acad ~                                                                
    Agg      (c_A)   -0.171    0.063   -2.728    0.006   -0.298   -0.056
    Non_agg (c_NA)   -0.091    0.063   -1.437    0.151   -0.216    0.031
    Teach_r    (b)    0.256    0.058    4.409    0.000    0.143    0.373
  Teach_r ~                                                             
    Agg      (a_A)   -0.574    0.044  -13.062    0.000   -0.658   -0.484
    Non_agg (a_NA)   -0.358    0.042   -8.509    0.000   -0.443   -0.274

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
   .Acad              0.908    0.057   16.040    0.000    0.801    1.017
   .Teach_r           0.540    0.030   18.209    0.000    0.479    0.597

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
    ind_agg          -0.147    0.034   -4.264    0.000   -0.217   -0.079
    ind_nonagg       -0.092    0.024   -3.840    0.000   -0.143   -0.046
    tot_agg          -0.318    0.056   -5.660    0.000   -0.429   -0.207
    tot_nonagg       -0.182    0.061   -2.983    0.003   -0.302   -0.063</code></pre>
</div>
</div>
<p>We can see that the 95% confidence intervals for both indirect effects do not include zero, therefore, we can conclude that they are significant at the <span class="math inline">\(\alpha = .05\)</span> level.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 12
</div>
<div class="question-body">
<p>Write a brief paragraph reporting on the results of the model estimates. Include a Figure or Table to display the parameter estimates.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-12" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-12', 'sol-start-12')">
Solution
</button>
</div>
<div id="sol-body-12" class="solution-body proof solution" style="display: none;">
<p><span class="proof-title"><em>Solution 11</em>. </span></p>
<div class="int">
<p>A path mediation model was used to test the direct and indirect effects (via teacher relationship quality) of aggressive and non-aggressive conduct problems on academic performance. In the model, academic performance was regressed on teacher relationship quality, non-aggressive conduct problems and aggressive conduct problems while teacher relationship quality (the mediator) was regressed on aggressive and non-aggressive conduct problems. The indirect effects were tested using the product of the coefficient for the regression of outcome on mediator and the coefficient for the regression of mediator on predictor. The statistical significance of the indirect effects were evaluated using bootstrapped 95% confidence intervals with 1000 bootstrap samples.</p>
<p>Unstandardised parameter estimates are provided in <a href="#fig-pathcp" class="quarto-xref">Figure&nbsp;11</a>. Solid lines indicate that a parameter is significant at the 5% significance level, while dashed lines represent non-significant paths.The indirect effects of both non-aggressive (<span class="math inline">\(b = -0.09,\, 95\%\, CI\, [-0.14, -0.05]\)</span>) and aggressive (<span class="math inline">\(b = -0.15,\, 95\%\, CI\, [-0.22, 0.08]\)</span>) conduct problems on academic performance were statistically significant.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pathcp" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pathcp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/path_analy_rev.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1200">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pathcp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Effect of conduct problems on academic performance mediated by quality of teacher relationship.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<p><br><br></p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
optional: mediation using separate models
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Following <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.917.2326&amp;rep=rep1&amp;type=pdf">Baron &amp; Kenny 1986</a>, we can conduct mediation analysis in a simpler way by using three separate regression models.</p>
<ol type="1">
<li><span class="math inline">\(y \sim x\)</span></li>
<li><span class="math inline">\(m \sim x\)</span></li>
<li><span class="math inline">\(y \sim x + m\)</span></li>
</ol>
<p>Step 1. Assess the total effect of the predictor on the outcome <code>y ~ x</code>. This step establishes that there <em>is</em> an effect that may be mediated.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Salary <span class="sc">~</span> Educ, <span class="at">data =</span> edskill)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error  t value    Pr(&gt;|t|)
(Intercept) 22.879667  3.0115922 7.597200 2.28938e-13
Educ         1.073166  0.1901872 5.642682 3.23425e-08</code></pre>
</div>
</div>
<p>Step 2. Estimate the effect of the predictor on the mediator <code>m ~ x</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Skill <span class="sc">~</span> Educ, <span class="at">data =</span> edskill)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept) -2.5725229 0.21702770 -11.85343 7.143607e-28
Educ         0.1657888 0.01370567  12.09637 8.416469e-29</code></pre>
</div>
</div>
<p>Step 3. Estimate the effects of the predictor and mediator on the outcome <code>y ~ x + m</code>. We need to show that the mediator affects the outcome variable.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Salary <span class="sc">~</span> Educ <span class="sc">+</span> Skill, <span class="at">data =</span> edskill)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate Std. Error  t value     Pr(&gt;|t|)
(Intercept) 32.0589324  3.4010279 9.426248 3.965954e-19
Educ         0.4815989  0.2159597 2.230040 2.631769e-02
Skill        3.5681957  0.6816649 5.234530 2.718793e-07</code></pre>
</div>
</div>
<p>Step 4. If Steps 1-3 all show effects of <code>y~x</code>, <code>m~x</code> and <code>y~m|x</code><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> respectively, then we can assess mediation. We need to look at the how effect of the predictor on the outcome changes when we control for the mediator. This is from the same third model above. If the effect of the predictor is reduced, then we have mediation. If it is now zero, then we have complete mediation.</p>
<p>This method is generally less optimal than using path models. Following the “separate models” approach<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> and requiring certain effects to be significant can sometimes lead to erroneous conclusions. For example, if <code>Y ~ 2*M + -2*X</code> and <code>M ~ 1*X</code>, then the total effect of <code>Y~X</code> would be <span class="math inline">\((2 \times 1) + -2 = 0\)</span>, leading us to say that there is no effect that could be mediated! In part the problems with this approach are because it doesn’t actually <em>estimate</em> the indirect effects, and attempts to determine “is there mediation [Yes]/[No]?” based on the significance of the individual paths. Even if the total effect <span class="math inline">\(c\)</span> is significantly different from zero and the direct effect <span class="math inline">\(c'\)</span> is not, this does not imply that the coefficients <span class="math inline">\(c\)</span> and <span class="math inline">\(c'\)</span> are different from one another! We therefore need to conduct an extra step (a popular approach is the “Sobel’s test”) in order to asses whether <span class="math inline">\(c-c'=0\)</span>, or to estimate the <span class="math inline">\(ab\)</span> path via bootstrapping like we do in <strong>lavaan</strong>.</p>
<p>Perhaps a more relevant issue is that the separate models approach cannot so easily be generalised to situations with multiple mediators, multiple outcomes, or multiple predictors, whereas a path analytic approach can. In addition, both are susceptible to the same concerns of measurement reliability, confounding, predictor-mediator interactions, and the causal directions between variables.</p>
<!-- ::: {.callout-caution collapse="true"} -->
<!-- #### Optional - packages for estimating mediation effects -->
<!-- The __mediation__ package is a very nice approach that allows us to conduct mediation this way, and it also extends to allow us to have categorical variables (we can use a logistic regression as one of our models), or to have multilevel data (our models can be fitted using __lme4__).   -->
<!-- ```{r} -->
<!-- library(mediation) -->
<!-- mymediation <- mediate(model.m = mod2,  -->
<!--                        model.y = mod3,  -->
<!--                        treat='religiosity',  -->
<!--                        mediator='hlc', -->
<!--                        boot=TRUE, sims=500) -->
<!-- summary(mymediation) -->
<!-- ``` -->
<!-- - ACME: Average Causal Mediation Effects (the indirect path $\mathbf{a \times b}$ in @fig-medpaths).   -->
<!-- - ADE: Average Direct Effects (the direct path $\mathbf{c'}$ in @fig-medpaths).   -->
<!-- - Total Effect: sum of the mediation (indirect) effect and the direct effect (this is $\mathbf{(a \times b) + c)}$ in @fig-medpaths).   -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- #| label: fig-medpaths -->
<!-- #| fig-cap: "Mediation Model. The indirect effect is the product of paths a and b. c' is the direct effect of x on y." -->
<!-- knitr::include_graphics("images/MED2.png") -->
<!-- ``` -->
<!-- ::: -->
</div>
</div>
</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>if we were wanting covariances, and we didn’t have standardised variables, then these would have to be multiplied by the corresponding variance estimates for the variables<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>You can’t go out of one arrow-head into another arrow-head. We can go heads-to-tails, or tails-to-heads, not heads-heads<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><a href="https://lavaan.ugent.be/" target="_blank">the lavaan project</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>there <em>are</em> methods that attempt to “block” a mediator, or to manipulate X in multiple ways in order to increase or decrease the mediators’ effect. If you’re interested see <a href="https://doi.org/10.1016/j.jesp.2015.09.012" target="_blank"><em>Design approaches to experimental mediation</em>, Pirlott &amp; MacKinnon 2016</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Note that the model fitted with <code>sem()</code> provides <span class="math inline">\(Z\)</span> values instead of the <span class="math inline">\(t\)</span>-values in regression models. This is because <code>sem()</code> fits models with maximum likelihood thereby assuming a reasonably large sample size.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>read <code>y~m|x</code> as <code>y~m</code> controlling for <code>x</code><a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>sometimes referred to as “steps approach”<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>